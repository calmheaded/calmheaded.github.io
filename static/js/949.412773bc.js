"use strict";(self.webpackChunkthree_model_viewer=self.webpackChunkthree_model_viewer||[]).push([[949],{3949:function(e,t,s){s.r(t),s.d(t,{OBJLoader:function(){return f}});var r=s(216);const i=/^[og]\s*(.+)?/,a=/^mtllib /,o=/^usemtl /,n=/^usemap /,l=/\s+/,h=new r.Pa4,c=new r.Pa4,u=new r.Pa4,p=new r.Pa4,m=new r.Pa4,d=new r.Ilk;function v(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){var s;this.object&&!1===this.object.fromDeclaration?(this.object.name=e,this.object.fromDeclaration=!1!==t):(s=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0,this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){var s=this._finalize(!1);s&&(s.inherited||s.groupCount<=0)&&this.materials.splice(s.index,1),e={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&0<t.length?t[t.length-1]:"",smooth:(void 0!==s?s:this).smooth,groupStart:void 0!==s?s.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){return e={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1},e.clone=this.clone.bind(e),e}};return this.materials.push(e),e},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&1<this.materials.length)for(let s=this.materials.length-1;0<=s;s--)this.materials[s].groupCount<=0&&this.materials.splice(s,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},s&&s.name&&"function"==typeof s.clone&&((e=s.clone(0)).inherited=!0,this.object.materials.push(e)),this.objects.push(this.object))},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){return e=parseInt(e,10),3*(0<=e?e-1:e+t/3)},parseNormalIndex:function(e,t){return e=parseInt(e,10),3*(0<=e?e-1:e+t/3)},parseUVIndex:function(e,t){return e=parseInt(e,10),2*(0<=e?e-1:e+t/2)},addVertex:function(e,t,s){var r=this.vertices,i=this.object.geometry.vertices;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[s+0],r[s+1],r[s+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,s){var r=this.normals,i=this.object.geometry.normals;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[s+0],r[s+1],r[s+2])},addFaceNormal:function(e,t,s){var r=this.vertices,i=this.object.geometry.normals;h.fromArray(r,e),c.fromArray(r,t),u.fromArray(r,s),m.subVectors(u,c),p.subVectors(h,c),m.cross(p),m.normalize(),i.push(m.x,m.y,m.z),i.push(m.x,m.y,m.z),i.push(m.x,m.y,m.z)},addColor:function(e,t,s){var r=this.colors,i=this.object.geometry.colors;void 0!==r[e]&&i.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&i.push(r[t+0],r[t+1],r[t+2]),void 0!==r[s]&&i.push(r[s+0],r[s+1],r[s+2])},addUV:function(e,t,s){var r=this.uvs,i=this.object.geometry.uvs;i.push(r[e+0],r[e+1]),i.push(r[t+0],r[t+1]),i.push(r[s+0],r[s+1])},addDefaultUV:function(){var e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,s,r,i,a,o,n,l){var h=this.vertices.length;let c=this.parseVertexIndex(e,h),u=this.parseVertexIndex(t,h),p=this.parseVertexIndex(s,h);this.addVertex(c,u,p),this.addColor(c,u,p),void 0!==o&&""!==o?(e=this.normals.length,c=this.parseNormalIndex(o,e),u=this.parseNormalIndex(n,e),p=this.parseNormalIndex(l,e),this.addNormal(c,u,p)):this.addFaceNormal(c,u,p),void 0!==r&&""!==r?(t=this.uvs.length,c=this.parseUVIndex(r,t),u=this.parseUVIndex(i,t),p=this.parseUVIndex(a,t),this.addUV(c,u,p),this.object.geometry.hasUVIndices=!0):this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";var t=this.vertices.length;for(let r=0,i=e.length;r<i;r++){var s=this.parseVertexIndex(e[r],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";var s=this.vertices.length,r=this.uvs.length;for(let i=0,a=e.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(e[i],s));for(let i=0,a=t.length;i<a;i++)this.addUVLine(this.parseUVIndex(t[i],r))}};return e.startObject("",!1),e}class f extends r.aNw{constructor(e){super(e),this.materials=null}load(e,t,s,i){const a=this;var o=new r.hH6(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(s){try{t(a.parse(s))}catch(s){i&&i(s),a.manager.itemError(e)}}),s,i)}setMaterials(e){return this.materials=e,this}parse(e){var t=new v,s=(e=-1!==(e=-1!==e.indexOf("\r\n")?e.replace(/\r\n/g,"\n"):e).indexOf("\\\n")?e.replace(/\\\n/g,""):e).split("\n");let h=[];for(let r=0,v=s.length;r<v;r++){var c=s[r].trimStart();if(0!==c.length){var u,p=c.charAt(0);if("#"!==p)if("v"===p){var m=c.split(l);switch(m[0]){case"v":t.vertices.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),7<=m.length?(d.setRGB(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6])).convertSRGBToLinear(),t.colors.push(d.r,d.g,d.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));break;case"vt":t.uvs.push(parseFloat(m[1]),parseFloat(m[2]))}}else if("f"===p){var f=c.slice(1).trim().split(l),g=[];for(let e=0,t=f.length;e<t;e++){var b=f[e];0<b.length&&(b=b.split("/"),g.push(b))}var j=g[0];for(let e=1,s=g.length-1;e<s;e++){var y=g[e],x=g[e+1];t.addFace(j[0],y[0],x[0],j[1],y[1],x[1],j[2],y[2],x[2])}}else if("l"===p){var w=c.substring(1).trim().split(" ");let e=[];var V=[];if(-1===c.indexOf("/"))e=w;else for(let t=0,s=w.length;t<s;t++){var I=w[t].split("/");""!==I[0]&&e.push(I[0]),""!==I[1]&&V.push(I[1])}t.addLineGeometry(e,V)}else"p"===p?(u=c.slice(1).trim().split(" "),t.addPointGeometry(u)):null!==(h=i.exec(c))?(u=(" "+h[0].slice(1).trim()).slice(1),t.startObject(u)):o.test(c)?t.object.startMaterial(c.substring(7).trim(),t.materialLibraries):a.test(c)?t.materialLibraries.push(c.substring(7).trim()):n.test(c)||"s"===p&&(1<(h=c.split(" ")).length?(p=h[1].trim().toLowerCase(),t.object.smooth="0"!==p&&"off"!==p):t.object.smooth=!0,c=t.object.currentMaterial())&&(c.smooth=t.object.smooth)}}t.finalize();var z,U=new r.ZAu;U.materialLibraries=[].concat(t.materialLibraries),e=!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length);if(1==e)for(let i=0,a=t.objects.length;i<a;i++){var F=t.objects[i],A=F.geometry,C=F.materials,L="Line"===A.type,P="Points"===A.type;let e=!1;if(0!==A.vertices.length){var _=new r.u9r,N=(_.setAttribute("position",new r.a$l(A.vertices,3)),0<A.normals.length&&_.setAttribute("normal",new r.a$l(A.normals,3)),0<A.colors.length&&(e=!0,_.setAttribute("color",new r.a$l(A.colors,3))),!0===A.hasUVIndices&&_.setAttribute("uv",new r.a$l(A.uvs,2)),[]);for(let i=0,a=C.length;i<a;i++){var S,M=C[i],k=M.name+"_"+M.smooth+"_"+e;let s=t.materials[k];null!==this.materials&&(s=this.materials.create(M.name),!L||!s||s instanceof r.nls?!P||!s||s instanceof r.UY4||(S=new r.UY4({size:10,sizeAttenuation:!1}),r.F5T.prototype.copy.call(S,s),S.color.copy(s.color),S.map=s.map,s=S):(S=new r.nls,r.F5T.prototype.copy.call(S,s),S.color.copy(s.color),s=S)),void 0===s&&((s=L?new r.nls:P?new r.UY4({size:1,sizeAttenuation:!1}):new r.xoR).name=M.name,s.flatShading=!M.smooth,s.vertexColors=e,t.materials[k]=s),N.push(s)}let s;if(1<N.length){for(let e=0,t=C.length;e<t;e++){var E=C[e];_.addGroup(E.groupStart,E.groupCount,e)}s=new(L?r.ejS:P?r.woe:r.Kj0)(_,N)}else s=new(L?r.ejS:P?r.woe:r.Kj0)(_,N[0]);s.name=F.name,U.add(s)}}else 0<t.vertices.length&&(e=new r.UY4({size:1,sizeAttenuation:!1}),(z=new r.u9r).setAttribute("position",new r.a$l(t.vertices,3)),0<t.colors.length&&void 0!==t.colors[0]&&(z.setAttribute("color",new r.a$l(t.colors,3)),e.vertexColors=!0),z=new r.woe(z,e),U.add(z));return U}}}}]);