"use strict";(self.webpackChunkthree_model_viewer=self.webpackChunkthree_model_viewer||[]).push([[651],{2651:function(e,t,s){s.r(t),s.d(t,{MTLLoader:function(){return r}});var a=s(216);class r extends a.aNw{constructor(e){super(e)}load(e,t,s,r){const i=this,o=""===this.path?a.Zp0.extractUrlBase(e):this.path;var n=new a.hH6(this.manager);n.setPath(this.path),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,(function(s){try{t(i.parse(s,o))}catch(s){r&&r(s),i.manager.itemError(e)}}),s,r)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){var s=e.split("\n");let a={};var r=/\s+/,o={};for(let i=0;i<s.length;i++){let e=s[i];if(0!==(e=e.trim()).length&&"#"!==e.charAt(0)){var n=e.indexOf(" ");let t=0<=n?e.substring(0,n):e,s=(t=t.toLowerCase(),0<=n?e.substring(n+1):"");s=s.trim(),"newmtl"===t?(a={name:s},o[s]=a):"ka"===t||"kd"===t||"ks"===t||"ke"===t?(n=s.split(r,3),a[t]=[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2])]):a[t]=s}}return e=new i(this.resourcePath||t,this.materialOptions),e.setCrossOrigin(this.crossOrigin),e.setManager(this.manager),e.setMaterials(o),e}}class i{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:a.Wl3,this.wrap=void 0!==this.options.wrap?this.options.wrap:a.rpg}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;var t={};for(const i in e){var s=e[i],a={};t[i]=a;for(const e in s){let t=!0,i=s[e];var r=e.toLowerCase();switch(r){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(i=[i[0]/255,i[1]/255,i[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===i[0]&&0===i[1]&&0===i[2]&&(t=!1)}t&&(a[r]=i)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this;var s=this.materialsInfo[e];const r={name:e,side:this.side};function i(e,s){var i,o;r[e]||(s=t.getTextureParams(s,r),(i=t.loadTexture((i=t.baseUrl,"string"!=typeof(o=s.url)||""===o?"":/^https?:\/\//i.test(o)?o:i+o))).repeat.copy(s.scale),i.offset.copy(s.offset),i.wrapS=t.wrap,i.wrapT=t.wrap,"map"!==e&&"emissiveMap"!==e||(i.encoding=a.knz),r[e]=i)}for(const n in s){var o=s[n];let e;if(""!==o)switch(n.toLowerCase()){case"kd":r.color=(new a.Ilk).fromArray(o).convertSRGBToLinear();break;case"ks":r.specular=(new a.Ilk).fromArray(o).convertSRGBToLinear();break;case"ke":r.emissive=(new a.Ilk).fromArray(o).convertSRGBToLinear();break;case"map_kd":i("map",o);break;case"map_ks":i("specularMap",o);break;case"map_ke":i("emissiveMap",o);break;case"norm":i("normalMap",o);break;case"map_bump":case"bump":i("bumpMap",o);break;case"map_d":i("alphaMap",o),r.transparent=!0;break;case"ns":r.shininess=parseFloat(o);break;case"d":(e=parseFloat(o))<1&&(r.opacity=e,r.transparent=!0);break;case"tr":e=parseFloat(o),0<(e=this.options&&this.options.invertTrProperty?1-e:e)&&(r.opacity=1-e,r.transparent=!0)}}return this.materials[e]=new a.xoR(r),this.materials[e]}getTextureParams(e,t){var s={scale:new a.FM8(1,1),offset:new a.FM8(0,0)},r=(e=e.split(/\s+/),e.indexOf("-bm"));return 0<=r&&(t.bumpScale=parseFloat(e[r+1]),e.splice(r,2)),0<=(r=e.indexOf("-s"))&&(s.scale.set(parseFloat(e[r+1]),parseFloat(e[r+2])),e.splice(r,4)),0<=(r=e.indexOf("-o"))&&(s.offset.set(parseFloat(e[r+1]),parseFloat(e[r+2])),e.splice(r,4)),s.url=e.join(" ").trim(),s}loadTexture(e,t,s,r,i){var o=void 0!==this.manager?this.manager:a.tEQ;let n=o.getHandler(e);return(n=null===n?new a.dpR(o):n).setCrossOrigin&&n.setCrossOrigin(this.crossOrigin),o=n.load(e,s,r,i),void 0!==t&&(o.mapping=t),o}}}}]);