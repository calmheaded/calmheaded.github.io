!function(){var e,t,i,s,n={2503:function(e,t,i){"use strict";var s=i(1650),n=i(5850),r=i.n(n),a=(n={name:"App",components:{},data(){return{width:"800",height:"800",vConsole:null}},methods:{init(){this.addVConsoleDebug()},addErudaMobileDebug(){eruda.init()},addVConsoleDebug(){this.vConsole=new(r())({theme:"dark"})},removeVConsoleDebug(){this.vConsole&&this.vConsole.destroy()}},beforeUnmount(){this.removeVConsoleDebug()},beforeMount(){},mounted(){}},i(5440)),o=(0,a.Z)(n,(function(){var e=this._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"content"},[e("model-engine",{attrs:{width:this.width,height:this.height}})],1)])}),[],!1,null,null,null).exports,l=(n=i(6044),{getModel:e=>e.app.model,showLoading:e=>e.app.showLoading,getBlastVal:e=>e.app.blastVal,hasAnimate:e=>e.app.model,isActive:e=>e.isActive,info:e=>e.measure.info,pointsDistance:e=>e.measure.pointsDistance,parallelFacesDistance:e=>e.measure.parallelFacesDistance,facesAngle:e=>e.measure.facesAngle}),h={namespaced:!0,state:{model:null,showLoading:!1,blastVal:1,duxian:!1,ifplay:!1,wangge:!1,touming:!1,yidong:!1,yincang:!1,ifShowEdge:!0,edgeVal:100},mutations:{ADD_MODEL(e,t){e.model=t},RESET_MODEL(e){e.model=null},DU_XIAN(e,t){e.duxian=t},TOU_MING(e,t){e.touming=t},WANGE_GE(e,t){e.wangge=t},YI_DONG(e,t){e.yidong=t},YIN_CANG(e,t){e.yincang=t},SHOW_LOADING(e,t){e.showLoading=!1},CHANGE_BLASTVAL(e,t){e.blastVal=t},RESET_BLASTVAL(e){e.blastVal=1},IF_SHOW_EDGE(e,t){e.ifShowEdge=t},CHANGE_EDGE_VAL(e,t){e.edgeVal=t}},actions:{showLoading({commit:e},t){e("SHOW_LOADING",!1)},changBlastVal({commit:e},t){e("CHANGE_BLASTVAL",t)},resetBlastVal({commit:e},t){e("RESET_BLASTVAL",t)}}};const c={info:"无",pointsDistance:0,parallelFacesDistance:0,facesAngle:0,isActive:!1,showMeasureIInfo:!1};var d={namespaced:!0,state:c,mutations:{ShowMeasureInfo(e,t){e.showMeasureIInfo=t},IsActive(e,t){e.isActive=t},AddInfo(e,t){e.info=t},AddPointsDistance(e,t){e.pointsDistance=t},AddDistanceParallel(e,t){e.parallelFacesDistance=t},AddAngel(e,t){e.facesAngle=t},Reset(){c.pointsDistance=0,c.parallelFacesDistance=0,c.facesAngle=0,c.showMeasureIInfo=!1}},actions:{}},u=(s.default.use(n.ZP),new n.ZP.Store({modules:{app:h,measure:d},getters:l})),m=i(4841),p=(h=i.n(m),i(216));class g{constructor(){this.count=null,this.current=null,this.callbacks=null}Run(e,t){this.count=e,this.current=0,this.callbacks=t,0===e?this.TaskReady():this.RunOnce()}RunBatch(e,t,i){let s=0;0<e&&(s=parseInt((e-1)/t,10)+1),this.Run(s,{runTask:(s,n)=>{var r=s*t;s=Math.min((s+1)*t,e)-1;i.runTask(r,s,n)},onReady:i.onReady})}RunOnce(){setTimeout((()=>{this.callbacks.runTask(this.current,this.TaskReady.bind(this))}),0)}TaskReady(){this.current+=1,this.current<this.count?this.RunOnce():this.callbacks.onReady&&this.callbacks.onReady()}}function v(e){setTimeout((()=>{e()}),10)}function f(e,t){(new g).Run(e,t)}const b={Url:1,File:2,Decompressed:3};function w(e){let t=e.lastIndexOf("/"),i=(-1===t&&(t=e.lastIndexOf("\\")),e);return e=(i=-1!==t?e.substring(t+1):i).indexOf("?"),-1!==e&&(i=i.substring(0,e)),decodeURI(i)}function x(e){e=w(e);var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1).toLowerCase()}function C(e,t){return new Promise(((i,s)=>{let n=new XMLHttpRequest;n.open("GET",e,!0),n.onprogress=e=>{t(e.loaded,e.total)},n.onload=()=>{200===n.status?i(n.response):s()},n.onerror=()=>{s()},n.responseType="arraybuffer",n.send(null)}))}function y(e,t){return new Promise(((i,s)=>{var n=new FileReader;n.onprogress=e=>{t(e.loaded,e.total)},n.onloadend=e=>{e.target.readyState===FileReader.DONE&&i(e.target.result)},n.onerror=()=>{s()},n.readAsArrayBuffer(e)}))}class M{constructor(e,t,i){this.r=e,this.g=t,this.b=i}Set(e,t,i){this.r=e,this.g=t,this.b=i}Clone(){return new M(this.r,this.g,this.b)}}class T{constructor(e,t,i,s){this.r=e,this.g=t,this.b=i,this.a=s}Set(e,t,i,s){this.r=e,this.g=t,this.b=i,this.a=s}Clone(){return new T(this.r,this.g,this.b,this.a)}}function A(e){return parseInt(Math.round(255*e),10)}function S(e){return e/255}function I(e,t,i){return new M(A(e),A(t),A(i))}function L(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function E(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b}class _{constructor(e,t,i){this.name=e,this.source=t,this.data=i}}class k{constructor(e,t,i){this.name=w(e),this.extension=x(e),this.source=t,this.data=i,this.content=null}SetContent(e){this.content=e}}class F{constructor(){this.files=[]}FillFromInputFiles(e){for(var t of(this.files=[],e))t=new k(t.name,t.source,t.data),this.files.push(t)}ExtendFromFileList(e){var t=e.GetFiles();for(let s=0;s<t.length;s++){var i=t[s];this.ContainsFileByPath(i.name)||this.files.push(i)}}GetFiles(){return this.files}GetContent(e){f(this.files.length,{runTask:(t,i)=>{e.onFileListProgress(t,this.files.length),this.GetFileContent(this.files[t],{onReady:i,onProgress:e.onFileLoadProgress})},onReady:e.onReady})}ContainsFileByPath(e){return null!==this.FindFileByPath(e)}FindFileByPath(e){var t=w(e).toLowerCase();for(let s=0;s<this.files.length;s++){var i=this.files[s];if(i.name.toLowerCase()===t)return i}return null}IsOnlyUrlSource(){if(0===this.files.length)return!1;for(let t=0;t<this.files.length;t++){var e=this.files[t];if(e.source!==b.Url&&e.source!==b.Decompressed)return!1}return!0}AddFile(e){this.files.push(e)}GetFileContent(e,t){if(null!==e.content)t.onReady();else{let i=null;if(e.source===b.Url)i=C(e.data,t.onProgress);else{if(e.source!==b.File)return void t.onReady();i=y(e.data,t.onProgress)}i.then((t=>{e.SetContent(t)})).catch((()=>{})).finally((()=>{t.onReady()}))}}}const G=1e-8;function O(e,t){return Math.abs(t-e)<G}const P={X:1,Y:2,Z:3};class R{constructor(e,t){this.x=e,this.y=t}Clone(){return new R(this.x,this.y)}}function D(e,t){return O(e.x,t.x)&&O(e.y,t.y)}class N{constructor(e,t,i){this.x=e,this.y=t,this.z=i}Length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}MultiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}Normalize(){var e=this.Length();return 0<e&&this.MultiplyScalar(1/e),this}Offset(e,t){return e=e.Clone().Normalize(),this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}Rotate(e,t,i){e=e.Clone().Normalize();var s=e.x,n=e.y,r=(e=e.z,this.x-i.x),a=this.y-i.y,o=this.z-i.z,l=Math.sin(t);t=Math.cos(t);return this.x=-s*(-s*r-n*a-e*o)*(1-t)+r*t+(-e*a+n*o)*l,this.y=-n*(-s*r-n*a-e*o)*(1-t)+a*t+(e*r-s*o)*l,this.z=-e*(-s*r-n*a-e*o)*(1-t)+o*t+(-n*r+s*a)*l,this.x+=i.x,this.y+=i.y,this.z+=i.z,this}Clone(){return new N(this.x,this.y,this.z)}}function j(e,t){return O(e.x,t.x)&&O(e.y,t.y)&&O(e.z,t.z)}function V(e,t){return new N(e.x-t.x,e.y-t.y,e.z-t.z)}function U(e,t,i){return Math.sqrt(e*e+t*t+i*i)}function B(e){return new N(e[0],e[1],e[2])}class z{constructor(e,t,i,s){this.x=e,this.y=t,this.z=i,this.w=s}Clone(){return new z(this.x,this.y,this.z,this.w)}}class H{constructor(e,t,i,s){this.x=e,this.y=t,this.z=i,this.w=s}}class W{constructor(e){(this.matrix=null)!=e&&(this.matrix=e)}IsValid(){return null!==this.matrix}Set(e){return this.matrix=e,this}Get(){return this.matrix}Clone(){var e=[this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5],this.matrix[6],this.matrix[7],this.matrix[8],this.matrix[9],this.matrix[10],this.matrix[11],this.matrix[12],this.matrix[13],this.matrix[14],this.matrix[15]];return new W(e)}CreateIdentity(){return this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this}IsIdentity(){var e=(new W).CreateIdentity().Get();for(let t=0;t<16;t++)if(!O(this.matrix[t],e[t]))return!1;return!0}CreateTranslation(e,t,i){return this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,e,t,i,1],this}CreateRotation(e,t,i,s){var n=e+e,r=t+t,a=i+i,o=e*n,l=e*r,h=(e=e*a,t*r);t*=a,i*=a,n*=s,r*=s,s*=a;return this.matrix=[1-(h+i),l+s,e-r,0,l-s,1-(o+i),t+n,0,e+r,t-n,1-(o+h),0,0,0,0,1],this}CreateRotationAxisAngle(e,t){t/=2,i=Math.sin(t);var i;e=new H(e.x*i,e.y*i,e.z*i,Math.cos(t));return this.CreateRotation(e.x,e.y,e.z,e.w)}CreateScale(e,t,i){return this.matrix=[e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1],this}ComposeTRS(e,t,i){var s=e.x,n=e.y,r=(e=e.z,t.x),a=t.y,o=t.z,l=(t=t.w,i.x),h=i.y,c=(i=i.z,r+r),d=a+a,u=o+o,m=r*c,p=r*d,g=(r=r*u,a*d);a*=u,o*=u,c*=t,d*=t,t*=u;return this.matrix=[(1-(g+o))*l,(p+t)*l,(r-d)*l,0,(p-t)*h,(1-(m+o))*h,(a+c)*h,0,(r+d)*i,(a-c)*i,(1-(m+g))*i,0,s,n,e,1],this}DecomposeTRS(){var e=new N(this.matrix[12],this.matrix[13],this.matrix[14]);let t=U(this.matrix[0],this.matrix[1],this.matrix[2]);var i=U(this.matrix[4],this.matrix[5],this.matrix[6]),s=U(this.matrix[8],this.matrix[9],this.matrix[10]),n=(this.Determinant()<-G&&(t*=-1),new N(t,i,s)),r=this.matrix[0]/t,a=this.matrix[4]/i,o=this.matrix[8]/s,l=this.matrix[1]/t,h=this.matrix[5]/i,c=this.matrix[9]/s,d=this.matrix[2]/t;i=this.matrix[6]/i,s=this.matrix[10]/s;let u=null;var m=r+h+s;return{translation:e,rotation:u=0<m?(e=2*Math.sqrt(1+m),new H((i-c)/e,(o-d)/e,(l-a)/e,.25*e)):h<r&&s<r?(m=2*Math.sqrt(1+r-h-s),new H(.25*m,(a+l)/m,(o+d)/m,(i-c)/m)):s<h?(e=2*Math.sqrt(1+h-r-s),new H((a+l)/e,.25*e,(c+i)/e,(o-d)/e)):(m=2*Math.sqrt(1+s-r-h),new H((o+d)/m,(c+i)/m,.25*m,(l-a)/m)),scale:n}}Determinant(){var e=this.matrix[0],t=this.matrix[1],i=this.matrix[2],s=this.matrix[3],n=this.matrix[4],r=this.matrix[5],a=this.matrix[6],o=this.matrix[7],l=this.matrix[8],h=this.matrix[9],c=this.matrix[10],d=this.matrix[11],u=this.matrix[12],m=this.matrix[13],p=this.matrix[14],g=this.matrix[15];return(e*r-t*n)*(c*g-d*p)-(e*a-i*n)*(h*g-d*m)+(e*o-s*n)*(h*p-c*m)+(t*a-i*r)*(l*g-d*u)-(t*o-s*r)*(l*p-c*u)+(i*o-s*a)*(l*m-h*u)}Invert(){var e=this.matrix[0],t=this.matrix[1],i=this.matrix[2],s=this.matrix[3],n=this.matrix[4],r=this.matrix[5],a=this.matrix[6],o=this.matrix[7],l=this.matrix[8],h=this.matrix[9],c=this.matrix[10],d=this.matrix[11],u=this.matrix[12],m=this.matrix[13],p=this.matrix[14],g=this.matrix[15],v=e*r-t*n,f=e*a-i*n,b=e*o-s*n,w=t*a-i*r,x=t*o-s*r,C=i*o-s*a,y=l*m-h*u,M=l*p-c*u,T=l*g-d*u,A=h*p-c*m,S=h*g-d*m,I=c*g-d*p,L=v*I-f*S+b*A+w*T-x*M+C*y;return O(L,0)?null:(I=[(r*I-a*S+o*A)/L,(i*S-t*I-s*A)/L,(m*C-p*x+g*w)/L,(c*x-h*C-d*w)/L,(a*T-n*I-o*M)/L,(e*I-i*T+s*M)/L,(p*b-u*C-g*f)/L,(l*C-c*b+d*f)/L,(n*S-r*T+o*y)/L,(t*T-e*S-s*y)/L,(u*x-m*b+g*v)/L,(h*b-l*x-d*v)/L,(r*M-n*A-a*y)/L,(e*A-t*M+i*y)/L,(m*f-u*w-p*v)/L,(l*w-h*f+c*v)/L],new W(I))}Transpose(){var e=[this.matrix[0],this.matrix[4],this.matrix[8],this.matrix[12],this.matrix[1],this.matrix[5],this.matrix[9],this.matrix[13],this.matrix[2],this.matrix[6],this.matrix[10],this.matrix[14],this.matrix[3],this.matrix[7],this.matrix[11],this.matrix[15]];return new W(e)}InvertTranspose(){var e=this.Invert();return null===e?null:e.Transpose()}MultiplyVector(e){var t=e.x,i=e.y,s=e.z,n=(e=e.w,this.matrix[0]),r=this.matrix[1],a=this.matrix[2],o=this.matrix[3],l=this.matrix[4],h=this.matrix[5],c=this.matrix[6],d=this.matrix[7],u=this.matrix[8],m=this.matrix[9],p=this.matrix[10],g=this.matrix[11],v=this.matrix[12],f=this.matrix[13],b=this.matrix[14],w=this.matrix[15];return new z(t*n+i*l+s*u+e*v,t*r+i*h+s*m+e*f,t*a+i*c+s*p+e*b,t*o+i*d+s*g+e*w)}MultiplyMatrix(e){var t=this.matrix[0],i=this.matrix[1],s=this.matrix[2],n=this.matrix[3],r=this.matrix[4],a=this.matrix[5],o=this.matrix[6],l=this.matrix[7],h=this.matrix[8],c=this.matrix[9],d=this.matrix[10],u=this.matrix[11],m=this.matrix[12],p=this.matrix[13],g=this.matrix[14],v=this.matrix[15],f=e.matrix[0],b=e.matrix[1],w=e.matrix[2],x=e.matrix[3],C=e.matrix[4],y=e.matrix[5],M=e.matrix[6],T=e.matrix[7],A=e.matrix[8],S=e.matrix[9],I=e.matrix[10],L=e.matrix[11],E=e.matrix[12],_=e.matrix[13],k=e.matrix[14];e=e.matrix[15],t=[t*f+i*C+s*A+n*E,t*b+i*y+s*S+n*_,t*w+i*M+s*I+n*k,t*x+i*T+s*L+n*e,r*f+a*C+o*A+l*E,r*b+a*y+o*S+l*_,r*w+a*M+o*I+l*k,r*x+a*T+o*L+l*e,h*f+c*C+d*A+u*E,h*b+c*y+d*S+u*_,h*w+c*M+d*I+u*k,h*x+c*T+d*L+u*e,m*f+p*C+g*A+v*E,m*b+p*y+g*S+v*_,m*w+p*M+g*I+v*k,m*x+p*T+g*L+v*e];return new W(t)}}class Y{constructor(e){null!=e?this.matrix=e:(this.matrix=new W,this.matrix.CreateIdentity())}SetMatrix(e){return this.matrix=e,this}GetMatrix(){return this.matrix}IsIdentity(){return this.matrix.IsIdentity()}AppendMatrix(e){return this.matrix=this.matrix.MultiplyMatrix(e),this}Append(e){return this.AppendMatrix(e.GetMatrix()),this}TransformCoord3D(e){return e=new z(e.x,e.y,e.z,1),e=this.matrix.MultiplyVector(e),new N(e.x,e.y,e.z)}Clone(){var e=this.matrix.Clone();return new Y(e)}}class K{constructor(e,t){this.arrayBuffer=e,this.dataView=new DataView(e),this.isLittleEndian=t,this.position=0}GetPosition(){return this.position}SetPosition(e){this.position=e}GetByteLength(){return this.arrayBuffer.byteLength}Skip(e){this.position=this.position+e}End(){return this.position>=this.arrayBuffer.byteLength}ReadArrayBuffer(e){var t=new Uint8Array(this.arrayBuffer),i=new ArrayBuffer(e),s=new Uint8Array(i);t=t.subarray(this.position,this.position+e);return s.set(t,0),this.position+=e,i}ReadBoolean8(){var e=this.dataView.getInt8(this.position);return this.position=this.position+1,!!e}ReadCharacter8(){var e=this.dataView.getInt8(this.position);return this.position=this.position+1,e}ReadUnsignedCharacter8(){var e=this.dataView.getUint8(this.position);return this.position=this.position+1,e}ReadInteger16(){var e=this.dataView.getInt16(this.position,this.isLittleEndian);return this.position=this.position+2,e}ReadUnsignedInteger16(){var e=this.dataView.getUint16(this.position,this.isLittleEndian);return this.position=this.position+2,e}ReadInteger32(){var e=this.dataView.getInt32(this.position,this.isLittleEndian);return this.position=this.position+4,e}ReadUnsignedInteger32(){var e=this.dataView.getUint32(this.position,this.isLittleEndian);return this.position=this.position+4,e}ReadFloat32(){var e=this.dataView.getFloat32(this.position,this.isLittleEndian);return this.position=this.position+4,e}ReadDouble64(){var e=this.dataView.getFloat64(this.position,this.isLittleEndian);return this.position=this.position+8,e}}function q(e){return new TextDecoder("utf-8").decode(e)}function $(e){var t="data:";if(!e.startsWith(t))return null;var i=e.indexOf(";");if(-1===i)return null;var s=e.indexOf(",");if(-1===s)return null;t=e.substring(t.length,t.length+i-5);var n=atob(e.substring(s+1)),r=(i=new ArrayBuffer(n.length),new Uint8Array(i));for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return{mimeType:t,buffer:i}}function X(e){return null==e||0===(e=e.split("/")).length?"":e[e.length-1]}let Z=null,J=new Set;function Q(e){return new Promise(((t,i)=>{var s,n;null===Z?i():J.has(e)?t():((s=document.createElement("script")).type="text/javascript",s.src=(n=e,null===Z?null:Z+"/"+n),s.onload=()=>{J.add(e),t()},s.onerror=()=>{i()},document.head.appendChild(s))}))}class ee{constructor(){this.name=null,this.mimeType=null,this.buffer=null,this.offset=new R(0,0),this.scale=new R(1,1),this.rotation=0}IsValid(){return null!==this.name&&null!==this.buffer}HasTransformation(){return!D(this.offset,new R(0,0))||!D(this.scale,new R(1,1))||!O(this.rotation,0)}IsEqual(e){return this.name===e.name&&this.mimeType===e.mimeType&&!!D(this.offset,e.offset)&&!!D(this.scale,e.scale)&&!!O(this.rotation,e.rotation)}}function te(e,t){return null===e&&null===t||null!==e&&null!==t&&e.IsEqual(t)}const ie={Phong:1,Physical:2};class se extends class{constructor(e){this.type=e,this.isDefault=!1,this.name="",this.color=new M(0,0,0),this.vertexColors=!1}IsEqual(e){return this.type===e.type&&this.isDefault===e.isDefault&&this.name===e.name&&!!E(this.color,e.color)&&this.vertexColors===e.vertexColors}}{constructor(e){super(e),this.emissive=new M(0,0,0),this.opacity=1,this.transparent=!1,this.diffuseMap=null,this.bumpMap=null,this.normalMap=null,this.emissiveMap=null,this.alphaTest=0,this.multiplyDiffuseMap=!1}IsEqual(e){return!!super.IsEqual(e)&&!!(E(this.emissive,e.emissive)&&O(this.opacity,e.opacity)&&this.transparent===e.transparent&&te(this.diffuseMap,e.diffuseMap)&&te(this.bumpMap,e.bumpMap)&&te(this.normalMap,e.normalMap)&&te(this.emissiveMap,e.emissiveMap)&&O(this.alphaTest,e.alphaTest)&&this.multiplyDiffuseMap===e.multiplyDiffuseMap)}}class ne extends se{constructor(){super(ie.Phong),this.ambient=new M(0,0,0),this.specular=new M(0,0,0),this.shininess=0,this.specularMap=null}IsEqual(e){return!!super.IsEqual(e)&&!!(E(this.ambient,e.ambient)&&E(this.specular,e.specular)&&O(this.shininess,e.shininess)&&te(this.specularMap,e.specularMap))}}class re extends se{constructor(){super(ie.Physical),this.metalness=0,this.roughness=1,this.metalnessMap=null}IsEqual(e){return!!(super.IsEqual(e)&&O(this.metalness,e.metalness)&&O(this.roughness,e.roughness)&&te(this.metalnessMap,e.metalnessMap))}}class ae extends class{constructor(){}VertexCount(){return 0}VertexColorCount(){return 0}NormalCount(){return 0}TextureUVCount(){return 0}TriangleCount(){return 0}EnumerateVertices(e){}EnumerateTriangleVertexIndices(e){}EnumerateTriangleVertices(e){}}{constructor(){super(),this.name="",this.propertyGroups=[]}GetName(){return this.name}SetName(e){this.name=e}PropertyGroupCount(){return this.propertyGroups.length}AddPropertyGroup(e){return this.propertyGroups.push(e),this.propertyGroups.length-1}GetPropertyGroup(e){return this.propertyGroups[e]}CloneProperties(e){for(var t of this.propertyGroups)e.AddPropertyGroup(t.Clone())}}class oe extends ae{constructor(){super(),this.vertices=[],this.vertexColors=[],this.normals=[],this.uvs=[],this.triangles=[]}VertexCount(){return this.vertices.length}VertexColorCount(){return this.vertexColors.length}NormalCount(){return this.normals.length}TextureUVCount(){return this.uvs.length}TriangleCount(){return this.triangles.length}AddVertex(e){return this.vertices.push(e),this.vertices.length-1}SetVertex(e,t){this.vertices[e]=t}GetVertex(e){return this.vertices[e]}AddVertexColor(e){return this.vertexColors.push(e),this.vertexColors.length-1}SetVertexColor(e,t){this.vertexColors[e]=t}GetVertexColor(e){return this.vertexColors[e]}AddNormal(e){return this.normals.push(e),this.normals.length-1}SetNormal(e,t){this.normals[e]=t}GetNormal(e){return this.normals[e]}AddTextureUV(e){return this.uvs.push(e),this.uvs.length-1}SetTextureUV(e,t){this.uvs[e]=t}GetTextureUV(e){return this.uvs[e]}AddTriangle(e){return this.triangles.push(e),this.triangles.length-1}GetTriangle(e){return this.triangles[e]}EnumerateVertices(e){for(const t of this.vertices)e(t)}EnumerateTriangleVertexIndices(e){for(const t of this.triangles)e(t.v0,t.v1,t.v2)}EnumerateTriangleVertices(e){for(const t of this.triangles)e(this.vertices[t.v0],this.vertices[t.v1],this.vertices[t.v2])}Clone(){var e=new oe;e.SetName(this.GetName()),this.CloneProperties(e);for(let a=0;a<this.VertexCount();a++){var t=this.GetVertex(a);e.AddVertex(t.Clone())}for(let a=0;a<this.VertexColorCount();a++){var i=this.GetVertexColor(a);e.AddVertexColor(i.Clone())}for(let a=0;a<this.NormalCount();a++){var s=this.GetNormal(a);e.AddNormal(s.Clone())}for(let a=0;a<this.TextureUVCount();a++){var n=this.GetTextureUV(a);e.AddTextureUV(n.Clone())}for(let a=0;a<this.TriangleCount();a++){var r=this.GetTriangle(a);e.AddTriangle(r.Clone())}return e}}class le{constructor(){this.nextId=0}GenerateId(){var e=this.nextId;return this.nextId+=1,e}}const he={GroupNode:0,MeshNode:1};class ce{constructor(){this.type=he.GroupNode,this.name="",this.parent=null,this.transformation=new Y,this.childNodes=[],this.meshIndices=[],this.idGenerator=new le,this.id=this.idGenerator.GenerateId()}IsEmpty(){return 0===this.childNodes.length&&0===this.meshIndices.length}GetType(){return this.type}SetType(e){this.type=e}GetId(){return this.id}GetName(){return this.name}SetName(e){this.name=e}HasParent(){return null!==this.parent}GetParent(){return this.parent}GetTransformation(){return this.transformation}GetWorldTransformation(){var e=this.transformation.Clone();let t=this.parent;for(;null!==t;)e.Append(t.transformation),t=t.parent;return e}SetTransformation(e){this.transformation=e}AddChildNode(e){return e.parent=this,e.idGenerator=this.idGenerator,e.id=e.idGenerator.GenerateId(),this.childNodes.push(e),this.childNodes.length-1}RemoveChildNode(e){e.parent=null,e=this.childNodes.indexOf(e),this.childNodes.splice(e,1)}GetChildNodes(){return this.childNodes}ChildNodeCount(){return this.childNodes.length}GetChildNode(e){return this.childNodes[e]}AddMeshIndex(e){return this.meshIndices.push(e),this.meshIndices.length-1}MeshIndexCount(){return this.meshIndices.length}GetMeshIndex(e){return this.meshIndices[e]}GetMeshIndices(){return this.meshIndices}Enumerate(e){e(this);for(const t of this.childNodes)t.Enumerate(e)}EnumerateChildren(e){for(const t of this.childNodes)e(t),t.EnumerateChildren(e)}EnumerateMeshIndices(e){for(const t of this.meshIndices)e(t);for(const t of this.childNodes)t.EnumerateMeshIndices(e)}}const de={Text:1,Integer:2,Number:3,Boolean:4,Percent:5,Color:6};class ue{constructor(e,t,i){this.type=e,this.name=t,this.value=i}Clone(){return this.type===de.Color?new ue(this.type,this.name,this.value.Clone()):new ue(this.type,this.name,this.value)}}class me{constructor(e){this.name=e,this.properties=[]}PropertyCount(){return this.properties.length}AddProperty(e){this.properties.push(e)}GetProperty(e){return this.properties[e]}Clone(){var e,t=new me(this.name);for(e of this.properties)t.AddProperty(e.Clone());return t}}class pe{constructor(e,t,i){this.v0=e,this.v1=t,this.v2=i,this.c0=null,this.c1=null,this.c2=null,this.n0=null,this.n1=null,this.n2=null,this.u0=null,this.u1=null,this.u2=null,this.mat=null,this.curve=null}HasVertices(){return null!==this.v0&&null!==this.v1&&null!==this.v2}HasVertexColors(){return null!==this.c0&&null!==this.c1&&null!==this.c2}HasNormals(){return null!==this.n0&&null!==this.n1&&null!==this.n2}HasTextureUVs(){return null!==this.u0&&null!==this.u1&&null!==this.u2}SetVertices(e,t,i){return this.v0=e,this.v1=t,this.v2=i,this}SetVertexColors(e,t,i){return this.c0=e,this.c1=t,this.c2=i,this}SetNormals(e,t,i){return this.n0=e,this.n1=t,this.n2=i,this}SetTextureUVs(e,t,i){return this.u0=e,this.u1=t,this.u2=i,this}SetMaterial(e){return this.mat=e,this}SetCurve(e){return this.curve=e,this}Clone(){var e=new pe(this.v0,this.v1,this.v2);return e.SetVertexColors(this.c0,this.c1,this.c2),e.SetNormals(this.n0,this.n1,this.n2),e.SetTextureUVs(this.u0,this.u1,this.u2),e.SetMaterial(this.mat),e.SetCurve(this.curve),e}}const ge={Empty:0,TriangleMesh:1};function ve(e){return 0<e.TriangleCount()?ge.TriangleMesh:ge.Empty}function fe(e,t,i){t=V(t,e),i=V(i,e),e=t,t=i,(i=new N(0,0,0)).x=e.y*t.z-e.z*t.y,i.y=e.z*t.x-e.x*t.z,i.z=e.x*t.y-e.y*t.x,e=i;return e.Normalize(),e}class be{constructor(e,t){this.nodeId=e,this.meshIndex=t}IsEqual(e){return this.nodeId===e.nodeId&&this.meshIndex===e.meshIndex}GetKey(){return this.nodeId.toString()+":"+this.meshIndex.toString()}}class we extends ae{constructor(e,t,i){super(),this.id=e,this.node=t,this.mesh=i}GetId(){return this.id}GetTransformation(){return this.node.GetWorldTransformation()}GetMesh(){return this.mesh}VertexCount(){return this.mesh.VertexCount()}VertexColorCount(){return this.mesh.VertexColorCount()}NormalCount(){return this.mesh.NormalCount()}TextureUVCount(){return this.mesh.TextureUVCount()}TriangleCount(){return this.mesh.TriangleCount()}EnumerateVertices(e){let t=this.node.GetWorldTransformation();t.IsIdentity()?this.mesh.EnumerateVertices(e):this.mesh.EnumerateVertices((i=>{i=t.TransformCoord3D(i),e(i)}))}EnumerateTriangleVertexIndices(e){this.mesh.EnumerateTriangleVertexIndices(e)}EnumerateTriangleVertices(e){let t=this.node.GetWorldTransformation();t.IsIdentity()?this.mesh.EnumerateTriangleVertices(e):this.mesh.EnumerateTriangleVertices(((i,s,n)=>{i=t.TransformCoord3D(i),s=t.TransformCoord3D(s),n=t.TransformCoord3D(n),e(i,s,n)}))}PropertyGroupCount(){return this.mesh.PropertyGroupCount()}AddPropertyGroup(e){return this.mesh.AddPropertyGroup(e)}GetPropertyGroup(e){return this.mesh.GetPropertyGroup(e)}GetTransformedMesh(){var e=this.node.GetWorldTransformation(),t=this.mesh.Clone(),i=t,s=e;if(!s.IsIdentity()){for(let e=0;e<i.VertexCount();e++){var n=i.GetVertex(e),r=s.TransformCoord3D(n);n.x=r.x,n.y=r.y,n.z=r.z}if(0<i.NormalCount()&&(e=s.GetMatrix().InvertTranspose(),null!==e)){var a=new Y(e);for(let e=0;e<i.NormalCount();e++){var o=i.GetNormal(e),l=a.TransformCoord3D(o);o.x=l.x,o.y=l.y,o.z=l.z}}}return t}}class xe extends ae{constructor(){super(),this.root=new ce,this.materials=[],this.meshes=[]}GetRootNode(){return this.root}MaterialCount(){return this.materials.length}MeshCount(){return this.meshes.length}MeshInstanceCount(){let e=0;return this.root.Enumerate((t=>{e+=t.MeshIndexCount()})),e}VertexCount(){let e=0;return this.EnumerateMeshInstances((t=>{e+=t.VertexCount()})),e}VertexColorCount(){let e=0;return this.EnumerateMeshInstances((t=>{e+=t.VertexColorCount()})),e}NormalCount(){let e=0;return this.EnumerateMeshInstances((t=>{e+=t.NormalCount()})),e}TextureUVCount(){let e=0;return this.EnumerateMeshInstances((t=>{e+=t.TextureUVCount()})),e}TriangleCount(){let e=0;return this.EnumerateMeshInstances((t=>{e+=t.TriangleCount()})),e}AddMaterial(e){return this.materials.push(e),this.materials.length-1}GetMaterial(e){return this.materials[e]}AddMesh(e){return this.meshes.push(e),this.meshes.length-1}AddMeshToRootNode(e){return e=this.AddMesh(e),this.root.AddMeshIndex(e),e}RemoveMesh(e){this.meshes.splice(e,1),this.root.Enumerate((t=>{for(let i=0;i<t.meshIndices.length;i++)t.meshIndices[i]===e?(t.meshIndices.splice(i,1),--i):t.meshIndices[i]>e&&--t.meshIndices[i]}))}GetMesh(e){return this.meshes[e]}GetMeshInstance(e){let t=null;var i,s;return this.root.Enumerate((i=>{i.GetId()===e.nodeId&&(t=i)})),null===t||-1===t.GetMeshIndices().indexOf(e.meshIndex)?null:(i=this.GetMesh(e.meshIndex),s=new be(t.GetId(),e.meshIndex),new we(s,t,i))}EnumerateMeshes(e){for(const t of this.meshes)e(t)}EnumerateMeshInstances(e){this.root.Enumerate((t=>{for(var i of t.GetMeshIndices()){var s=new be(t.GetId(),i);i=this.GetMesh(i),s=new we(s,t,i);e(s)}}))}EnumerateTransformedMeshes(e){this.EnumerateMeshInstances((t=>{t=t.GetTransformedMesh(),e(t)}))}EnumerateVertices(e){this.EnumerateMeshInstances((t=>{t.EnumerateVertices(e)}))}EnumerateTriangleVertexIndices(e){this.EnumerateMeshInstances((t=>{t.EnumerateTriangleVertexIndices(e)}))}EnumerateTriangleVertices(e){this.EnumerateMeshInstances((t=>{t.EnumerateTriangleVertices(e)}))}}function Ce(e){return null!=e}class ye{constructor(e){this.params={getDefaultMaterialColor:()=>new M(0,0,0)};var t=e,i=this.params;if(Ce(t))for(var s of Object.keys(t))Ce(t[s])&&(i[s]=t[s]);this.defaultMaterialIndex=null}Finalize(e){this.Reset(),this.FinalizeMeshes(e),this.FinalizeMaterials(e),this.FinalizeNodes(e)}FinalizeMaterials(e){if(0!==e.VertexColorCount()){var t,i,s=new Map;for(let t=0;t<e.MeshCount();t++){var n=e.GetMesh(t);for(let e=0;e<n.TriangleCount();e++){var r=n.GetTriangle(e),a=r.HasVertexColors();s.has(r.mat)?a||s.set(r.mat,!1):s.set(r.mat,a)}}for([t,i]of s)e.GetMaterial(t).vertexColors=i}}FinalizeMeshes(e){for(let i=0;i<e.MeshCount();i++){var t=e.GetMesh(i);ve(t)===ge.Empty?(e.RemoveMesh(i),i-=1):this.FinalizeMesh(e,t)}}FinalizeMesh(e,t){function i(e){function t(e,t,i,s,n){var r,a,o=[],l=n.get(i);for(let u=0;u<l.length;u++){var h=l[u],c=e.GetTriangle(h);t.curve!==c.curve||function(e,t){for(let i=0;i<e.length;i++)if(j(e[i],t))return 1}(o,c=s[h])||o.push(c)}let d=new N(0,0,0);for(let u=0;u<o.length;u++)r=d,a=o[u],d=new N(r.x+a.x,r.y+a.y,r.z+a.z);return d.MultiplyScalar(1/o.length),d.Normalize(),e.AddNormal(d)}var i=[],s=new Map;for(let c=0;c<e.VertexCount();c++)s.set(c,[]);for(let c=0;c<e.TriangleCount();c++){var n=e.GetTriangle(c),r=fe(e.GetVertex(n.v0),e.GetVertex(n.v1),e.GetVertex(n.v2));i.push(r),s.get(n.v0).push(c),s.get(n.v1).push(c),s.get(n.v2).push(c)}for(let c=0;c<e.TriangleCount();c++){var a,o,l,h=e.GetTriangle(c);h.HasNormals()||(a=t(e,h,h.v0,i,s),o=t(e,h,h.v1,i,s),l=t(e,h,h.v2,i,s),h.SetNormals(a,o,l))}}var s={calculateCurveNormals:!1};for(let r=0;r<t.TriangleCount();r++){var n=t.GetTriangle(r);this.FinalizeTriangle(t,n,s),null===n.mat&&(n.mat=this.GetDefaultMaterialIndex(e))}s.calculateCurveNormals&&i(t)}FinalizeTriangle(e,t,i){var s;t.HasNormals()||(null===t.curve||0===t.curve?(s=fe(e.GetVertex(t.v0),e.GetVertex(t.v1),e.GetVertex(t.v2)),e=e.AddNormal(s),t.SetNormals(e,e,e)):i.calculateCurveNormals=!0),null===t.curve&&(t.curve=0)}FinalizeNodes(e){e=e.GetRootNode();let t=[];e.EnumerateChildren((e=>{e.IsEmpty()&&t.push(e)}));for(let n=0;n<t.length;n++){var i=t[n],s=i.GetParent();null!==s&&(s.RemoveChildNode(i),s.IsEmpty())&&t.push(s)}}GetDefaultMaterialIndex(e){var t,i;return null===this.defaultMaterialIndex&&(t=this.params.getDefaultMaterialColor(),(i=new ne).color=t,i.isDefault=!0,this.defaultMaterialIndex=e.AddMaterial(i)),this.defaultMaterialIndex}Reset(){this.defaultMaterialIndex=null}}class Me{constructor(){this.name=null,this.extension=null,this.callbacks=null,this.model=null,this.error=null,this.message=null}Import(e,t,i,s){this.Clear(),this.name=e,this.extension=t,this.callbacks=s,this.model=new xe,this.error=!1,this.message=null,this.ResetContent(),this.ImportContent(i,(()=>{this.CreateResult(s)}))}Clear(){this.name=null,this.extension=null,this.callbacks=null,this.model=null,this.error=null,this.message=null,this.ClearContent()}CreateResult(e){var t,i;this.error?e.onError():function(e){let t=!0;return e.EnumerateMeshInstances((e=>{ve(e)!==ge.Empty&&(t=!1)})),t}(this.model)?(this.SetError("The model doesn't contain any meshes."),e.onError()):(t=this.model,i={getDefaultMaterialColor:this.callbacks.getDefaultMaterialColor},new ye(i).Finalize(t),e.onSuccess()),e.onComplete()}CanImportExtension(e){return!1}GetUpDirection(){return P.Z}ClearContent(){}ResetContent(){}ImportContent(e,t){}GetModel(){return this.model}SetError(e){this.error=!0,null!=e&&(this.message=e)}WasError(){return this.error}GetErrorMessage(){return this.message}}const Te={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126},Ae={SCALAR:0,VEC2:1,VEC3:2,VEC4:3,MAT2:4,MAT3:5,MAT4:6},Se={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ie={GLTF_STRING:1179937895,JSON_CHUNK_TYPE:1313821514,BINARY_CHUNK_TYPE:5130562};function Le(e){return I(L(e[0]),L(e[1]),L(e[2]))}class Ee{constructor(e){this.reader=new K(e,!0),this.componentType=null,this.dataType=null,this.byteStride=null,this.dataCount=null,this.sparseReader=null}SetComponentType(e){this.componentType=e}SetDataType(e){"SCALAR"===e?this.dataType=Ae.SCALAR:"VEC2"===e?this.dataType=Ae.VEC2:"VEC3"===e?this.dataType=Ae.VEC3:"VEC4"===e?this.dataType=Ae.VEC4:"MAT2"===e?this.dataType=Ae.MAT2:"MAT3"===e?this.dataType=Ae.MAT3:"MAT4"===e&&(this.dataType=Ae.MAT4)}SetByteStride(e){this.byteStride=e}SetDataCount(e){this.dataCount=e}SetSparseReader(e,t){this.sparseReader={indexReader:e,valueReader:t}}ReadArrayBuffer(e){return this.reader.ReadArrayBuffer(e)}GetDataCount(){return this.dataCount}ReadData(){var e,t,i,s;return null===this.dataType?null:this.dataType===Ae.SCALAR?(e=this.ReadComponent(),this.SkipBytesByStride(1),e):this.dataType===Ae.VEC2?(e=this.ReadComponent(),t=this.ReadComponent(),this.SkipBytesByStride(2),new R(e,t)):this.dataType===Ae.VEC3?(e=this.ReadComponent(),t=this.ReadComponent(),i=this.ReadComponent(),this.SkipBytesByStride(3),new N(e,t,i)):this.dataType===Ae.VEC4?(e=this.ReadComponent(),t=this.ReadComponent(),i=this.ReadComponent(),s=this.ReadComponent(),this.SkipBytesByStride(4),new z(e,t,i,s)):null}EnumerateData(e){if(null===this.sparseReader)for(let r=0;r<this.dataCount;r++)e(this.ReadData());else{var t=[];for(let e=0;e<this.sparseReader.indexReader.GetDataCount();e++){var i=this.sparseReader.indexReader.ReadData(),s=this.sparseReader.valueReader.ReadData();t.push({index:i,value:s})}let r=0;for(let i=0;i<this.dataCount;i++){var n=this.ReadData();r<t.length&&t[r].index===i?(e(t[r].value),r+=1):e(n)}}}SkipBytes(e){this.reader.Skip(e)}ReadComponent(){return null===this.componentType?null:this.componentType===Te.BYTE?this.reader.ReadCharacter8():this.componentType===Te.UNSIGNED_BYTE?this.reader.ReadUnsignedCharacter8():this.componentType===Te.SHORT?this.reader.ReadInteger16():this.componentType===Te.UNSIGNED_SHORT?this.reader.ReadUnsignedInteger16():this.componentType===Te.UNSIGNED_INT?this.reader.ReadInteger32():this.componentType===Te.FLOAT?this.reader.ReadFloat32():null}SkipBytesByStride(e){null!==this.byteStride&&(e*=this.GetComponentSize(),this.reader.Skip(this.byteStride-e))}GetComponentSize(){return this.componentType===Te.BYTE||this.componentType===Te.UNSIGNED_BYTE?1:this.componentType===Te.SHORT||this.componentType===Te.UNSIGNED_SHORT?2:this.componentType===Te.UNSIGNED_INT||this.componentType===Te.FLOAT?4:0}}class _e{constructor(){this.supportedExtensions=["KHR_draco_mesh_compression","KHR_materials_pbrSpecularGlossiness","KHR_texture_transform"],this.draco=null}LoadLibraries(e,t){void 0!==e&&null===this.draco&&-1!==e.indexOf("KHR_draco_mesh_compression")?Q("loaders/draco_decoder.js").then((()=>{DracoDecoderModule().then((e=>{this.draco=e,t.onSuccess()}))})).catch((()=>{t.onError("Failed to load draco decoder.")})):t.onSuccess()}GetUnsupportedExtensions(e){var t=[];if(void 0!==e)for(let s=0;s<e.length;s++){var i=e[s];-1===this.supportedExtensions.indexOf(i)&&t.push(i)}return t}ProcessMaterial(e,t,i){var s,n;return void 0===e.extensions||void 0===(e=e.extensions.KHR_materials_pbrSpecularGlossiness)?null:(s=new ne,void 0!==(n=e.diffuseFactor)&&(s.color=Le(n),s.opacity=n[3]),void 0!==(n=e.diffuseTexture)&&(s.diffuseMap=i(n)),void 0!==(n=e.specularFactor)&&(s.specular=Le(n)),void 0!==(n=e.specularGlossinessTexture)&&(s.specularMap=i(n)),void 0!==(i=e.glossinessFactor)&&(s.shininess=i),s)}ProcessTexture(e,t){void 0!==e.extensions&&void 0!==(e=e.extensions.KHR_texture_transform)&&(void 0!==e.offset&&(t.offset.x=e.offset[0],t.offset.y=-e.offset[1]),void 0!==e.scale&&(t.scale.x=e.scale[0],t.scale.y=e.scale[1]),void 0!==e.rotation)&&(t.rotation=-e.rotation)}ProcessPrimitive(e,t,i,s){function n(e,t,i,s,n){s=t.GetAttributeByUniqueId(i,s);var r=s.num_components(),a=i.num_points()*r,o=4*a,l=e._malloc(o),h=(t.GetAttributeDataArrayForAllPoints(i,s,e.DT_FLOAT32,o,l),new Float32Array(e.HEAPF32.buffer,l,a).slice());if(2===r)for(let c=0;c<h.length;c+=2)n(new R(h[c+0],h[c+1]));else if(3===r)for(let c=0;c<h.length;c+=3)n(new N(h[c+0],h[c+1],h[c+2]));else if(4===r)for(let c=0;c<h.length;c+=4)n(new z(h[c+0],h[c+1],h[c+2],h[c+3]));e._free(l)}if(null===this.draco)return!1;if(void 0===i.extensions||void 0===i.extensions.KHR_draco_mesh_compression)return!1;var r=new this.draco.Decoder,a=new this.draco.DecoderBuffer,o=i.extensions.KHR_draco_mesh_compression;t=t.bufferViews[o.bufferView],t=e.GetReaderFromBufferView(t).ReadArrayBuffer(t.byteLength),a.Init(new Int8Array(t),t.byteLength),t=r.GetEncodedGeometryType(a);if(t===this.draco.TRIANGULAR_MESH&&(t=new this.draco.Mesh,r.DecodeBufferToMesh(a,t).ok())){a=void 0!==o.attributes.POSITION;var l=void 0!==o.attributes.NORMAL,h=void 0!==o.attributes.TEXCOORD_0;if(a){var c=s.VertexCount(),d=s.VertexColorCount(),u=s.NormalCount(),m=s.TextureUVCount(),p=(a=(n(this.draco,r,t,o.attributes.POSITION,(e=>{s.AddVertex(e)})),l&&n(this.draco,r,t,o.attributes.NORMAL,(e=>{s.AddNormal(e)})),h&&n(this.draco,r,t,o.attributes.TEXCOORD_0,(e=>{e.y=-e.y,s.AddTextureUV(e)})),t.num_faces()),o=3*a,a=4*o,this.draco._malloc(a)),g=(r.GetTrianglesUInt32Array(t,a,p),new Uint32Array(this.draco.HEAPU32.buffer,p,o).slice());for(let t=0;t<g.length;t+=3){var v=g[t],f=g[t+1],b=g[t+2];e.AddTriangle(i,s,v,f,b,!1,l,h,c,d,u,m)}this.draco._free(p)}}return!0}}class ke extends Me{constructor(){super(),this.gltfExtensions=new _e}CanImportExtension(e){return"gltf"===e||"glb"===e}GetUpDirection(){return P.Y}ClearContent(){this.bufferContents=null,this.imageIndexToTextureParams=null}ResetContent(){this.bufferContents=[],this.imageIndexToTextureParams=new Map}ImportContent(e,t){"gltf"===this.extension?this.ProcessGltf(e,t):"glb"===this.extension&&this.ProcessBinaryGltf(e,t)}ProcessGltf(e,t){e=q(e);var i=JSON.parse(e);if("2.0"!==i.asset.version)this.SetError("Invalid glTF version."),t();else{for(let e=0;e<i.buffers.length;e++){let r=null;var s=i.buffers[e],n=$(s.uri);if(null!==n?r=n.buffer:null!==(n=this.callbacks.getFileBuffer(s.uri))&&(r=n),null===r)return this.SetError("One of the requested buffers is missing."),void t();this.bufferContents.push(r)}this.ProcessMainFile(i,t)}}ProcessBinaryGltf(e,t){var i=new K(e,!0);if(i.ReadUnsignedInteger32()!==Ie.GLTF_STRING)this.SetError("Invalid glTF file."),t();else{var s;e=i.ReadUnsignedInteger32();if(2!==e)this.SetError("Invalid glTF version."),t();else if(i.ReadUnsignedInteger32()!==i.GetByteLength())this.SetError("Invalid glTF file."),t();else{let r=null;for(;!i.End();){s=void 0,s=(n=i).ReadUnsignedInteger32();var n={type:n.ReadUnsignedInteger32(),buffer:n.ReadArrayBuffer(s)};n.type===Ie.JSON_CHUNK_TYPE?r=q(n.buffer):n.type===Ie.BINARY_CHUNK_TYPE&&this.bufferContents.push(n.buffer)}null!==r&&(e=JSON.parse(r),this.ProcessMainFile(e,t))}}}ProcessMainFile(e,t){var i=this.gltfExtensions.GetUnsupportedExtensions(e.extensionsRequired);0<i.length?(this.SetError("Unsupported extension: "+i.join(", ")+"."),t()):this.gltfExtensions.LoadLibraries(e.extensionsRequired,{onSuccess:()=>{this.ImportModel(e),t()},onError:e=>{this.SetError(e),t()}})}ImportModel(e){var t=e.materials;if(void 0!==t)for(var i of t)this.ImportMaterial(e,i);if(t=e.meshes,void 0!==t)for(var s of t)this.ImportMesh(e,s);this.ImportNodes(e),this.ImportModelProperties(e)}ImportModelProperties(e){function t(e,t,i){var s,n,r=new me(t);for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&"string"==typeof i[s]&&(n=new ue(de.Text,s,i[s]),r.AddProperty(n));0<r.PropertyCount()&&e.AddPropertyGroup(r)}t(this.model,"Asset properties",e.asset),e.asset.extras&&t(this.model,"Extras",e.asset.extras)}GetDefaultScene(e){var t=e.scene||0;return t>=e.scenes.length?null:e.scenes[t]}ImportMaterial(e,t){let i=new re;void 0!==t.name&&(i.name=t.name),i.color=Le([1,1,1]),void 0!==t.pbrMetallicRoughness&&(void 0!==(s=t.pbrMetallicRoughness.baseColorFactor)&&(i.color=Le(s),i.opacity=s[3]),void 0!==(s=t.pbrMetallicRoughness.metallicFactor)&&(i.metalness=s),void 0!==(s=t.pbrMetallicRoughness.roughnessFactor)&&(i.roughness=s),void 0!==(s=t.emissiveFactor)&&(i.emissive=Le(s)),i.diffuseMap=this.ImportTexture(e,t.pbrMetallicRoughness.baseColorTexture),i.metalnessMap=this.ImportTexture(e,t.pbrMetallicRoughness.metallicRoughnessTexture),i.normalMap=this.ImportTexture(e,t.normalTexture),i.emissiveMap=this.ImportTexture(e,t.emissiveTexture),null!==i.diffuseMap&&(i.multiplyDiffuseMap=!0),void 0!==(s=t.alphaMode))&&("BLEND"===s?i.transparent=!0:"MASK"===s&&(i.transparent=!0,i.alphaTest=t.alphaCutoff||.5));var s=this.gltfExtensions.ProcessMaterial(t,i,(t=>this.ImportTexture(e,t)));null!==s&&(i=s),this.model.AddMaterial(i)}ImportTexture(e,t){if(null==t)return null;var i,s,n=new ee,r=e.textures[t.index].source,a=e.images[r];let o=null;return this.imageIndexToTextureParams.has(r)?o=this.imageIndexToTextureParams.get(r):(o={name:null,mimeType:null,buffer:null},i=r.toString(),void 0!==a.uri?null!==(s=$(a.uri))?(o.name="Embedded_"+i+"."+X(s.mimeType),o.mimeType=s.mimeType,o.buffer=s.buffer):(s=this.callbacks.getFileBuffer(a.uri),o.name=a.uri,o.buffer=s):void 0!==a.bufferView&&(s=e.bufferViews[a.bufferView],null!==(e=this.GetReaderFromBufferView(s)))&&(e=e.ReadArrayBuffer(s.byteLength),o.name="Binary_"+i+"."+X(a.mimeType),o.mimeType=a.mimeType,o.buffer=e),this.imageIndexToTextureParams.set(r,o)),n.name=o.name,n.mimeType=o.mimeType,n.buffer=o.buffer,this.gltfExtensions.ProcessTexture(t,n),n}ImportMesh(e,t){var i=new oe;this.model.AddMesh(i),void 0!==t.name&&i.SetName(t.name);for(let n=0;n<t.primitives.length;n++){var s=t.primitives[n];this.ImportPrimitive(e,s,i)}}ImportPrimitive(e,t,i){if(!this.gltfExtensions.ProcessPrimitive(this,e,t,i)&&void 0!==t.attributes){var s=void 0!==t.attributes.POSITION,n=void 0!==t.attributes.COLOR_0,r=void 0!==t.attributes.NORMAL,a=void 0!==t.attributes.TEXCOORD_0,o=void 0!==t.indices;let C=Se.TRIANGLES;if((C=void 0!==t.mode?t.mode:C)===Se.TRIANGLES||C===Se.TRIANGLE_STRIP||C===Se.TRIANGLE_FAN){var l=i.VertexCount(),h=i.VertexColorCount(),c=i.NormalCount(),d=i.TextureUVCount();if(s&&(s=e.accessors[t.attributes.POSITION],s=this.GetReaderFromAccessor(e,s),null!==s)){if(s.EnumerateData((e=>{i.AddVertex(e)})),n){s=e.accessors[t.attributes.COLOR_0];let n=this.GetReaderFromAccessor(e,s);if(null===n)return;n.EnumerateData((e=>{e=[e.x,e.y,e.z],t=n.componentType;var t;e=new M(s(e[0],t),s(e[1],t),s(e[2],t));function s(e,t){let i=e;return t===Te.UNSIGNED_BYTE?i/=255:t===Te.UNSIGNED_SHORT&&(i/=65535),A(L(i))}i.AddVertexColor(e)}))}if(r){if(s=e.accessors[t.attributes.NORMAL],s=this.GetReaderFromAccessor(e,s),null===s)return;s.EnumerateData((e=>{i.AddNormal(e)}))}if(a){if(s=e.accessors[t.attributes.TEXCOORD_0],s=this.GetReaderFromAccessor(e,s),null===s)return;s.EnumerateData((e=>{e.y=-e.y,i.AddTextureUV(e)}))}let y=[];if(o){if(s=e.accessors[t.indices],o=this.GetReaderFromAccessor(e,s),null===o)return;o.EnumerateData((e=>{y.push(e)}))}else{var u=i.VertexCount()-l;for(let e=0;e<u;e++)y.push(e)}if(C===Se.TRIANGLES)for(let e=0;e<y.length;e+=3){var m=y[e],p=y[e+1],g=y[e+2];this.AddTriangle(t,i,m,p,g,n,r,a,l,h,c,d)}else if(C===Se.TRIANGLE_STRIP)for(let e=0;e<y.length-2;e++){var v,f=y[e];let s=y[e+1],o=y[e+2];e%2==1&&(v=s,s=o,o=v),this.AddTriangle(t,i,f,s,o,n,r,a,l,h,c,d)}else if(C===Se.TRIANGLE_FAN)for(let e=1;e<y.length-1;e++){var b=y[0],w=y[e],x=y[e+1];this.AddTriangle(t,i,b,w,x,n,r,a,l,h,c,d)}}}}}AddTriangle(e,t,i,s,n,r,a,o,l,h,c,d){l=new pe(l+i,l+s,l+n),r&&l.SetVertexColors(h+i,h+s,h+n),a&&l.SetNormals(c+i,c+s,c+n),o&&l.SetTextureUVs(d+i,d+s,d+n),void 0!==e.material&&(l.mat=e.material),t.AddTriangle(l)}ImportNodes(e){var t=this.GetDefaultScene(e);if(null!==t){var i,s=this.model.GetRootNode();for(i of t.nodes){var n=e.nodes[i];this.ImportNode(e,n,s)}}}ImportNode(e,t,i){if(void 0!==t.children||void 0!==t.mesh){var s=new ce;if(void 0!==t.name&&s.SetName(t.name),s.SetTransformation(function(e){var t=(new W).CreateIdentity();if(void 0!==e.matrix)t.Set(e.matrix);else{let i=[0,0,0],s=[0,0,0,1],n=[1,1,1];void 0!==e.translation&&(i=e.translation),void 0!==e.rotation&&(s=e.rotation),void 0!==e.scale&&(n=e.scale),t.ComposeTRS(B(i),(e=s,new H(e[0],e[1],e[2],e[3])),B(n))}return new Y(t)}(t)),i.AddChildNode(s),void 0!==t.children)for(var n of t.children)n=e.nodes[n],this.ImportNode(e,n,s);void 0!==t.mesh&&(void 0!==t.children&&0!==t.children.length||s.SetType(he.MeshNode),s.AddMeshIndex(t.mesh))}}GetReaderFromBufferView(e){var t=e.buffer||0;t=this.bufferContents[t];return null==t?null:((t=new Ee(t)).SkipBytes(e.byteOffset||0),void 0!==(e=e.byteStride)&&0!==e&&t.SetByteStride(e),t)}GetReaderFromAccessor(e,t){var i,s=t.bufferView||0;s=e.bufferViews[s],s=this.GetReaderFromBufferView(s);return null===s?null:(s.SetComponentType(t.componentType),s.SetDataType(t.type),s.SetDataCount(t.count),s.SkipBytes(t.byteOffset||0),void 0!==t.sparse&&(i=this.GetReaderFromSparseAccessor(e,t.sparse.indices,t.sparse.indices.componentType,"SCALAR",t.sparse.count),e=this.GetReaderFromSparseAccessor(e,t.sparse.values,t.componentType,t.type,t.sparse.count),null!==i)&&null!==e&&s.SetSparseReader(i,e),s)}GetReaderFromSparseAccessor(e,t,i,s,n){return void 0===t.bufferView||(e=e.bufferViews[t.bufferView],null===(e=this.GetReaderFromBufferView(e)))?null:(e.SetComponentType(i),e.SetDataType(s),e.SetDataCount(n),e.SkipBytes(t.byteOffset||0),e)}}function Fe(e,t,i){let s=e.substring(t);return e=s.indexOf(i),(s=-1!==e?s.substring(0,e):s).trim()}function Ge(e,t){function i(e,t){e=e.trim(),0<e.length&&t(e)}let s=0,n=e.indexOf("\n",s);for(;-1!==n;)i(e.substring(s,n),t),s=n+1,n=e.indexOf("\n",s);i(e.substring(s),t)}function Oe(e){var t;e.transparent=!1,t=e.opacity,1-t>G&&(e.transparent=!0)}class Pe{constructor(e){this.mesh=e,this.globalToMeshVertices=new Map,this.globalToMeshVertexColors=new Map,this.globalToMeshNormals=new Map,this.globalToMeshUvs=new Map}AddVertex(e,t){return this.GetLocalIndex(e,t,this.globalToMeshVertices,(e=>this.mesh.AddVertex(new N(e.x,e.y,e.z))))}AddVertexColor(e,t){return this.GetLocalIndex(e,t,this.globalToMeshVertexColors,(e=>this.mesh.AddVertexColor(new M(e.r,e.g,e.b))))}AddNormal(e,t){return this.GetLocalIndex(e,t,this.globalToMeshNormals,(e=>this.mesh.AddNormal(new N(e.x,e.y,e.z))))}AddUV(e,t){return this.GetLocalIndex(e,t,this.globalToMeshUvs,(e=>this.mesh.AddTextureUV(new R(e.x,e.y))))}AddTriangle(e){this.mesh.AddTriangle(e)}GetLocalIndex(e,t,i,s){return isNaN(e)||e<0||e>=t.length?null:i.has(e)?i.get(e):(s=s(t[e]),i.set(e,s),s)}}function Re(e,t,i){return I(parseFloat(e),parseFloat(t),parseFloat(i))}class De extends Me{constructor(){super()}CanImportExtension(e){return"obj"===e}GetUpDirection(){return P.Y}ClearContent(){this.globalVertices=null,this.globalVertexColors=null,this.globalNormals=null,this.globalUvs=null,this.currentMeshConverter=null,this.currentMaterial=null,this.currentMaterialIndex=null,this.meshNameToConverter=null,this.materialNameToIndex=null}ResetContent(){this.globalVertices=[],this.globalVertexColors=[],this.globalNormals=[],this.globalUvs=[],this.currentMeshConverter=null,this.currentMaterial=null,this.currentMaterialIndex=null,this.meshNameToConverter=new Map,this.materialNameToIndex=new Map}ImportContent(e,t){e=q(e),Ge(e,(e=>{this.WasError()||this.ProcessLine(e)})),t()}ProcessLine(e){var t,i;"#"===e[0]||(i=e,0===(t=(i=null!==(t="#")&&-1!==(t=i.indexOf(t))?i.substring(0,t).trim():i).split(/\s+/u)).length)||(i=t[0].toLowerCase(),t.shift(),this.ProcessMeshParameter(i,t,e))||this.ProcessMaterialParameter(i,t,e)}AddNewMesh(e){var t;this.meshNameToConverter.has(e)?this.currentMeshConverter=this.meshNameToConverter.get(e):((t=new oe).SetName(e),this.model.AddMeshToRootNode(t),this.currentMeshConverter=new Pe(t),this.meshNameToConverter.set(e,this.currentMeshConverter))}ProcessMeshParameter(e,t,i){return"g"===e||"o"===e?(0!==t.length&&(i=Fe(i,e.length,"#"),this.AddNewMesh(i)),!0):"v"===e?(t.length<3||(this.globalVertices.push(new N(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))),6<=t.length&&this.globalVertexColors.push(Re(t[3],t[4],t[5]))),!0):"vn"===e?(t.length<3||this.globalNormals.push(new N(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))),!0):"vt"===e?(t.length<2||this.globalUvs.push(new R(parseFloat(t[0]),parseFloat(t[1]))),!0):"f"===e&&(t.length<3||this.ProcessFace(t),!0)}ProcessMaterialParameter(e,t,i){function s(e,t,i){var s=new ee;t=Fe(t,e.length,"#"),e=i.getFileBuffer(t);return s.name=t,s.buffer=e,s}var n,r,a;return"newmtl"===e?(0!==t.length&&(n=new ne,r=Fe(i,e.length,"#"),a=this.model.AddMaterial(n),n.name=r,this.currentMaterial=n,this.materialNameToIndex.set(r,a)),!0):"usemtl"===e?(0!==t.length&&(n=Fe(i,e.length,"#"),this.materialNameToIndex.has(n))&&(this.currentMaterialIndex=this.materialNameToIndex.get(n)),!0):"mtllib"===e?(0!==t.length&&(r=Fe(i,e.length,"#"),null!==(a=this.callbacks.getFileBuffer(r)))&&Ge(q(a),(e=>{this.WasError()||this.ProcessLine(e)})),!0):"map_kd"===e?(null!==this.currentMaterial&&0!==t.length&&(this.currentMaterial.diffuseMap=s(e,i,this.callbacks),Oe(this.currentMaterial)),!0):"map_ks"===e?(null!==this.currentMaterial&&0!==t.length&&(this.currentMaterial.specularMap=s(e,i,this.callbacks)),!0):"map_bump"===e||"bump"===e?(null!==this.currentMaterial&&0!==t.length&&(this.currentMaterial.bumpMap=s(e,i,this.callbacks)),!0):"ka"===e?(null===this.currentMaterial||t.length<3||(this.currentMaterial.ambient=Re(t[0],t[1],t[2])),!0):"kd"===e?(null===this.currentMaterial||t.length<3||(this.currentMaterial.color=Re(t[0],t[1],t[2])),!0):"ks"===e?(null===this.currentMaterial||t.length<3||(this.currentMaterial.specular=Re(t[0],t[1],t[2])),!0):"ns"===e?(null===this.currentMaterial||t.length<1||(this.currentMaterial.shininess=parseFloat(t[0])/1e3),!0):"tr"===e?(null===this.currentMaterial||t.length<1||(this.currentMaterial.opacity=1-parseFloat(t[0]),Oe(this.currentMaterial)),!0):"d"===e&&(null===this.currentMaterial||t.length<1||(this.currentMaterial.opacity=parseFloat(t[0]),Oe(this.currentMaterial)),!0)}ProcessFace(e){function t(e,t){return 0<e?e-1:t+e}var i=[],s=[],n=[],r=[];for(let u=0;u<e.length;u++){var a=e[u].split("/");i.push(t(parseInt(a[0],10),this.globalVertices.length)),this.globalVertices.length===this.globalVertexColors.length&&s.push(t(parseInt(a[0],10),this.globalVertices.length)),1<a.length&&0<a[1].length&&r.push(t(parseInt(a[1],10),this.globalUvs.length)),2<a.length&&0<a[2].length&&n.push(t(parseInt(a[2],10),this.globalNormals.length))}null===this.currentMeshConverter&&this.AddNewMesh("");for(let u=0;u<i.length-2;u++){var o=this.currentMeshConverter.AddVertex(i[0],this.globalVertices),l=this.currentMeshConverter.AddVertex(i[u+1],this.globalVertices),h=this.currentMeshConverter.AddVertex(i[u+2],this.globalVertices);if(null===o||null===l||null===h){this.SetError("Invalid vertex index.");break}if(o=new pe(o,l,h),s.length===i.length){l=this.currentMeshConverter.AddVertexColor(s[0],this.globalVertexColors),h=this.currentMeshConverter.AddVertexColor(s[u+1],this.globalVertexColors);var c=this.currentMeshConverter.AddVertexColor(s[u+2],this.globalVertexColors);if(null===l||null===h||null===c){this.SetError("Invalid vertex color index.");break}o.SetVertexColors(l,h,c)}if(n.length===i.length){if(l=this.currentMeshConverter.AddNormal(n[0],this.globalNormals),h=this.currentMeshConverter.AddNormal(n[u+1],this.globalNormals),c=this.currentMeshConverter.AddNormal(n[u+2],this.globalNormals),null===l||null===h||null===c){this.SetError("Invalid normal index.");break}o.SetNormals(l,h,c)}if(r.length===i.length){l=this.currentMeshConverter.AddUV(r[0],this.globalUvs),h=this.currentMeshConverter.AddUV(r[u+1],this.globalUvs);var d=this.currentMeshConverter.AddUV(r[u+2],this.globalUvs);if(null===l||null===h||null===d){this.SetError("Invalid uv index.");break}o.SetTextureUVs(l,h,d)}null!==this.currentMaterialIndex&&(o.mat=this.currentMaterialIndex),this.currentMeshConverter.AddTriangle(o)}}}const Ne={Phong:1,Physical:2};function je(e){return new p.Ilk(e.r/255,e.g/255,e.b/255)}var Ve=i(3626);class Ue{constructor(){this.defaultColor=new M(200,200,200)}}const Be={NoImportableFile:1,FailedToLoadFile:2,ImportFailed:3,UnknownError:4};class ze{constructor(e){this.code=e,this.mainFile=null,this.message=null}}class He{constructor(){this.model=null,this.mainFile=null,this.upVector=null,this.usedFiles=null,this.missingFiles=null}}class We{constructor(e){this.getBufferCallback=e,this.fileBuffers=new Map}GetFileBuffer(e){var t;e=w(e);return this.fileBuffers.has(e)?this.fileBuffers.get(e):(t=this.getBufferCallback(e),this.fileBuffers.set(e,t),t)}}class Ye{constructor(){this.importers=[new De,new ke],this.fileList=new F,this.model=null,this.usedFiles=[],this.missingFiles=[]}AddImporter(e){this.importers.push(e)}ImportFiles(e,t,i){i.onLoadStart(),this.LoadFiles(e,{onReady:()=>{i.onImportStart(),v((()=>{this.DecompressArchives(this.fileList,(()=>{this.ImportLoadedFiles(t,i)}))}))},onFileListProgress:i.onFileListProgress,onFileLoadProgress:i.onFileLoadProgress})}LoadFiles(e,t){var i=new F;i.FillFromInputFiles(e);let s=!1;if(this.HasImportableFile(i))s=!0;else{let e=!1;for(let t=0;t<this.missingFiles.length;t++){var n=this.missingFiles[t];i.ContainsFileByPath(n)&&(e=!0)}s=!e||(this.fileList.ExtendFromFileList(i),!1)}s&&(this.fileList=i),this.fileList.GetContent({onReady:t.onReady,onFileListProgress:t.onFileListProgress,onFileLoadProgress:t.onFileLoadProgress})}ImportLoadedFiles(e,t){let i=this.GetImportableFiles(this.fileList);var s;0===i.length?t.onImportError(new ze(Be.NoImportableFile)):1!==i.length&&t.onSelectMainFile?(s=i.map((e=>e.file.name)),alert(s,"fileNames"),t.onSelectMainFile(s,(s=>{null===s?t.onImportError(new ze(Be.NoImportableFile)):v((()=>{var n=i[s];this.ImportLoadedMainFile(n,e,t)}))}))):(s=i[0],this.ImportLoadedMainFile(s,e,t))}ImportLoadedMainFile(e,t,i){var s;if(null===e||null===e.file||null===e.file.content)s=new ze(Be.FailedToLoadFile),null!==e&&null!==e.file&&(s.mainFile=e.file.name),i.onImportError(s);else{this.model=null,this.usedFiles=[],this.missingFiles=[],this.usedFiles.push(e.file.name);let s=e.importer,n=new We((e=>{var t=this.fileList.FindFileByPath(e);return null===t||null===t.content?(this.missingFiles.push(e),null):(this.usedFiles.push(e),t.content)}));s.Import(e.file.name,e.file.extension,e.file.content,{getDefaultMaterialColor:()=>t.defaultColor,getFileBuffer:e=>n.GetFileBuffer(e),onSuccess:()=>{this.model=s.GetModel();var t=new He;t.mainFile=e.file.name,t.model=this.model,t.usedFiles=this.usedFiles,t.missingFiles=this.missingFiles,t.upVector=s.GetUpDirection(),i.onImportSuccess(t)},onError:()=>{var t=new ze(Be.ImportFailed);t.mainFile=e.file.name,t.message=s.GetErrorMessage(),i.onImportError(t)},onComplete:()=>{s.Clear()}})}}DecompressArchives(e,t){var i,s=[];for(i of e.GetFiles())"zip"===i.extension&&s.push(i);if(0!==s.length)for(let o=0;o<s.length;o++){var n,r=s[o],a=(r=new Uint8Array(r.content),Ve.GZ(r));for(const t in a)Object.prototype.hasOwnProperty.call(a,t)&&((n=new k(t,b.Decompressed,null)).SetContent(a[t].buffer),e.AddFile(n))}t()}GetFileList(){return this.fileList}HasImportableFile(e){return 0<this.GetImportableFiles(e).length}GetImportableFiles(e){var t=[],i=e.GetFiles();for(let r=0;r<i.length;r++){var s=i[r],n=function(e,t){for(let s=0;s<t.length;s++){var i=t[s];if(i.CanImportExtension(e.extension))return i}return null}(s,this.importers);null!==n&&t.push({file:s,importer:n})}return t}}class Ke{constructor(e,t){this.x=e,this.y=t}Clone(){return new Ke(this.x,this.y)}}function qe(e){return Math.round(parseFloat(e))}function $e(e){return qe(e.paddingTop)+qe(e.paddingBottom)+(qe(e.borderTopWidth)+qe(e.borderBottomWidth))+(qe(e.marginTop)+qe(e.marginBottom))}function Xe(e){return qe(e.paddingLeft)+qe(e.paddingRight)+(qe(e.borderLeftWidth)+qe(e.borderRightWidth))+(qe(e.marginLeft)+qe(e.marginRight))}function Ze(e,t,i){return e=document.createElement(e),t&&(e.className=t),i&&(e.innerHTML=i),e}function Je(e,t,i,s){return t=Ze(t,i,s),e.appendChild(t),t}function Qe(e,t,i){return e.getBoundingClientRect&&(t-=(e=e.getBoundingClientRect()).left,i-=e.top),window.pageXOffset&&window.pageYOffset&&(t+=window.pageXOffset,i+=window.pageYOffset),new Ke(t,i)}var et=i(7985);class tt{constructor(e,t,i,s){this.eye=e,this.center=t,this.up=i,this.fov=s}Clone(){return new tt(this.eye.Clone(),this.center.Clone(),this.up.Clone(),this.fov)}}const it=1e-8;function st(e,t){return Math.abs(t-e)<it}function nt(e,t){return st(e.x,t.x)&&st(e.y,t.y)&&st(e.z,t.z)}class rt{constructor(e){this.scene=e,this.mainObject=null,this.iSectObject=null}GetSectObject(){return this.iSectObject}GetMainObject(){return this.mainObject}SetMainObject(e){this.mainObject=e,this.mainObject.traverse((function(e){e.castShadow=!0})),this.scene.add(this.mainObject)}Clear(){this.ClearMainObject()}ClearMainObject(){null!==this.mainObject&&(this.EnumerateMeshes((e=>{e.geometry.dispose()})),this.scene.remove(this.mainObject),this.mainObject=null)}EnumerateMeshes(e){null!==this.mainObject&&this.mainObject.traverse((t=>{t.isMesh&&e(t)}))}GetMeshIntersectionUnderMouse(e,t,i,s){if(null!==this.mainObject&&!(e.x<0||e.x>i||e.y<0||e.y>s)){var n=new p.iMs,r=new p.FM8,a=(r.x=e.x/i*2-1,r.y=-e.y/s*2+1,n.setFromCamera(r,t),n.intersectObject(this.mainObject,!0));for(let e=0;e<a.length;e++){var o=a[e];if("Mesh"===o.object.type||"SkinnedMesh"===o.object.type&&o.object.visible)return this.iSectObject=o}}return null}GetBoundingSphere(e){var t;e=this.GetBoundingBox(e);return null===e?null:(t=new p.aLr,e.getBoundingSphere(t),t)}GetBoundingBox(e){if(null!==this.mainObject)return(new p.ZzF).setFromObject(this.mainObject)}}class at{constructor(e){this.scene=e,this.ExtraObject=null}AddObject(e){null===this.ExtraObject&&(this.ExtraObject=new p.Tme,this.scene.add(this.ExtraObject)),this.ExtraObject.add(e)}Clear(){null!==this.ExtraObject&&(this.ExtraObject.traverse((e=>{(e.isMesh||e.isLineSegments)&&e.geometry.dispose()})),this.scene.remove(this.ExtraObject),this.ExtraObject=null)}}function ot(e,t,i){return t/=i,i=t*t,e*(i/(2*(i-t)+1))}function lt(e,t,i,s){var n=V(t,e).Normalize(),r=Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)+(e.z-t.z)*(e.z-t.z)),a=[];for(let l=0;l<i;l++){var o=s(r,l,i-1);a.push(e.Clone().Offset(n,o))}return a}class ht{constructor(e,t,i,s){this.container=t,this.canvas=e,this.camera=i,this.callbacks=s,this.mouse=new dt,this.clickDetector=new ct,this.onMouseClick=null,this.onMouseMove=null,this.canvas.addEventListener&&this.canvas.addEventListener("mousedown",this.OnMouseDown.bind(this)),this.container.addEventListener&&(this.container.addEventListener("mousemove",this.OnMouseMove.bind(this)),this.container.addEventListener("mouseup",this.OnMouseUp.bind(this)),this.container.addEventListener("mouseleave",this.OnMouseLeave.bind(this)))}GetFitToSphereCamera(e,t,i=!1){if(Math.abs(t)<G)return null;var s=this.camera.Clone(),n=V(s.center,e);s.eye=V(s.eye,n),s.center=e.Clone(),n=V(s.eye,s.center).Normalize();let r=this.camera.fov/2,a=(this.canvas.width<this.canvas.height&&(r=r*this.canvas.width/this.canvas.height),t/Math.sin(.017453292519943*r));return i&&(a*=.3),s.eye=s.center.Clone().Offset(n,a),s}Update(){this.callbacks.onUpdate()}GetCamera(){return this.camera}SetCamera(e){this.camera=e}MoveCamera(e,t){if(null!==e){if(0===t||(i=this.camera,s=e,nt(i.eye,s.eye)&&nt(i.center,s.center)&&nt(i.up,s.up)))this.camera=e;else{i=ot;let s={eye:lt(this.camera.eye,e.eye,t,i),center:lt(this.camera.center,e.center,t,i),up:lt(this.camera.up,e.up,t,i)};requestAnimationFrame((()=>{!function e(t,i,s,n){t.camera.eye=i.eye[n],t.camera.center=i.center[n],t.camera.up=i.up[n],t.Update(),n<s-1&&requestAnimationFrame((()=>{e(t,i,s,n+1)}))}(this,s,t,0)}))}var i,s;this.Update()}}OnMouseDown(e){e.preventDefault(),this.mouse.Down(this.canvas,e),this.clickDetector.Start(this.mouse.GetPosition()),this.canvas.style.cursor="grabbing"}DoubleClick(e,t){}OnMouseMove(e){this.mouse.Move(this.canvas,e),this.clickDetector.Move(this.mouse.GetPosition()),this.onMouseMove&&(e=Qe(this.canvas,e.clientX,e.clientY),this.onMouseMove(e)),this.mouse.IsButtonDown()&&(this.mouse.GetMoveDiff(),1===this.mouse.GetButton())&&(this.canvas.style.cursor="grabbing")}OnMouseUp(e){var t;this.mouse.Up(this.canvas,e),this.clickDetector.End(),this.clickDetector.IsClick()&&(t=this.mouse.GetPosition(),this.Click(e.which,t)),this.canvas.style.cursor="grab"}DoubleClick(e,t){alert("双击")}OnMouseLeave(e){this.mouse.Leave(this.canvas,e),this.clickDetector.Cancel(),this.canvas.style.cursor="grab"}SetMouseClickHandler(e){this.onMouseClick=e}SetMouseMoveHandler(e){this.onMouseMove=e}Click(e,t){this.onMouseClick&&this.onMouseClick(e,t)}}class ct{constructor(){this.isClick=!1,this.startPosition=null,this.lastClickTime=0}Start(e){var t=(new Date).getTime();t-this.lastClickTime<=300?this.isClick=!1:(this.isClick=!0,this.startPosition=e),this.lastClickTime=t}Move(e){var t;this.isClick&&(null===this.startPosition||(t=this.startPosition,3<Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))))&&this.Cancel()}End(){this.startPosition=null}Cancel(){this.isClick=!1,this.startPosition=null,this.lastClickTime=0}IsClick(){return this.isClick}}class dt{constructor(){this.prev=new Ke(0,0),this.curr=new Ke(0,0),this.diff=new Ke(0,0),this.buttons=[]}Down(e,t){this.buttons.push(t.which),this.curr=this.GetPositionFromEvent(e,t),this.prev=this.curr.Clone()}Move(e,t){this.curr=this.GetPositionFromEvent(e,t),this.diff=(e=this.curr,t=this.prev,new Ke(e.x-t.x,e.y-t.y)),this.prev=this.curr.Clone()}Up(e,t){var i=this.buttons.indexOf(t.which);-1!==i&&this.buttons.splice(i,1),this.curr=this.GetPositionFromEvent(e,t)}Leave(e,t){this.buttons=[],this.curr=this.GetPositionFromEvent(e,t)}IsButtonDown(){return 0<this.buttons.length}GetButton(){var e=this.buttons.length;return 0===e?0:this.buttons[e-1]}GetPosition(){return this.curr}GetMoveDiff(){return this.diff}GetPositionFromEvent(e,t){return Qe(e,t.clientX,t.clientY)}}class ut{constructor(e,t){this.camera=t,this.scene=e,this.ambientLight=new p.Mig(4210752,3),this.directionalLight=new p.Ox3(16777215,1),this.directionalLight.name="directionalLight",this.directionalLight.castShadow=!0,this.environment=null,this.backgroundIsEnvMap=!1,this.scene.add(this.ambientLight),this.scene.add(this.directionalLight)}SetType(e){this.type=e,this.UpdateShading()}SetEnvironment(e,t,i){var s=new p.cBK;this.environment=s.load(e,(()=>{i()})),this.backgroundIsEnvMap=t}UpdateShading(){this.type===Ne.Phong?(this.ambientLight.color.set(8947848),this.directionalLight.color.set(8947848),this.scene.environment=null):this.type===Ne.Physical&&(this.ambientLight.color.set(0),this.directionalLight.color.set(5592405),this.scene.environment=this.environment),this.backgroundIsEnvMap?this.scene.background=this.environment:this.scene.background=null}UpdateByCamera(e){e=V(e.eye,e.center),this.directionalLight.position.set(e.x,e.y,e.z).normalize()}}var mt=i(4426),pt=i(3655),gt=i(1228),vt=i(4248),ft=i(5502),bt=i(694);function wt(e,t=.01){return(new p.Pa4).addVectors(e.max,e.min).multiplyScalar(t)}function xt(e,t){e.traverse((function(e){var i,s,n;e.isMesh&&e.userData.originPosition&&(n=e.userData.worldDir.clone().multiplyScalar(e.userData.worldDistance.length()*t),i=(new p.Pa4).subVectors(e.userData.meshCenter,e.userData.originPosition),s=e.userData.explodeCenter,s=(new p.Pa4).copy(s).add(n).sub(i),n=e.parent&&e.parent.worldToLocal(s.clone())?e.parent.worldToLocal(s.clone()):void 0)&&e.position.copy(n)}))}class Ct{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){var i;return void 0!==this._listeners&&void 0!==(i=this._listeners)[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){var i;void 0!==this._listeners&&void 0!==(e=this._listeners[e])&&-1!==(i=e.indexOf(t))&&e.splice(i,1)}dispatchEvent(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;var i=t.slice(0);for(let t=0,s=i.length;t<s;t++)i[t].call(this,e)}}}}let yt;class Mt extends Ct{constructor(e,t){super(),yt=e,this.viewer=e,this.website=t,this.renderer=e.renderer,this.scene=e.scene,this.camera=e.camera,this.container=e.canvas,this.composer=null,this.effectFXAA=null,this.outlinePass=null,this.selectedObject=null,this.groups=[],this.toumingMaterials={},this.yincangMeshs={},this.phongMaterial=new p.xoR({color:5592405,specular:16777215,shininess:10,flatShading:!1,side:p.ehD,skinning:!0}),this.model=null,this.dragControls=null,this.cloneModel=null,this.dragGroup=new p.ZAu,this.MeshPostions=new Map,this.flag=!1,this.blastValue=0,this.mixer=null,this.clock=new p.SUY}getSelectedObject(){return this.selectedObject}Click(e){if(e=yt.GetMeshIntersectionUnderMouse(e),null===e)return!1;this.selectedObject=e.object,this.addSelectedObject(this.selectedObject),this.outlineObj(this.selectedObjects),this.selectedObject&&(u.state.app.touming&&(u.state.app.yincang&&u.commit("app/YIN_CANG",!1),this.viewer.outline.touming(this.model,u.state.app.touming,"modelClick")),u.state.app.yincang)&&(u.state.app.touming&&u.commit("app/TOU_MING",!1),this.viewer.outline.yincang2(this.model,u.state.app.yincang))}Click2(e){if(e=yt.GetMeshIntersectionUnderMouse(e),null===e)return!1;this.selectedObject=e.object,this.selectedObject.currentHex=this.selectedObject.material.emissive.getHex(),this.selectedObject.material.emissive.setHex(16711680)}addSelectedObject(e){this.selectedObjects=[],this.selectedObjects.push(e)}outlineObj(e){this.composer=new mt.x(this.renderer);var t=new pt.C(this.scene,this.camera);this.composer.addPass(t),this.outlinePass=new vt.f(new p.FM8(this.container.offsetWidth,this.container.offsetHeight),this.scene,this.camera),this.composer.addPass(this.outlinePass),this.outlinePass.pulsePeriod=2,this.outlinePass.visibleEdgeColor.set("green"),this.outlinePass.hiddenEdgeColor.set("green"),this.outlinePass.usePatternTexture=!1,this.outlinePass.edgeStrength=5,this.outlinePass.edgeGlow=1,this.outlinePass.edgeThickness=1,this.effectFXAA=new gt.T(ft.C),this.effectFXAA.uniforms.resolution.value.set(1/this.container.offsetWidth,1/this.container.offsetHeight),this.composer.addPass(this.effectFXAA),this.outlinePass.selectedObjects=e}duxian(e,t){this.model=e,this.selectedObject?t?(u.commit("app/DU_XIAN",!0),this.model.traverse((e=>{e instanceof p.Kj0&&e.name!==this.selectedObject.name&&(e.visible=!1)}))):(u.commit("app/DU_XIAN",!1),this.model.traverse((e=>{e instanceof p.Kj0&&(e.visible=!0)}))):m.Message.error("请先选择模型")}yincang(e){this.selectedObject?(this.model=e,this.model.traverse((e=>{e instanceof p.Kj0&&e.name===this.selectedObject.name&&(this.yincangMeshs[e.name]=this.selectedObject,e.visible=!1)}))):m.Message.error("请先选择模型")}yincang2(e,t){this.selectedObject?(this.model=e,t?(u.commit("app/YIN_CANG",!0),this.model.traverse((e=>{e instanceof p.Kj0&&e.name===this.selectedObject.name&&(this.yincangMeshs[e.name]=this.selectedObject,e.visible=!1)}))):u.commit("app/YIN_CANG",!1)):m.Message.error("请先选择模型")}touming(e,t,i){if(this.model=e,this.selectedObject)if(t)u.commit("app/TOU_MING",!0),this.model.traverse((e=>{e instanceof p.Kj0&&(this.groups.push(e),e.name==this.selectedObject.name)&&(this.toumingMaterials.hasOwnProperty(this.selectedObject.name)?this.selectedObject.material.transparent?this.selectedObject.material=this.toumingMaterials[e.name]:(this.selectedObject.material=this.phongMaterial,this.selectedObject.material.transparent=!0,this.selectedObject.material.opacity=.5):(this.toumingMaterials[e.name]=e.material,this.selectedObject.material=this.phongMaterial,this.selectedObject.material.transparent=!0,this.selectedObject.material.opacity=.5))}));else if(t||"modelClick"!=i)u.commit("app/TOU_MING",!1);else{u.commit("app/TOU_MING",!1);for(const e in this.toumingMaterials)this.model.traverse((t=>{t instanceof p.Kj0&&t.name===e&&(t.material=this.toumingMaterials[e])}))}else m.Message.error("请先选择模型")}dragMesh(e,t){this.flag=t,this.model=e,this.flag?(u.commit("app/YI_DONG",!0),this.dragControls=new bt.S([this.model],this.viewer.camera,this.viewer.renderer.domElement),this.dragControls.addEventListener("dragstart",(e=>{yt.controls.enabled=!1,this.MeshPostions.set(e.object.name,e.object.position)})),this.dragControls.addEventListener("dragend",(e=>{yt.controls.enabled=!0}))):(u.commit("app/YI_DONG",!1),yt.controls.enabled=!0,this.dragControls.deactivate())}rotation(e){yt.controls.autoRotate=!!e}SetEnvironment(e="ice_river",t=!1,i){t?(t="static/envmaps/"+e+"/",e=(new p.cBK).load([t+"posx.jpg",t+"negx.jpg",t+"posy.jpg",t+"negy.jpg",t+"posz.jpg",t+"negz.jpg"],(function(){i&&i()})),this.scene.background=e):this.scene.background=new p.Ilk("#212121")}setWireFrame(e,t){this.model=t,this.cloneModel=t.clone(),this.model.traverse((t=>{if(t instanceof p.Kj0)if(e){if(1<t.material.length)for(var i=0;i<t.material.length;i++)t.material[i].wireframe=!0;else t.material.wireframe=!0;u.commit("app/WANGE_GE",!0)}else{if(1<t.material.length)for(i=0;i<t.material.length;i++)t.material[i].wireframe=!1;else t.material.wireframe=!1;u.commit("app/WANGE_GE",!1)}}))}SetbackgroundColor(e){yt.scene.background=0===e?new p.Ilk("#212121"):1===e?new p.Ilk("#474747"):new p.Ilk("#afafaf")}SetBackgroundColor(e){var t=new p.Ilk(S(e.r),S(e.g),S(e.b));e=S(e.a);this.viewer.renderer.setClearColor(t,e)}reset(){if(this.selectedObject={},this.selectedObjects=[],this.outlineObj(this.selectedObjects),this.viewer.RenderCamera(),this.website.Measure(!1),this.model){u.commit("app/DU_XIAN",!1),u.commit("app/TOU_MING",!1),u.commit("app/YIN_CANG",!1);for(const e in this.yincangMeshs)this.model.traverse((t=>{t instanceof p.Kj0&&t.name===e&&(t.visible=!0)}));this.model.traverse((e=>{e instanceof p.Kj0&&(e.visible=!0)})),this.flag&&this.dragMesh(this.model,!1);for(const e in this.toumingMaterials)this.model.traverse((t=>{t instanceof p.Kj0&&t.name===e&&(t.material=this.toumingMaterials[e])}));if(this.blastValue=0,u.dispatch("app/resetBlastVal"),xt(this.model,this.blastValue),this.MeshPostions){for(let e of this.MeshPostions.keys())this.model.traverse((t=>{t.name===e&&t.position.set(0,0,0)}));this.flag&&this.dragControls.activate()}}}tweenCamera(e,t){(new p.Pa4).copy(e.center),new p.Pa4(20,20,20)}Blast(e,t){this.model=e,this.blastValue=t,xt(this.model,this.blastValue),u.dispatch("app/changBlastVal",this.blastValue)}Edge(e,t){this.model=e,u.commit("app/CHANGE_EDGE_VAL",t),this.website.UpdateEdgeDisplay(!0,t)}playAnimate(e){e.animations&&e.animations.length&&(this.mixer=new p.Xcj(e),this.mixer.clipAction(e.animations[0]).play())}}var Tt=i(6535);new p.YBo({side:p.ehD}),new p.xoR({side:p.ehD,wireframe:!0,shininess:100,specular:0,emissive:0,flatShading:!1,depthWrite:!0,depthTest:!0});let At,St,It={},Lt={};function Et(e){return It[e.uuid]=e.animations,0<e.animations.length}function _t(e){var t=null!==e?e.uuid:"";t=It[t];if(void 0!==t){var i;for(i of(At=new p.Xcj(e),t)){i.name,i.name;var s=At.clipAction(i);Lt[i.name]=s}return Lt}}class kt{constructor(e,t,i,s){(St=this).website=s,this.signals=s.signals,this.settings={animationSteps:40},this.canvas=null,this.mainDiv=e,this.renderer=null,this.scene=null,this.camera=null,this.fov=45,this.near=.1,this.far=1e4,this.navigation=null,this.keyEvents=null,this.shading=null,this.outline=null,this.view2=t,this.clock=new p.SUY}Init(e){this.canvas=e,this.canvas.id="viewer";e={canvas:this.canvas,antialias:!0},this.renderer=new p.CP7(e),window.devicePixelRatio&&this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=p.ntZ,this.renderer.setClearColor("#ffffff",1),this.renderer.setSize(this.canvas.width,this.canvas.height),this.scene=new p.xsS,this.camera=new p.cPb(45,this.canvas.width/this.canvas.height,this.near,this.far),this.camera.position.set(500,500,500),this.controls=new et.z(this.camera,this.mainDiv),this.controls.enableDamping=!0,this.controls.target.set(0,0,0),this.controls.addEventListener("change",(()=>{})),this.controls.update(),this.geometry=new rt(this.scene),this.extraGeometry=new at(this.scene),e=this.renderer.domElement;var t=(t=P.Y)===P.X?new tt(new N(2,-3,1.5),new N(0,0,0),new N(1,0,0),45):t===P.Y?new tt(new N(-1.5,2,3),new N(0,0,0),new N(0,1,0),45):t===P.Z?new tt(new N(-1.5,-3,2),new N(0,0,0),new N(0,0,1),45):null;this.navigation=new ht(e,this.mainDiv,t,{onUpdate:()=>{this.RenderCamera()}}),this.InitShading(),this.outline=new Mt(this,this.website),this.animate()}initGui(e,t){function i(){e.updateProjectionMatrix()}var s=new Tt.XS,n=(s.width=320,s.close(),s.addFolder("camera")),r=(n.add(this.camera,"fov",1,180).onChange(i),new class{constructor(e,t,i,s){this.obj=e,this.minProp=t,this.maxProp=i,this.minDif=s}get min(){return this.obj[this.minProp]}set min(e){this.obj[this.minProp]=e,this.obj[this.maxProp]=Math.max(this.obj[this.maxProp],e+this.minDif)}get max(){return this.obj[this.maxProp]}set max(e){this.obj[this.maxProp]=e,this.min=this.min}}(this.camera,"near","far",.1));function a(){e.updateProjectionMatrix(),St.RenderCamera()}n.add(r,"min",.1,50,.1).name("near").onChange(i),n.add(r,"max",.1,3e4,.1).name("far").onChange(i),this.makeXYZGUI(s,e.position,"position",i),n=s.addFolder("center"),n.add(t.center,"x",.1,50,.1).onChange((e=>{t.center.x=e,a()})),n.add(t.center,"y",.1,50,.1).onChange((e=>{t.center.y=e,a()})),n.add(t.center,"z",.1,50,.1).onChange((e=>{t.center.z=e,a()}))}makeXYZGUI(e,t,i,s){e=e.addFolder(i),e.add(t,"x",t.x-10,t.x+10).onChange(s),e.add(t,"y",t.y-10,t.y+10).onChange(s),e.add(t,"z",t.z-10,t.z+10).onChange(s),e.open()}InitShading(){this.shading=new ut(this.scene,this.camera)}SetEnvironmentMapSettings(e,t){this.shading.SetEnvironment(e,t,(()=>{})),this.shading.UpdateShading()}GetCamera(){return this.navigation.GetCamera()}SetCamera(e){this.navigation.SetCamera(e)}Resize(e,t){var i;i=this.canvas,i=getComputedStyle(i),Xe(i),$e(i),this.ResizeRenderer(this.mainDiv.offsetWidth,this.mainDiv.offsetHeight)}ResizeRenderer(e,t){window.devicePixelRatio&&this.renderer.setPixelRatio(window.devicePixelRatio),this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}SetMainObject(e){this.geometry.SetMainObject(e)}AddExtraObject(e){this.extraGeometry.AddObject(e)}Clear(){this.geometry.Clear(),this.extraGeometry.Clear()}ClearExtra(){this.extraGeometry.Clear()}animate(){requestAnimationFrame(this.animate.bind(this)),this.controls&&this.controls.update(),this.render()}setScissorForElement(e){var t=this.mainDiv.getBoundingClientRect(),i=(e=e.getBoundingClientRect(),Math.min(e.right,t.right)-t.left),s=Math.max(0,e.left-t.left),n=Math.min(e.bottom,t.bottom)-t.top;e=Math.max(0,e.top-t.top),i=Math.min(t.width,i-s),e=Math.min(t.height,n-e),t=t.height-n;return this.renderer.setScissor(s,t,i,e),this.renderer.setViewport(s,t,i,e),i/e}resizeRendererToDisplaySize(e){e=e.domElement;var t=e.clientWidth,i=e.clientHeight;e=e.width!==t||e.height!==i;return e&&this.renderer.setSize(t,i,!1),e}RenderCamera(){var e=this.navigation.GetCamera();this.camera.position.set(e.eye.x,e.eye.y,e.eye.z),this.camera.up.set(e.up.x,e.up.y,e.up.z),this.camera.lookAt(new p.Pa4(e.center.x,e.center.y,e.center.z)),this.controls.target.set(e.center.x,e.center.y,e.center.z),this.controls.update(),this.shading.UpdateByCamera(e)}render(){var e;this.renderer&&(this.renderer.clear(),this.renderer.render(this.scene,this.camera),null!=this.outline.composer&&this.outline.composer.render(),e=this.clock.getDelta(),At)&&At.update(e)}SetMouseClickHandler(e){this.navigation.SetMouseClickHandler(e)}SetMouseMoveHandler(e){this.navigation.SetMouseMoveHandler(e)}GetCanvasSize(){let e=this.canvas.width,t=this.canvas.height;return window.devicePixelRatio&&(e/=window.devicePixelRatio,t/=window.devicePixelRatio),{width:e,height:t}}GetMeshIntersectionUnderMouse(e){var t=this.GetCanvasSize();e=this.geometry.GetMeshIntersectionUnderMouse(e,this.camera,t.width,t.height);return null===e?null:e}GetBoundingSphere(e){return this.geometry.GetBoundingSphere(e)}AdjustClippingPlanesToSphere(e){null!==e&&(e.radius<10?(this.camera.near=.01,this.camera.far=100):e.radius<100?(this.camera.near=.1,this.camera.far=1e3):e.radius<1e3?(this.camera.near=10,this.camera.far=1e4):(this.camera.near=100,this.camera.far=1e6),this.camera.updateProjectionMatrix(),this.RenderCamera())}FitSphereToWindow(e,t){var i;null!==e&&(i=new N(e.center.x,e.center.y,e.center.z),e=e.radius,i=this.navigation.GetFitToSphereCamera(i,e),this.navigation.MoveCamera(i,t?this.settings.animationSteps:0))}SetBackgroundColor(e){var t=new p.Ilk(S(e.r),S(e.g),S(e.b));e=S(e.a);this.renderer.setClearColor(t,e)}}let Ft={StringToNumber(e){return parseFloat(e)},StringToInteger(e){return parseInt(e,10)},StringToModelUrls(e){return null===e||0===e.length?null:e.split(",")},StringToRGBAColor:function(e){var t;return null===e||0===e.length||3!==(e=e.split(",")).length&&4!==e.length?null:(t=new T(this.StringToInteger(e[0]),this.StringToInteger(e[1]),this.StringToInteger(e[2]),255),4===e.length&&(t.a=this.StringToInteger(e[3])),t)},StringToRGBColor:function(e){return null===e||0===e.length||3!==(e=e.split(",")).length?null:new RGBColor(this.StringToInteger(e[0]),this.StringToInteger(e[1]),this.StringToInteger(e[2]))},StringToCamera:function(e){return null===e||0===e.length||9!==(e=e.split(",")).length?null:new tt(new N(this.StringToNumber(e[0]),this.StringToNumber(e[1]),this.StringToNumber(e[2])),new N(this.StringToNumber(e[3]),this.StringToNumber(e[4]),this.StringToNumber(e[5])),new N(this.StringToNumber(e[6]),this.StringToNumber(e[7]),this.StringToNumber(e[8])))}};class Gt{constructor(e,t){this.separator=t,this.paramList=e}GetCamera(){var e=this.GetKeywordParams("camera");return Ft.StringToCamera(e)}GetBackgroundColor(){var e=this.GetKeywordParams("backgroundcolor");return Ft.StringToRGBAColor(e)}GetModelUrls(){var e;return-1===this.paramList.indexOf("=")?this.paramList.split(","):(e=this.GetKeywordParams("model"),Ft.StringToModelUrls(e))}GetKeywordParams(e){if(null!==this.paramList&&0!==this.paramList.length){var t=e+"=",i=this.paramList.split(this.separator);for(let e=0;e<i.length;e++){var s=i[e];if(s.startsWith(t))return s.substring(t.length)}}return null}GetDefaultColor(){var e=this.GetKeywordParams("defaultcolor");return Ft.StringToRGBColor(e)}}function Ot(e){return new Gt(e,"$")}class Pt{constructor(e){this.separator=e,this.paramList=""}AddUrlPart(e,t){}AddBackgroundColor(e){this.AddUrlPart("backgroundcolor","green")}}class Rt{constructor(){this.eventListener=null,this.skipNextEvent=!1}SetEventListener(e){this.eventListener=e,window.onhashchange=this.OnChange.bind(this)}SkipNextEventHandler(){this.skipNextEvent=!0}OnChange(){this.skipNextEvent?this.skipNextEvent=!1:this.eventListener()}HasHash(){var e=this.GetHash();return 0<e.length}ClearHash(){this.SetHash("")}SetHash(e){window.location.hash=e}GetHash(){return window.location.hash.substring(1)}GetModelFilesFromHash(){var e=Ot(this.GetHash());return e.GetModelUrls()}GetBackgroundFromHash(){return Ot(this.GetHash()).GetBackgroundColor()}GetCameraFromHash(){return Ot(this.GetHash()).GetCamera()}GetDefaultColorFromHash(){return Ot(this.GetHash()).GetDefaultColor()}}let Dt=null;function Nt(e,t,i){void 0!==Dt&&null!==Dt&&Dt(e,t,i)}function jt(e,t,i){return e=document.createElement(e),t&&(e.className=t),i&&(e.innerHTML=i),e}function Vt(e,t,i){return s=jt(s="div",t,i),e.appendChild(s),s;var s}class Ut{constructor(){this.forceMediumpForMaterials=!1}}class Bt{constructor(){this.defaultMaterial=null,this.objectUrls=[]}}class zt{constructor(e){this.callbacks=e,this.texturesNeeded=0,this.texturesLoaded=0,this.threeObject=null}OnTextureNeeded(){this.texturesNeeded+=1}OnTextureLoaded(){this.texturesLoaded+=1,this.callbacks.onTextureLoaded(),this.Finish()}OnModelLoaded(e){this.threeObject=e,this.Finish()}Finish(){null!==this.threeObject&&this.texturesNeeded===this.texturesLoaded&&this.callbacks.onModelLoaded(this.threeObject)}}class Ht{constructor(e,t){this.meshInstances=[],this.AddNode(e,t)}AddNode(e,t){var i,s,n=e.GetTransformation().GetMatrix();n=(new p.yGw).fromArray(n.Get());for(i of(t.applyMatrix4(n),e.GetChildNodes())){var r=new p.Tme;t.add(r),this.AddNode(i,r)}for(s of e.GetMeshIndices())this.meshInstances.push({node:e,threeNode:t,meshIndex:s})}GetMeshInstances(){return this.meshInstances}}function Wt(e,t,i,s){function n(e,t,i,s,n,r){function a(e,t,i,s,n){if(null!==i&&i.IsValid()){var r,a,o=new p.dpR;e.OnTextureNeeded();let l=null;l=null!==i.mimeType?(r=i.buffer,a=i.mimeType,r=new Blob([r],{type:a}),URL.createObjectURL(r)):(a=i.buffer,a=new Blob([a]),URL.createObjectURL(a)),s.objectUrls.push(l),o.load(l,(s=>{var r,a;r=i,(a=s).wrapS=p.rpg,a.wrapT=p.rpg,a.rotation=r.rotation,a.offset.x=r.offset.x,a.offset.y=r.offset.y,a.repeat.x=r.scale.x,a.repeat.y=r.scale.y,t.needsUpdate=!0,n(s),e.OnTextureLoaded()}),null,(t=>{e.OnTextureLoaded()}))}}let o=t.GetMaterial(i);t=je(o.color),o.vertexColors&&t.setRGB(1,1,1),i={color:t,vertexColors:o.vertexColors,opacity:o.opacity,transparent:o.transparent,alphaTest:o.alphaTest,side:p.ehD};n.forceMediumpForMaterials&&(i.precision="mediump");let l=null;return s===Ne.Phong?(l=new p.xoR(i),o.type===ie.Phong&&(t=je(o.specular),O(o.shininess,0)&&t.setRGB(0,0,0),l.specular=t,l.shininess=100*o.shininess,a(e,l,o.specularMap,r,(e=>{l.specularMap=e})))):s===Ne.Physical&&(l=new p.Wid(i),o.type===ie.Physical)&&(l.metalness=o.metalness,l.roughness=o.roughness,a(e,l,o.metalnessMap,r,(e=>{l.metalness=1,l.roughness=1,l.metalnessMap=e,l.roughnessMap=e}))),n=je(o.emissive),l.emissive=n,a(e,l,o.diffuseMap,r,(e=>{o.multiplyDiffuseMap||l.color.setRGB(1,1,1),l.map=e})),a(e,l,o.bumpMap,r,(e=>{l.bumpMap=e})),a(e,l,o.normalMap,r,(e=>{l.normalMap=e})),a(e,l,o.emissiveMap,r,(e=>{l.emissiveMap=e})),o.isDefault&&(r.defaultMaterial=l),l}function r(e,t,i,s){ve(t.GetMesh(i.meshIndex))===ge.TriangleMesh&&(t=function(e,t,i){let s=e.GetMesh(t.meshIndex);var n=s.TriangleCount(),r=[];for(let p=0;p<n;p++)r.push(p);r.sort(((e,t)=>(e=s.GetTriangle(e),t=s.GetTriangle(t),e.mat-t.mat)));var a=new p.u9r,o=[],l=[],h=new Map,c=[],d=[],u=[],m=[],g=[],v=(g.push({start:0,end:-1}),0<s.VertexColorCount()),f=0<s.TextureUVCount();for(let p=0;p<r.length;p++){var b=r[p],w=(b=s.GetTriangle(b),s.GetVertex(b.v0)),x=s.GetVertex(b.v1),C=s.GetVertex(b.v2);w=(c.push(w.x,w.y,w.z,x.x,x.y,x.z,C.x,C.y,C.z),b.HasVertexColors()?(w=je(s.GetVertexColor(b.c0)),x=je(s.GetVertexColor(b.c1)),C=je(s.GetVertexColor(b.c2)),d.push(w.r,w.g,w.b,x.r,x.g,x.b,C.r,C.g,C.b)):v&&d.push(0,0,0,0,0,0,0,0,0),s.GetNormal(b.n0)),x=s.GetNormal(b.n1),C=s.GetNormal(b.n2),w=(u.push(w.x,w.y,w.z,x.x,x.y,x.z,C.x,C.y,C.z),b.HasTextureUVs()?(w=s.GetTextureUV(b.u0),x=s.GetTextureUV(b.u1),C=s.GetTextureUV(b.u2),m.push(w.x,w.y,x.x,x.y,C.x,C.y)):f&&m.push(0,0,0,0,0,0),b.mat);h.has(w)||(h.set(w,o.length),o.push(i[w]),l.push(w),0<p&&(g[g.length-1].end=p-1,g.push({start:g[g.length-1].end+1,end:-1})))}g[g.length-1].end=n-1,a.setAttribute("position",new p.a$l(c,3)),0!==d.length&&a.setAttribute("color",new p.a$l(d,3)),a.setAttribute("normal",new p.a$l(u,3)),0!==m.length&&a.setAttribute("uv",new p.a$l(m,2));for(let p=0;p<g.length;p++){var y=g[p];a.addGroup(3*y.start,3*(y.end-y.start+1),p)}return(e=new p.Kj0(a,o)).name=s.GetName(),e.userData={originalMeshId:t,originalMaterials:l,threeMaterials:null},e}(t,i,s),e.add(t))}var a=new zt(s),o=function(e){let t=0,i=0;for(let n=0;n<e.MaterialCount();n++){var s=e.GetMaterial(n);s.type===ie.Phong?t+=1:s.type===ie.Physical&&(i+=1)}return t>=i?Ne.Phong:Ne.Physical}(e),l=[];for(let p=0;p<e.MaterialCount();p++){var h=n(a,e,p,o,t,i);l.push(h)}s=new p.Tme;{var c,d,u=s,m=e,v=l,f=a;s=m.GetRootNode();let t=(s=new Ht(s,u)).GetMeshInstances();s=t.length,c=100,d={runTask:(e,i,s)=>{for(let l=e;l<=i;l++){var n=t[l],a=n.node,o=n.threeNode;a=new be(a.GetId(),n.meshIndex);r(o,m,a,v)}s()},onReady:()=>{f.OnModelLoaded(u)}},(new g).RunBatch(s,c,d)}}class Yt{constructor(){this.importer=new Ye,this.inProgress=!1,this.defaultMaterial=null,this.objectUrls=null,this.hasHighpDriverIssue=function(){var e=document.createElement("canvas"),t=(document.body.appendChild(e),{canvas:e,antialias:!0}),i=((t=new p.CP7(t)).setClearColor("#ffffff",1),t.setSize(10,10),new p.xsS),s=new p.Mig(8947848);i.add(s),(s=new p.Ox3(8947848)).position.set(0,0,1),i.add(s),(s=new p.cPb(45,1,.1,1e3)).position.set(0,0,1),s.up.set(0,1,0),s.lookAt(new p.Pa4(0,0,0)),i.add(s);var n=new p._12(1,1);n=new p.Kj0(n,new p.xoR({color:13369344})),i.add(n),t.render(i,s),n=t.getContext(),i=new Uint8Array(4);return n.readPixels(5,5,1,1,n.RGBA,n.UNSIGNED_BYTE,i),document.body.removeChild(e),i[0]<50&&i[1]<50&&i[2]<50}()}InProgress(){return this.inProgress}LoadModel(e,t,i){this.inProgress||(this.inProgress=!0,this.RevokeObjectUrls(),this.importer.ImportFiles(e,t,{onLoadStart:()=>{i.onLoadStart()},onFileListProgress:(e,t)=>{i.onFileListProgress(e,t)},onFileLoadProgress:(e,t)=>{i.onFileLoadProgress(e,t)},onImportStart:()=>{i.onImportStart()},onSelectMainFile:(e,t)=>{i.onSelectMainFile?i.onSelectMainFile(e,t):t(0)},onImportSuccess:e=>{i.onVisualizationStart();var t=new Ut;t.forceMediumpForMaterials=this.hasHighpDriverIssue;let s=new Bt;Wt(e.model,t,s,{onTextureLoaded:()=>{i.onTextureLoaded()},onModelLoaded:t=>{var n;this.defaultMaterial=s.defaultMaterial,this.objectUrls=s.objectUrls,e.upVector===P.X?(n=(new p._fP).setFromAxisAngle(new p.Pa4(0,0,1),Math.PI/2),t.quaternion.multiply(n)):e.upVector===P.Z&&(n=(new p._fP).setFromAxisAngle(new p.Pa4(1,0,0),-Math.PI/2),t.quaternion.multiply(n)),i.onModelFinished(e,t),this.inProgress=!1}})},onImportError:e=>{i.onLoadError(e),this.inProgress=!1}}))}GetImporter(){return this.importer}GetDefaultMaterial(){return this.defaultMaterial}ReplaceDefaultMaterialColor(e){null===this.defaultMaterial||this.defaultMaterial.vertexColors||(this.defaultMaterial.color=je(e))}RevokeObjectUrls(){if(null!==this.objectUrls){for(var e of this.objectUrls)URL.revokeObjectURL(e);this.objectUrls=null}}}let Kt=null;function qt(e){null!==Kt&&(Kt.Close(),Kt=null),Kt=e}class $t{constructor(){this.modalDiv=jt("div","ov_modal",void 0),this.modalDiv.addEventListener("mousemove",(e=>{e.stopPropagation()})),this.overlayDiv=null,this.resizeHandler=null,this.positionCalculator=null,this.closeHandler=null,this.isOpen=!1,this.closeable=!0}GetContentDiv(){return this.modalDiv}SetCloseable(e){this.closeable=e}SetPositionCalculator(e){this.positionCalculator=e}SetCloseHandler(e){this.closeHandler=e}Open(){this.isOpen||(qt(this),this.overlayDiv=Vt(document.body,"ov_modal_overlay"),document.body.appendChild(this.modalDiv),this.resizeHandler=this.Resize.bind(this),window.addEventListener("resize",this.resizeHandler),this.closeable&&(this.overlayDiv.addEventListener("click",(e=>{e.preventDefault(),this.Close()})),this.overlayDiv.addEventListener("mousemove",(e=>{e.stopPropagation()})),this.overlayDiv.addEventListener("contextmenu",(e=>{e.preventDefault(),this.Close()}))),this.isOpen=!0,this.Resize())}Close(){this.isOpen&&(Kt=null,window.removeEventListener("resize",this.resizeHandler),null!==this.closeHandler&&this.closeHandler(),this.modalDiv.remove(),this.overlayDiv.remove(),this.overlayDiv=null,this.resizeHandler=null,this.isOpen=!1)}Resize(){var e=window.innerWidth,t=window.innerHeight;let i=(e-this.modalDiv.offsetWidth)/2,s=(t-this.modalDiv.offsetHeight)/3;null!==this.positionCalculator&&(e=this.positionCalculator(),i=e.x,s=e.y),this.modalDiv.style.left=i+"px",this.modalDiv.style.top=s+"px"}}class Xt extends $t{constructor(){super(),this.SetCloseable(!1),this.textDiv=null}Init(e){var t=this.GetContentDiv();t.classList.add("ov_progress"),Vt(t,"ov_progress_img",'<svg><use href="assets/images/3dviewer_net_logo.svg#logo"></use></svg>'),this.textDiv=Vt(t,"ov_progress_text"),this.SetText(e)}SetText(e){this.textDiv.innerHTML=e}}class Zt extends $t{constructor(){super()}Init(e,t){var i=this.GetContentDiv(),s=(e=(i.classList.add("ov_dialog"),Vt(i,"ov_dialog_title",e),Vt(i,"ov_dialog_content")),i=Vt(i,"ov_dialog_buttons"),Vt(i,"ov_dialog_buttons_inner"));for(let n=0;n<t.length;n++)!function(e,t){t=Vt(t,"ov_button ov_dialog_button",e.name),e.subClass&&t.classList.add(e.subClass),t.addEventListener("click",(()=>{e.onClick()}))}(t[n],s);return e}}function Jt(e,t,i){let s=new Zt;return e=s.Init(e,[{name:"OK",onClick(){s.Close()}}]),Vt(e,"ov_dialog_message",t),null!==i&&Vt(e,"ov_dialog_submessage",i),s.Open(),s}function Qt(e,t){var i=Ze("div","ov_svg_icon",void 0);return t&&i.classList.add(t),Je(i,"i","icon icon-"+e),i}class ei{constructor(){this.modelLoader=new Yt,this.modalDialog=null}LoadModel(e,t,i){if(!this.modelLoader.InProgress()){let s=null;this.modelLoader.LoadModel(e,t,{onLoadStart:()=>{this.CloseDialogIfOpen(),i.onStart(),(s=new Xt).Init("Loading Model"),s.Open()},onFileListProgress:(e,t)=>{},onFileLoadProgress:(e,t)=>{},onSelectMainFile:(e,t)=>{s.Close(),this.modalDialog=this.ShowFileSelectorDialog(e,(e=>{s.Open(),t(e)}))},onImportStart:()=>{s.SetText("Importing Model")},onVisualizationStart:()=>{s.SetText("Visualizing Model")},onModelFinished:(e,t)=>{s.Close(),i.onFinish(e,t)},onTextureLoaded:()=>{i.onRender()},onLoadError:e=>{s.Close(),i.onError(e),this.modalDialog=this.ShowErrorDialog(e)}})}}GetModelLoader(){return this.modelLoader}GetImporter(){return this.modelLoader.GetImporter()}ShowErrorDialog(e){return e.code===Be.NoImportableFile?Jt("Something went wrong","No importable file found.",null):e.code===Be.FailedToLoadFile?Jt("Something went wrong","Failed to load file for import.","The remote server refused to fulfill the request. Check if the url is correct, and make sure that CORS requests are allowed on the remote server."):e.code===Be.ImportFailed?Jt("Something went wrong","Failed to import model.",e.message):Jt("Something went wrong","Unknown error.",null)}ShowFileSelectorDialog(e,t){let i=new Zt;var s,n,r=i.Init("Select Model",[{name:"Cancel",subClass:"outline",onClick(){i.Close()}}]),a=(r=(i.SetCloseHandler((()=>{t(null)})),Vt(r,"ov_dialog_message","Multiple importable models found. Select the model you would like to import from the list below."),Vt(r,"ov_dialog_section")),Vt(r,"ov_dialog_import_file_list ov_thin_scrollbar"));for(let h=0;h<e.length;h++){var o=e[h],l=Vt(a,"ov_dialog_file_link");s=l,n=Qt(n="meshes","ov_file_link_img"),s.appendChild(n),Vt(l,"ov_dialog_file_link_text",o),l.addEventListener("click",(()=>{i.SetCloseHandler(null),i.Close(),t(h)}))}return i.Open(),i}CloseDialogIfOpen(){null!==this.modalDialog&&(this.modalDialog.Close(),this.modalDialog=null)}}class ti{constructor(e,t,i){this.name=e,this.source=t,this.data=i}}class ii{constructor(e,t,i){this.name=w(e),this.extension=x(e),this.source=t,this.data=i,this.content=null,this.size=i.size}SetContent(e){this.content=e}setSize(e){this.size=e}}class si{constructor(){this.files=[]}GetFiles(){return this.files}IsOnlyUrlSource(){if(0===this.files.length)return!1;for(let t=0;t<this.files.length;t++){var e=this.files[t];if(e.source!==b.Url&&e.source!==b.Decompressed)return!1}return!0}FillFromInputFiles(e){for(var t of(this.files=[],e))t=new ii(t.name,t.source,t.data),this.files.push(t)}GetContent(e){f(this.files.length,{runTask:(t,i)=>{e.onFileListProgress(t,this.files.length),this.GetFileContent(this.files[t],{onReady:i,onProgress:(i,s)=>{this.files[t].setSize(s),e.onFileLoadProgress(i,s)}})},onReady:e.onReady})}GetFileContent(e,t){let i=null;e.source===b.Url?i=C(e.data,t.onProgress):e.source===b.File&&(i=y(e.data,t.onProgress)),i.then((t=>{e.SetContent(t)})).catch((e=>{})).finally((()=>{t.onReady()}))}}function ni(e){var t,i=[];for(t of e){var s=w(t.name);i.push(new ti(s,b.File,t,t.size))}return i}const ri={createFilesMap:function(e){var t=new Map;for(let s=0;s<e.length;s++){var i=e[s];t.set(i.name,e[s])}return t},getFilesFromItemList:function(e,t){let i=0,s=0;const n=[],r={};function a(){++i===s&&t(n,r)}for(let l=0;l<e.length;l++){var o=e[l];"file"===o.kind&&function e(t){t.isDirectory?t.createReader().readEntries((function(t){for(let i=0;i<t.length;i++)e(t[i]);a()})):t.isFile&&t.file((function(e){n.push(e),r[t.name]=e,a()})),s++}(o.webkitGetAsEntry())}}};var ai=i(6925);function oi(e,t){t.onModelFinished(e)}function li(e,t){switch(void 0===e.metadata&&(e.metadata={type:"Geometry"}),void 0===e.metadata.type&&(e.metadata.type="Geometry"),void 0!==e.metadata.formatVersion&&(e.metadata.version=e.metadata.formatVersion),e.metadata.type.toLowerCase()){case"buffergeometry":var i=(new p.s4_).parse(e);oi(new p.Kj0(i),t);break;case"geometry":break;case"object":i=new p.Gql,i.setResourcePath(hi.texturePath),i.parse(e,(e=>{e.isScene&&alert("scene"),oi(e,t)}))}}let hi;Number.prototype.format=function(){return this.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")};class ci{constructor(){(hi=this).callbacks=null,this.objectURLs=[],this.fileList=new si,this.texturePath=""}getFileList(){return this.fileList}loadItemUrls(e,t){this.callbacks=t;var i=function(e){var t,i=[];for(t of e){var s=w(t);i.push(new ti(s,b.Url,t))}return i}(e),s=new si;s.FillFromInputFiles(i),this.fileList=s,t.onLoadStart(),this.fileList.GetContent({onReady:()=>{t.onImportStart(),this.loadFiles(this.fileList,e,n)},onFileListProgress:t.onFileListProgress,onFileLoadProgress:t.onFileLoadProgress});const n=new Map;for(let a=0;a<e.length;a++){var r=e[a];n.set(w(r),r)}}loadItemList(e,t){this.callbacks=t,ri.getFilesFromItemList(e,((e,i)=>{for(let t=0;t<e.length;t++)e[t].name;var s=ni(e),n=new si;n.FillFromInputFiles(s),this.fileList=n;let r=ri.createFilesMap(e);t.onLoadStart(),this.fileList.GetContent({onReady:()=>{t.onImportStart(),this.loadFiles(this.fileList,e,r)},onFileListProgress:t.onFileListProgress,onFileLoadProgress:t.onFileLoadProgress})}))}loadItemInput(e,t){this.callbacks=t;let i=e;for(let r=0;r<i.length;r++)i[r].name;e=ni(i);var s=new si;s.FillFromInputFiles(e),this.fileList=s;let n=ri.createFilesMap(i);t.onLoadStart(),this.fileList.GetContent({onReady:()=>{t.onImportStart(),this.loadFiles(this.fileList,i,n)},onFileListProgress:t.onFileListProgress,onFileLoadProgress:t.onFileLoadProgress})}loadFiles(e,t,i){if(0<t.length){i=i||ri.createFilesMap(t);var s=new p.lLk,n=(s.onStart=function(e,t,i){},s.onLoad=function(){},s.onProgress=function(e,t,i){},s.onError=function(e){},s.setURLModifier((t=>{var i;return t?("blob:"!=t.substring(0,5)&&"data:"!=t.substring(0,5)&&(t=w(t)),e.files.find((e=>e.name===t)),(i=e.files.find((e=>e.name===t)))&&i.content?(i=i.content,i=new Blob([i]),this.objectURLs.push(URL.createObjectURL(i)),URL.createObjectURL(i)):t):""})),e.files);for(let e=0;e<n.length;e++)this.loadFile(n[e],i,s)}}async loadFile(e,t,s){var n,r,a,o,l,h,c,d,u,m=e.extension;e.source,(new FileReader).addEventListener("progress",(e=>{Math.floor(e.total/1e3).format(),Math.floor(e.loaded/e.total*100)}));try{switch(m){case"asc":this.callbacks.onLoadError(3213);case"obj":{let m=e.name.split(".")[0];t.has(m+".obj")&&t.has(m+".mtl")?(n=(await i.e(651).then(i.bind(i,2651)))["MTLLoader"],r=(await i.e(949).then(i.bind(i,3949)))["OBJLoader"],a=this.fileList.files.find((e=>e.name===m+".mtl")).content,o=new n(s).parse(q(a)),l=new r,h=this.fileList.files.find((e=>e.name===m+".obj")).content,oi(l.setMaterials(o).parse(q(h)),this.callbacks)):t.has(m+".obj")&&(c=(await i.e(949).then(i.bind(i,3949)))["OBJLoader"],d=new c,u=this.fileList.files.find((e=>e.name===m+".obj")).content,oi(d.parse(q(u)),this.callbacks));break}case"fbx":var g=e.content,v=(await i.e(375).then(i.bind(i,375)))["FBXLoader"],f=new v(s).parse(g);oi(f,this.callbacks);break;case"3dm":e.content;var b=(await i.e(907).then(i.bind(i,7907)))["Rhino3dmLoader"];new b(s),Q("static/libs/loaders/rhino3dm/rhino3dm.min.js").then((e=>{}));break;case"3ds":var w=(await i.e(946).then(i.bind(i,1946)))["TDSLoader"],x=new w(s).parse(e.content);0<x.children.length||alert("不完整 "),oi(x,this.callbacks);break;case"3mf":var C=(await i.e(669).then(i.bind(i,2669)))["ThreeMFLoader"];oi((new C).parse(e.content),this.callbacks);break;case"amf":var y=(await i.e(744).then(i.bind(i,6744)))["AMFLoader"];oi((new y).parse(e.content),this.callbacks);break;case"dae":var M=q(e.content),T=(await i.e(974).then(i.bind(i,2974)))["ColladaLoader"],A=new T(s).parse(M);A.scene.name=e.name,oi(A.scene,this.callbacks);break;case"drc":{var S=e.content,I=(await i.e(539).then(i.bind(i,539)))["DRACOLoader"];const t=new I;t.setDecoderPath("/libs/loaders/draco/"),t.decodeDracoFile(S,(i=>{let s;var n;null!==i.index?(n=new p.Wid,(s=new p.Kj0(i,n)).name=e.name):((n=new p.UY4({size:.01})).vertexColors=i.hasAttribute("color"),(s=new p.woe(i,n)).name=e.name),t.dispose(),oi(s,this.callbacks)}));break}case"glb":var L=e.content,E=(await i.e(539).then(i.bind(i,539)))["DRACOLoader"],_=(await i.e(225).then(i.bind(i,7225)))["GLTFLoader"],k=new E,F=(k.setDecoderPath("static/libs/loaders/draco/"),new _(s));F.setDRACOLoader(k),new Uint8Array(L),F.parse(L,"",(t=>{var i=t.scene;i.name=e.name,i.animations.push(...t.animations),oi(i,this.callbacks)}),(e=>{this.callbacks.onLoadError(e)}),s);break;case"gltf":{var G,O,P,R=e.content;let t;!function(e){let t;if("string"==typeof e)t=e;else{if("glTF"===p.Zp0.decodeText(new Uint8Array(e,0,4)))return new DataView(e).getUint32(4,!0)<2;t=p.Zp0.decodeText(new Uint8Array(e))}return null!=(e=JSON.parse(t)).asset&&e.asset.version[0]<2}(R)?(G=(await i.e(539).then(i.bind(i,539)))["DRACOLoader"],O=(await i.e(225).then(i.bind(i,7225)))["GLTFLoader"],(P=new G).setDecoderPath("/libs/loaders/gltf/"),(t=new O(s)).setDRACOLoader(P)):alert("Import of glTF asset not possible. Only versions >= 2.0 are supported. Please try to upgrade the file to glTF 2.0 using glTF-Pipeline."),t.parse(R,"",(t=>{var i=t.scene;i.name=e.name,i.animations.push(...t.animations),oi(i,this.callbacks)}));break}case"js":case"json":{var D,N,j,V=q(e.content);if(-1!==V.indexOf("postMessage"))return D=new Blob([V],{type:"text/javascript"}),N=URL.createObjectURL(D),(j=new Worker(N)).onmessage=function(e){e.data.metadata={version:2},li(e.data,hi.callbacks)},void j.postMessage(Date.now());let i;try{i=JSON.parse(V)}catch(t){return void alert(t)}li(i,hi.callbacks);break}case"ifc":var U=(await i.e(413).then(i.bind(i,6413)))["IFCLoader"],B=new U,z=(B.ifcManager.setWasmPath("/libs/loaders/ifc/"),await B.parse(e.content));z.mesh.name=e.name,oi(z,this.callbacks);break;case"kmz":var H=(await Promise.all([i.e(974),i.e(383)]).then(i.bind(i,6383)))["KMZLoader"],W=(new H).parse(e.content);W.scene.name=e.name,oi(W.scene,this.callbacks);break;case"ldr":case"mpd":var Y=q(e.content),K=(await i.e(24).then(i.bind(i,7024)))["LDrawLoader"];(new K).parse(Y,(t=>{t.name=e.name,t.rotation.x=Math.PI,oi(t,hi.callbacks)}));break;case"md2":var $=(await i.e(433).then(i.bind(i,8433)))["MD2Loader"],X=(new $).parse(e.content),Z=new p.Wid,J=new p.Kj0(X,Z);J.mixer=new p.Xcj(J),J.name=e.name,J.animations.push(...X.animations),oi(J,hi.callbacks);break;case"pcd":var ee=e.content,te=(await i.e(38).then(i.bind(i,6038)))["PCDLoader"],ie=(new te).parse(ee);ie.name=e.name,oi(ie,hi.callbacks);break;case"ply":{var se,ne,re=e.content,ae=(await i.e(349).then(i.bind(i,349)))["PLYLoader"],oe=(new ae).parse(re);let t;null!==oe.index?(se=new p.Wid({color:22015,flatShading:!0}),(t=new p.Kj0(oe,se)).name=e.name):((ne=new p.UY4({size:.01})).vertexColors=oe.hasAttribute("color"),(t=new p.woe(oe,ne)).name=e.name),oi(t,hi.callbacks);break}case"stl":var le=e.content,he=(await i.e(508).then(i.bind(i,508)))["STLLoader"],ce=(new he).parse(le),de=new p.Wid,ue=new p.Kj0(ce,de);ue.name=e.name,oi(ue,hi.callbacks);break;case"svg":var me=q(e.content),pe=(await i.e(449).then(i.bind(i,7449)))["SVGLoader"],ge=(new pe).parse(me).paths,ve=new p.ZAu;ve.scale.multiplyScalar(.1),ve.scale.y*=-1;for(let e=0;e<ge.length;e++){var fe=ge[e],be=new p.vBJ({color:fe.color,depthWrite:!1}),we=pe.createShapes(fe);for(let e=0;e<we.length;e++){var xe=we[e],Ce=new p.oa8(xe),ye=new p.Kj0(Ce,be);ve.add(ye)}}oi(ve,hi.callbacks);break;case"usdz":var Me=e.content,Te=(await i.e(812).then(i.bind(i,2812)))["USDZLoader"],Ae=(new Te).parse(Me);Ae.name=e.name,oi(Ae,hi.callbacks);break;case"vox":break;case"vtk":case"vtp":case"wrl":case"xyz":break;case"zip":!async function(e){const t=(0,ai.GZ)(new Uint8Array(e)),s=[],n=new Map;let r="";for(const i in t){var a=t[i];-1!==i.indexOf(".")&&(r=i.split("/")[0],s.push(i.split("/")[1]),n.set(i.split("/")[1],a))}var o,l=new p.lLk;l.setURLModifier((e=>{e=e.replace(/^(\.?\/)/,"");var t=n.get(e);return t?(t=new Blob([t.buffer],{type:"application/octet-stream"}),URL.createObjectURL(t)):e})),n.get(r+".obj")&&n.get(r+".mtl")&&(e=(await i.e(651).then(i.bind(i,2651)))["MTLLoader"],o=(await i.e(949).then(i.bind(i,3949)))["OBJLoader"],e=new e(l).parse((0,ai.T8)(n.get(r+".mtl"))),oi((new o).setMaterials(e).parse((0,ai.T8)(n.get(r+".obj"))),hi.callbacks));for(const p in t){var h=t[p];switch(p.split(".").pop().toLowerCase()){case"3ds":var c=(await i.e(946).then(i.bind(i,1946)))["TDSLoader"];c=new c(l).parse(h.buffer);oi(c,hi.callbacks);case"fbx":c=(await i.e(375).then(i.bind(i,375)))["FBXLoader"],oi(new c(l).parse(h.buffer),hi.callbacks);break;case"glb":var d=(await i.e(539).then(i.bind(i,539)))["DRACOLoader"],u=(await i.e(225).then(i.bind(i,7225)))["GLTFLoader"];d=new d,u=(d.setDecoderPath("/libs/loaders//draco/gltf/"),new u);u.setDRACOLoader(d),u.parse(h.buffer,"",(e=>{var t=e.scene;t.animations.push(...e.animations),oi(t,hi.callbacks)}));case"gltf":d=(await i.e(539).then(i.bind(i,539)))["DRACOLoader"],u=(await i.e(225).then(i.bind(i,7225)))["GLTFLoader"];var m=new d,g=(m.setDecoderPath("/libs/loaders/gltf/"),new u(l));g.setDRACOLoader(m),g.parse((0,ai.T8)(h),"",(e=>{var t=e.scene;t.animations.push(...e.animations),oi(t,hi.callbacks)}))}}}(e.content)}}catch(t){this.callbacks.onLoadError(t)}}}class di{constructor(e){this.viewer=e.viewer,this.mainObject=e.model,this.mainEdgeObject=null,this.edgeSettings={showEdges:!1,edgeColor:new M(0,0,0),edgeThreshold:1}}UpdateWorldMatrix(){null!==this.mainObject&&this.mainObject.updateWorldMatrix(!0,!0)}EnumerateMeshes(e){null!==this.mainObject&&this.mainObject.traverse((t=>{t.isMesh&&e(t)}))}EnumerateEdges(e){null!==this.mainEdgeObject&&this.mainEdgeObject.traverse((t=>{t.isLineSegments&&e(t)}))}SetEdgeSettings(e,t,i,s){this.mainObject=e;let n=!1;!t||this.edgeSettings.showEdges&&this.edgeSettings.edgeThreshold===s||(n=!0),this.edgeSettings.showEdges=t,this.edgeSettings.edgeThreshold=s,this.edgeSettings.edgeColor=i,null!==this.mainObject&&(this.edgeSettings.showEdges?(this.ClearMainEdgeObject(),this.GenerateMainEdgeObject()):this.ClearMainEdgeObject())}GenerateMainEdgeObject(){je(this.edgeSettings.edgeColor),this.mainEdgeObject=new p.Tme,this.UpdateWorldMatrix(),this.EnumerateMeshes((e=>{var t=new p.TOt(e.geometry,this.edgeSettings.edgeThreshold);t=new p.ejS(t,new p.nls({color:"blue"}));t.applyMatrix4(e.matrixWorld),t.userData=e.userData,t.visible=e.visible,this.mainEdgeObject.add(t)})),this.viewer.scene.add(this.mainEdgeObject)}ClearMainEdgeObject(){null!==this.mainEdgeObject&&(this.EnumerateMeshes((e=>{})),this.EnumerateEdges((e=>{e.geometry.dispose()})),this.viewer.scene.remove(this.mainEdgeObject),this.mainEdgeObject=null)}}const ui={Light:1,Dark:2};class mi{constructor(){this.defaultColor=new M(200,200,200),this.showEdges=!0,this.edgeColor=new M(25,25,112),this.edgeThreshold=0,this.themeId=ui.Light,this.environmentMapName="fishermans_bastion",this.backgroundIsEnvMap=!0,this.sceneColor=12571109,this.angle=50,this.nearest=1,this.farthest=3e4,this.backgroundColor=new T(255,255,255,255)}}class pi{constructor(){this.css={"--ov_toolbar_background_color":{}};var e,t=document.querySelector(":root"),i=window.getComputedStyle(t);for(e in this.css)Object.prototype.hasOwnProperty.call(this.css,e)&&(this.css[e].light=i.getPropertyValue(e),this.css[e].dark=i.getPropertyValue(e+"_dark"))}SwitchTheme(e){let t=null;if(e===ui.Light)t="light";else{if(e!==ui.Dark)return;t="dark"}var i,s,n=document.querySelector(":root");for(i in this.css)Object.prototype.hasOwnProperty.call(this.css,i)&&void 0!==(s=this.css[i][t])&&n.style.setProperty(i,s)}}function gi(e,t,i){return Math.abs(t-e)<i}function vi(e){var t=new p.yGw;e.object.updateWorldMatrix(!0,!1),t.extractRotation(e.object.matrixWorld),e=e.face.normal.clone();return e.applyMatrix4(t),e}function fi(){return new p.nls({color:"red",depthTest:!1})}function bi(e,t){return e=(new p.u9r).setFromPoints(e),new p.x12(e,t)}class wi{constructor(e,t){this.intersection=null,this.markerObject=new p.Tme;var i=fi(),s=new p.Ny0(0,0,t,t,0,2*Math.PI,!1,0);this.markerObject.add(bi(s.getPoints(50),i)),this.markerObject.add(bi([new p.Pa4(-t,0,0),new p.Pa4(t,0,0)],i)),this.markerObject.add(bi([new p.Pa4(0,-t,0),new p.Pa4(0,t,0)],i)),this.UpdatePosition(e)}UpdatePosition(e){this.intersection=e,e=vi(this.intersection),this.markerObject.updateMatrixWorld(!0),this.markerObject.position.set(0,0,0),this.markerObject.lookAt(e),this.markerObject.position.set(this.intersection.point.x,this.intersection.point.y,this.intersection.point.z)}GetObject(){return this.markerObject}GetIntersection(){return this.intersection}Show(e){this.markerObject.visible=e}}class xi{constructor(e,t){this.viewer=e,this.settings=t,this.isActive=u.state.measure.isActive,this.markers=[],this.tempMarker=null,this.panel=null,this.info=""}IsActive(){return u.state.measure.isActive}SetActive(e){u.commit("measure/IsActive",e),u.state.measure.isActive?this.UpdatePanel():this.ClearMarkers()}Click(e){e=this.viewer.GetMeshIntersectionUnderMouse(e),null===e?this.ClearMarkers():(2===this.markers.length&&this.ClearMarkers(),this.AddMarker(e)),this.UpdatePanel()}MouseMove(e){e=this.viewer.GetMeshIntersectionUnderMouse(e),null===e?null!==this.tempMarker&&this.tempMarker.Show(!1):(null===this.tempMarker&&(this.tempMarker=this.GenerateMarker(e)),this.tempMarker.UpdatePosition(e),this.tempMarker.Show(!0))}UpdatePanel(){var e,t,i,s,n;0===this.markers.length?(u.commit("measure/AddInfo","选择一个点"),u.commit("measure/Reset"),u.commit("measure/ShowMeasureInfo",!1)):1===this.markers.length?(u.commit("measure/AddInfo","选择另一个点"),u.commit("measure/Reset"),u.commit("measure/ShowMeasureInfo",!1)):(u.commit("measure/ShowMeasureInfo",!0),e=this.markers[0],t=this.markers[1],e=e.GetIntersection(),t=t.GetIntersection(),i={pointsDistance:null,parallelFacesDistance:null,facesAngle:null},s=vi(e),n=vi(t),i.pointsDistance=e.point.distanceTo(t.point),i.facesAngle=s.angleTo(n),(gi(i.facesAngle,0,1e-4)||gi(i.facesAngle,Math.PI,1e-4))&&(n=(new p.JOQ).setFromNormalAndCoplanarPoint(s,e.point),i.parallelFacesDistance=Math.abs(n.distanceToPoint(t.point))),null!==(s=i).pointsDistance&&(this.info="measure_distance",u.commit("measure/AddPointsDistance",s.pointsDistance.toFixed(3))),null!==s.parallelFacesDistance&&(this.info="measure_distance_parallel",u.commit("measure/AddDistanceParallel",s.parallelFacesDistance.toFixed(3))),null!==s.facesAngle&&(this.info="measure_angle",e=57.29577951308232*s.facesAngle,u.commit("measure/AddAngel",e.toFixed(1)+"°")))}Resize(){var e,t,i;this.isActive&&(e=this.viewer.GetCanvas().getBoundingClientRect(),i=this.panel.getBoundingClientRect(),t=e.right-e.left,i=i.right-i.left,this.panel.style.left=e.left+(t-i)/2+"px",this.panel.style.top=e.top+10+"px")}AddMarker(e){var t,i;e=this.GenerateMarker(e);this.markers.push(e),2===this.markers.length&&(e=fi(),t=this.markers[0].GetIntersection().point,i=this.markers[1].GetIntersection().point,this.viewer.AddExtraObject(bi([t,i],e)))}GenerateMarker(e){var t=this.viewer.GetBoundingSphere((e=>!0)).radius/20;e=new wi(e,t);return this.viewer.AddExtraObject(e.GetObject()),e}ClearMarkers(){this.viewer.ClearExtra(),this.markers=[],this.tempMarker=null}}var Ci=i(3271),yi=(d=i(6912),i.n(d));const Mi=document.createElement("a");function Ti(e,t){Mi.href=URL.createObjectURL(e),Mi.download=t,Mi.click()}let Ai,Si;function Ii(){document.body.appendChild(Ai)}function Li(){document.body.removeChild(Ai)}Mi.style.display="none",document.body.appendChild(Mi),(async()=>{var e=await yi()();e.instance.exports.add(2,3)})();const Ei={Undefined:0,Intro:1,Model:2,Loading:3};new p.nls({color:16777215}),new p.YBo({side:p.ehD}),new p.xoR({color:5592405,specular:16777215,shininess:10,flatShading:!1,side:p.ehD,skinning:!0}),new p.jyz({uniforms:{p:{type:"f",value:3},glowColor:{type:"c",value:new p.Ilk(8703231)}},side:p.ehD,blending:p.WMw,transparent:!0,depthWrite:!1});class _i extends Ct{constructor(e){super(),this.signals={},this.parameters=e,this.canvas=null,this.settings=new mi,this.viewer=new kt(this.parameters.viewerDiv,this.parameters.view2,this.settings,this),this.canvas=Je(this.parameters.viewerDiv,"canvas"),this.viewer.Init(this.canvas),this.uiState=Ei.Undefined,this.hashHandler=new Rt,this.modelLoaderUI=new ei,this.loader=new ci(this,this.viewer),this.themeHandler=new pi,this.measureTool=new xi(this.viewer,this.settings),this.model=null,this.cloneModel=null,this.showEdge=new di(this),this.edgeVal=null,(Ai=document.createElement("div")).style.position="absolute",Ai.style.top="0",Ai.style.opacity="0.8",Ai.style.width="100%",Ai.style.height="100%",Ai.style.display="flex",Ai.style.alignItems="center",Ai.style.justifyContent="center",Ai.style.background="#616161",(Si=document.createElement("img")).src="static/images/loading.gif",Si.style.width="200px",Si.style.height="200px",Ai.appendChild(Si),this.progressDiv1=document.querySelector(".main-progress-display__progress"),this.progressWrap1=document.querySelector(".main-progress-wrapper")}GetModel(){return this.model}start(e){this.dispatchEvent({type:"start",message:"blas val change"+e})}Load(e){var t=new Pt("$");t.AddBackgroundColor(this.settings.backgroundColor),t=this.hashHandler.GetBackgroundFromHash();null!==t&&this.viewer.outline.SetBackgroundColor(t),this.hashHandler.GetCameraFromHash(),this.edgeVal=e,this.viewer.SetBackgroundColor(this.settings.backgroundColor),this.UpdateEnvironmentMap();let i,s=!1,n=(document.addEventListener("keydown",(e=>{s=!0})),document.addEventListener("keyup",(e=>{s=!1})),!1),r=this;document.addEventListener("click",(function(e){n?(clearTimeout(i),r.onDoubleClick(e),n=!1):(n=!0,i=setTimeout((()=>{r.viewer.outline.Click(e),n=!1}),250))}));let a=!1,o=null;this.parameters.viewerDiv.addEventListener("mousedown",(e=>{this.parameters.viewerDiv.style.cursor="grabbing",0===e.button&&e.altKey&&(a=!0,o=new p.FM8(e.clientX,e.clientY),this.changeLight=!0)})),this.parameters.viewerDiv.addEventListener("mouseup",(e=>{this.parameters.viewerDiv.style.cursor="grab",a=!1,o=null,this.viewer.controls.enabled=!0})),document.addEventListener("mousemove",(e=>{var t,i,s;a&&this.changeLight&&(t=this.viewer.scene.getObjectByName("directionalLight"))instanceof p.Ox3&&(this.viewer.controls.enabled=!1,i=t.position.clone(),s=new p.FM8(e.clientX,e.clientY).sub(o),s=new p.Pa4(.2*s.x,.2*s.y,0),i.add(s),t.position.copy(i),o=new p.FM8(e.clientX,e.clientY))})),document.addEventListener("keydown",(function(e){"f"===e.key&&(document.fullscreenElement?document.exitFullscreen():document.getElementById("model-wrapper").requestFullscreen())})),this.InitDragAndDrop(),this.Resize(),window.addEventListener("resize",(()=>{this.Resize()})),this.hashHandler.SetEventListener(this.OnHashChange.bind(this)),this.OnHashChange()}getModel(){return this.model}InitDragAndDrop(){window.addEventListener("dragstart",(e=>{e.preventDefault()}),!1),window.addEventListener("dragover",(e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}),!1),window.addEventListener("drop",(e=>{e.stopPropagation(),e.preventDefault(),"text/plain"!==event.dataTransfer.types[0]&&event.dataTransfer.items&&this.loader.loadItemList(event.dataTransfer.items,{onLoadStart:()=>{this.ClearModel(),u.dispatch("app/showLoading",!0),Ii()},onFileListProgress:(e,t)=>{},onFileLoadProgress:(e,t)=>{},onSelectMainFile:()=>{},onImportStart:()=>{},onVisualizationStart:()=>{},onModelFinished:e=>{this.model=e,this.OnModelLoaded(e),u.dispatch("app/showLoading",!1),Li(),this.ClearHashIfNotOnlyUrlList()},onTextureLoaded:()=>{},onLoadError:e=>{Ai.innerText=e}})}),!1)}async OnHashChange(){var e,t;this.hashHandler.HasHash()?null!==(e=this.hashHandler.GetModelFilesFromHash())&&(null!==(t=this.hashHandler.GetBackgroundFromHash())&&this.viewer.SetBackgroundColor(t),Nt("model_load_started","hash"),this.LoadModelFromUrlList(e,{})):(this.progressWrap1.style.display="none",this.ClearModel())}async LoadModelFromUrlList(e,t){this.loader.loadItemUrls(e,{onLoadStart:()=>{this.ClearModel(),u.dispatch("app/showLoading",!0),Ii()},onFileListProgress:(e,t)=>{},onFileLoadProgress:(e,t)=>{this.progressDiv1.style.width=Math.round(e/t*200,2)+"px"},onSelectMainFile:()=>{},onImportStart:()=>{},onVisualizationStart:()=>{},onModelFinished:e=>{this.OnModelLoaded(e),Li(),u.dispatch("app/showLoading",!1),this.ClearHashIfNotOnlyUrlList(),this.progressWrap1.style.display="none"},onTextureLoaded:()=>{},onLoadError:e=>{this.progressWrap1.style.display="none";var t="Error loading model";Ai.innerText=t,Li()}})}LoadModelFromFileList(e){var t=new Ue;t.defaultColor=this.settings.defaultColor,e=function(e){var t,i=[];for(t of e){var s=w(t.name);i.push(new _(s,b.File,t))}return i}(e);this.LoadModelFromInputFiles(e,t),this.ClearHashIfNotOnlyUrlList()}LoadModelFromInputFiles(e,t){this.modelLoaderUI.LoadModel(e,t,{onStart:()=>{this.ClearModel()},onFinish:(e,t)=>{this.OnModelLoadedOnline(e,t)},onRender:()=>{},onError:()=>{}})}ClearHashIfNotOnlyUrlList(){}SetUIState(e){var t;this.uiState!==e&&(this.uiState=e,this.uiState!==Ei.Intro&&(this.uiState===Ei.Model?(e=this.parameters.mainDiv,t=!0,e.style.display=t?"block":"none"):this.uiState),this.Resize())}onDoubleClick(e){e.preventDefault();var t=new p.iMs,i=new p.FM8;i.x=e.clientX/window.innerWidth*2-1,i.y=-e.clientY/window.innerHeight*2+1,t.setFromCamera(i,this.viewer.camera),e=t.intersectObjects(this.viewer.scene.children,!0);0<e.length?(i=e[0],t=new N(i.point.x,i.point.y,i.point.z),e=(new p.ZzF).setFromObject(this.model),i=new p.aLr,e.getBoundingSphere(i),e=this.viewer.navigation.GetFitToSphereCamera(t,i.radius,!0),this.viewer.navigation.MoveCamera(e,40)):this.FitModelToWindow(!1)}OnModelClicked(e,t){this.viewer.outline.Click(t),1===e&&this.measureTool.IsActive()&&this.measureTool.Click(t)}OnModelMouseMoved(e){this.measureTool.IsActive()&&this.measureTool.MouseMove(e)}OnModelLoadedOnline(e,t){this.model=e.model,this.viewer.SetMainObject(t),this.FitModelToWindow(!1)}OnModelLoaded(e){if(this.dispatchEvent({type:"getmodel",model:e}),e.traverse((e=>{var t;e instanceof p.Kj0&&(t=e.material).map&&t.map.image,e.isMesh&&e.material})),u.commit("app/ADD_MODEL",e),this.model=e,this.cloneModel=e,this.parameters.callback&&this.parameters.callback.onModelLoaded(e),this.viewer.SetMainObject(e),e){var t=new p.ZzF;t.setFromObject(e);const i=wt(t),s=new p.ZzF;e.traverse((function(e){var t;e.isMark||e.isMarkChild||e.isLine||e.isSprite||e.isMesh&&(s.setFromObject(e),t=wt(s),e.userData.worldDir=(new p.Pa4).subVectors(t,i).normalize(),e.userData.worldDistance=(new p.Pa4).subVectors(t,i),e.userData.originPosition=e.getWorldPosition(new p.Pa4),e.userData.meshCenter=t.clone(),e.userData.explodeCenter=i.clone())}))}this.FitModelToWindow(!0),this.UpdateEdgeDisplay(!1),u.commit("app/IF_SHOW_EDGE",!1),u.commit("app/CHANGE_EDGE_VAL",100)}FitModelToWindow(e){var t=!e,i=this.boundingSphere=this.viewer.GetBoundingSphere((e=>!0));e&&this.viewer.AdjustClippingPlanesToSphere(i),this.viewer.FitSphereToWindow(i,t)}ClearModel(){this.model=null,u.commit("app/RESET_MODEL"),this.viewer.Clear()}OnSmallWidthChanged(){}UpdatePanelsVisibility(){this.navigator.ShowPanels(!1),this.sidebar.ShowPanels(!1)}Resize(){window.innerWidth,window.innerHeight,this.viewer.Resize(this.parameters.viewerDiv.offsetWidth,this.parameters.viewerDiv.offsetHeight)}SwitchTheme(e,t){this.settings.themeId=e,this.themeHandler.SwitchTheme(this.settings.themeId)}UpdateEdgeDisplay(e,t=40){this.settings.showEdges=e,this.settings.edgeThreshold=e?t:0,this.showEdge.SetEdgeSettings(this.model,this.settings.showEdges,this.settings.edgeColor,this.settings.edgeThreshold)}onEnvironmentMapChange(){this.UpdateEnvironmentMap()}UpdateEnvironmentMap(){var e="static/envmaps/"+this.settings.environmentMapName+"/";this.viewer.SetEnvironmentMapSettings([e+"posx.jpg",e+"negx.jpg",e+"posy.jpg",e+"negy.jpg",e+"posz.jpg",e+"negz.jpg"],this.settings.backgroundIsEnvMap)}Blast(e,t){xt(e,t)}Measure(e){this.measureTool.SetActive(e),u.commit("measure/IsActive",e)}exportGltf(){let e=(new Date).getTime();(new Ci.M).parse(this.model,(function(t){t instanceof ArrayBuffer?(i="scene.glb",Ti(new Blob([t],{type:"application/octet-stream"}),i)):(i=JSON.stringify(t,null,2),t="scene.gltf",Ti(new Blob([i],{type:"text/plain"}),t));var i;t=(new Date).getTime(),t-=e;Math.round(t/1e3)}),(function(e){}),{binary:!1,embedImages:!0,includeCustomExtensions:!0})}}function ki(e){Dt=e}function Fi(e,t,i){return Z=e,e=new _i({viewerDiv:document.getElementById("main_viewer"),view2:document.getElementById("view2"),callback:i}),e.Load(t),e}function Gi(e){window.innerWidth===screen.width&&window.innerHeight===screen.height||window.fullScreen?function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():this.noFullscreenSupport()}():e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():alert("Your browser does not support the Fullscreen API.")}s.default.use(n.ZP),new n.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}}),l={name:"ModelEngine",props:{width:{type:String,default:"500"},height:{type:String,default:"500"}},data(){return{overlays:!1,activeIndex:1,tabs:["Navigation basics","All controls"],currentAnimateName:"",isUpArrow:!0,mixer:At,totalFrames:0,value4:3,visible:!1,animations:null,actions:null,currentAnimationIndex:0,currentAnimationIndex:0,timeScale:1,repeatType:0,loopType:null,loopMode:"repeat one",animationClip:null,animationAction:null,animationFrameId:null,knobPosition:0,timelineWidth:0,knobWidth:0,currentTime:0,totalTime:0,progressWidth:"0%",mouseDownX:0,startTime:0,isDragging:!1,isPlaying:!0,num:0,website:null,wanggeValue:!1,rotationValue:!1,showSlider:!0,slideValue:0,btns:["默认","深色","浅色"],envMaps:[{name:"清空",url:"static/envmaps/noimage.jpg",backgroundIsEnvMap:!1},{name:"teide",url:"static/envmaps/teide/posx.jpg",backgroundIsEnvMap:!0}],tabIndex:0,wanggeBtn:!1,dragMeshBtn:!1,yincangBtn:!1,duxianBtn:!1,toumingBtn:!1,fullScreenBtn:!0,celiangBtn:!1,ifplay:!1,hasAnimation:!0,isActive:!0}},filters:{statusFilter(e){const t=new Map;return[[.1,"x0.1"],[.5,"x0.5"],[1,"x1"],[2,"x2"]].forEach((([e,i])=>t.set(e,i))),t.get(e)}},watch:{repeatType:{handler(e){alert(e)},deep:!0}},computed:{clip(){return"repeatOne"===this.repeatMode?this.animationClips[0]:(this.repeatMode,this.animationClips[this.animationClips.length-1])},animationClips(){return At?At._actions.map((e=>e._clip)):[]},knobTransform(){return`translateX(${this.knobPosition}px)`},nowTime(){var e=this.currentTime.toFixed(2),t=Math.floor(e).toString().padStart(2,"0");return t+":"+(1e3*(e-t)).toString().padStart(2,"0").substring(0,2)},...(0,n.rn)({showLoading:e=>e.app.showLoading,ifduxian:e=>e.app.duxian,ifwangge:e=>e.app.wangge,iftouming:e=>e.app.touming,ifyidong:e=>e.app.yidong,ifyincang:e=>e.app.yincang,info:e=>e.measure.info,pointsDistance:e=>e.measure.pointsDistance,parallelFacesDistance:e=>e.measure.parallelFacesDistance,facesAngle:e=>e.measure.facesAngle,MeasureisActive:e=>e.measure.isActive,showMeasureIInfo:e=>e.measure.showMeasureIInfo}),blastVal:{get(){return this.$store.state.app.blastVal},set(e){this.$store.state.app.blastVal=e}},edgeVal:{get(){return this.$store.state.app.edgeVal},set(e){this.$store.commit("app/CHANGE_EDGE_VAL",e)}},ifShowEdge:{get(){return this.$store.state.app.ifShowEdge},set(e){this.$store.state.app.ifShowEdge=e}},hasAnimate(){return null!==this.$store.state.app.model&&this.$store.state.app.model.hasOwnProperty("animations")?this.$store.state.app.model.animations.length:0},animateTime(){return Math.round(100*this.currentTime)/100},...(0,n.Se)(["getBlastVal"])},watch:{blastVal:{handler(e,t){},deep:!0,immediate:!0}},methods:{hideTooltip(){this.$refs.button.$refs.tooltip.hide()},setLoopMode(e){this.actions&&("repeat one"===e?(alert("repeat one"),this.animationAction.setLoop(p.YKA,1)):"repeat all"===e?(alert("repeat all"),this.animations.forEach((e=>{At.clipAction(e).setLoop(this.repeatMode,1)}))):"no repeat"===e&&(this.animations.forEach((e=>{At.clipAction(e).setLoop(p.jAl,1)})),e=this.animations[this.animations.length-1],e=At.clipAction(e),this.currentAnimateName=e.getClip().name,e.clampWhenFinished=!0,e.loop=p.jAl,e.play(),e.timeScale=0,e.paused=!1,e.addEventListener("finished",(()=>{At.stopAllAction()}))))},onActionFinished(e){const t=e.action.getClip().name;e=(this.animations.findIndex((e=>e.name===t))+1)%this.animations.length,e=this.actions[e],"repeat one"===this.loopMode?(e.setLoop(p.jAl),e.clampWhenFinished=!0):"repeat all"===this.loopMode?e.setLoop(p.YKA):"no repeat"===this.loopMode&&e.setLoop(p.uEv),this.animationAction.stop(),this.animationAction=e,this.animationAction.play(),this.updateline()},formatTooltip(e){return e/100},getLoopMode(e){return 1===e.repetitions?p.jAl:e.repetitions===1/0?p.YKA:p.uEv},onAnimationEnd(){this.isPlaying=!1},changeRepeatMode(e){0==(this.repeatType=e)?this.animationAction.setLoop(p.YKA,1):1==e?this.animationAction.loop=p.jAl:(this.animationAction.setLoop(p.jAl),e=this.animations[this.animations.length-1],(e=At.clipAction(e)).clampWhenFinished=!0,e.loop=p.jAl,e.play(),e.timeScale=0,e.paused=!1,e.addEventListener("finished",(()=>{At.stopAllAction()}))),At.addEventListener("finished",(e=>{const t=e.action._clip.name;e=(this.animations.findIndex((e=>e.name===t))+1)%this.animations.length,e=this.animations[e],e=At.clipAction(e),this.currentAnimateName=e.getClip().name,this.loopType===p.jAl?e.setLoop(p.jAl):this.loopType===p.YKA?e.setLoop(p.YKA):this.loopType===p.uEv&&e.setLoop(p.uEv),this.totalTime=e.duration,e.play()}))},changeTimeScale(e){this.timeScale=e,this.isPlaying=!0,At.timeScale=this.timeScale},StaticPose(){this.animationAction.stop(),this.isPlaying=!1},changeAnimation(e){this.currentAnimationIndex=e,this.animationClip=this.model.animations[e],this.animationAction=At.clipAction(this.animationClip),this.currentAnimateName=this.animationAction.getClip().name,this.totalTime=this.animationAction._clip.duration,e=this.animations[e],this.animationAction.timeScale=this.timeScale,this.animationAction.setLoop(this.loopType),this.animationAction.paused=!1,At.stopAllAction(),At.clipAction(e).play(),this.updateline()},togglePlay(){this.isPlaying=!this.isPlaying,this.isPlaying?(this.animationAction.paused=!1,this.animationAction.play()):this.animationAction.paused=!0,At.addEventListener("finished",(e=>{this.onAnimationEnd()}))},PlayPause(){this.animationAction.paused?(this.isPlaying=!0,this.animationAction.paused=!1):(this.isPlaying=!1,this.animationAction.paused=!0)},testline(){requestAnimationFrame(this.testline)},updateline(){Date.now(),this.startTime,this.totalTime,this.animationAction.time>=this.totalTime&&(this.animationAction.time=0),this.moveKnob(this.animationAction.time/this.totalTime*this.timelineWidth),requestAnimationFrame(this.updateline)},onTimelineMouseDown(e){e.preventDefault(),this.onTimelineClick(e),document.addEventListener("mousemove",this.onTimelineMouseMove),document.addEventListener("mouseup",this.onTimelineMouseUp)},onTimelineMouseMove(e){this.isDragging=!0,this.onTimelineClick(e)},onTimelineMouseUp(){this.isDragging=!1,this.isPlaying=!0,this.animationAction.paused=!1,document.removeEventListener("mousemove",this.onTimelineMouseMove),document.removeEventListener("mouseup",this.onTimelineMouseUp)},onTimelineClick(e){this.isDragging=!0,this.isPlaying=!1;var t=this.$refs.timeline.getBoundingClientRect();e=e.clientX-t.left-this.knobWidth/2;this.moveKnob(e),this.animationAction.paused=!0},moveKnob(e){var t=this.timelineWidth;e<0?e=0:t<e&&(e=t),this.knobPosition=e,this.updateTimeline()},updateTimeline(){this.progressWidth=(this.knobPosition-this.knobWidth/2)/this.timelineWidth*100+"%",this.isDragging?(this.currentTime=this.knobPosition/this.timelineWidth*this.totalTime,this.animationAction.time=this.currentTime):this.currentTime=this.animationAction.time},exportGltf(){this.website.exportGltf()},async nativePick(e){var t=e?e.target.value:null;if(!t){t=new window.EyeDropper;try{await t.open()}catch(e){}}},down(e){alert("down")},move(e){alert("move")},up(){alert("up")},switchleft(){this.isActive=!this.isActive},changeWange(e){this.wanggeValue=e,this.website.viewer.outline.setWireFrame(this.wanggeValue,this.website.model)},Wange(){this.website.viewer.outline.setWireFrame(!this.$store.state.app.wangge,this.website.model)},changeDuxian(){this.website.viewer.outline.duxian(this.website.model,!this.$store.state.app.duxian)},Duxian(){this.website.viewer.outline.duxian(this.website.model,!this.$store.state.app.duxian)},changeTouming(){this.toumingBtn=!this.toumingBtn,this.website.viewer.outline.touming(this.website.model,this.toumingBtn)},changeTouming2(){this.toumingBtn=!this.toumingBtn,this.website.viewer.outline.touming(this.website.model,!0)},Touming(){this.$store.state.app.yincang&&this.$store.commit("app/YIN_CANG",!1),this.website.viewer.outline.touming(this.website.model,!this.$store.state.app.touming)},changeYincang(){this.website.viewer.outline.yincang(this.website.model,!0)},Yincang(){this.$store.state.app.touming&&this.$store.commit("app/TOU_MING",!1),this.website.viewer.outline.yincang2(this.website.model,!this.$store.state.app.yincang)},dragMesh(){this.dragMeshBtn=!this.dragMeshBtn,this.dragMeshBtn,this.website.viewer.outline.dragMesh(this.website.model,this.dragMeshBtn)},resetDragMesh(){this.dragMeshBtn=!1,this.website.wireFrame.resetDragMesh(this.website.model)},dragMeshs(){this.dragMeshBtn=!this.dragMeshBtn,this.website.wireFrame.dragMeshs(this.dragMeshBtn,this.website.model)},Yidong(){this.website.viewer.outline.dragMesh(this.website.model,!this.$store.state.app.yidong)},changeEdge(){this.website.UpdateEdgeDisplay(this.$store.state.app.ifShowEdge,this.$store.state.app.edgeVal)},backgroundTabClick(e){this.tabIndex=e,this.website.viewer.outline.SetbackgroundColor(e)},SetEnvironment(e,t){this.website.viewer.outline.SetEnvironment(e,t)},blastChange(e){this.website.viewer.outline.Blast(this.website.model,e)},edgeChange(e){this.website.viewer.outline.Edge(this.website.model,e)},autoRotation(e){this.rotationValue=e,this.website.viewer.outline.rotation(this.rotationValue)},reset(){this.website.viewer.outline.reset(this.website.model)},fullScreen(e){this.fullScreenBtn=!this.fullScreenBtn,e.preventDefault(),Gi(document.getElementById("model-wrapper"))},help(){this.overlays=!0},closeHelp(){this.overlays=!1},celiang(){this.website.Measure(!this.$store.state.MeasureisActive)},handleMessage(e){}},updated(){},beforeDestroy(){cancelAnimationFrame(this.animationFrameId)},created(){},mounted(){ki(((e,t,i)=>{})),this.mixer=At,this.website=Fi("",this.$store.state.app.edgeVal,{onModelLoaded:e=>{var t=Et(this.model=e,this.onAnimationEnd.bind(this));if(_t(e),t){this.$nextTick((()=>{this.timelineWidth=this.$refs.timeline.offsetWidth,this.knobWidth=this.$refs.knob.offsetWidth})),this.animations=e.animations,this.actions=this.animations.map((e=>At.clipAction(e))),this.mixer=At;for(let e=0;e<this.animations.length;e++){var i=this.animations[e];At.clipAction(i)}(this.loopMode="repeat one")==this.loopMode&&(this.actions.forEach((e=>{e.repetitions=1/0,e.setLoop(p.jAl,1)})),this.actions[0].setLoop(p.YKA)),this.animationClip=this.animations[0],this.animationAction=this.actions[0],this.currentAnimateName=this.actions[0].getClip().name,this.totalTime=this.animationAction._clip.duration,this.animationAction.play(),this.updateline(),At.addEventListener("finished",this.onActionFinished)}}}),this.website.addEventListener("getmodel",(e=>{this.anianiActionsTmep=e.model.animations})),window.addEventListener("message",(function(e){"string"==typeof e.data.url&&e.data.url.startsWith("https://")&&(window.location.hash="#model="+e.data.url)}))}},d=(0,a.Z)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"viewer"},[t("div",{staticClass:"model-wrapper",attrs:{id:"model-wrapper"}},[e._m(0),e.overlays?t("div",{staticClass:"overlays"},[t("a",{staticClass:"close",on:{click:e.closeHelp}},[t("i",{staticClass:"icon iconfont icon-close",staticStyle:{"font-size":"24px"}})]),t("div",{staticClass:"tabs"},[t("div",{staticClass:"tab-header"},e._l(e.tabs,(function(i,s){return t("div",{key:s,staticClass:"tab-header-item",class:{active:e.activeIndex===s},on:{click:function(t){e.activeIndex=s}}},[e._v(e._s(e.tabs[s]))])})),0),t("div",{staticClass:"tabs-container"},[t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.activeIndex,expression:"activeIndex === 0"}],staticClass:"tab"},[e._m(1),e._m(2),e._m(3)]),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.activeIndex,expression:"activeIndex === 1"}],staticClass:"tab"},[e._m(4)])]),e._m(5)])]):e._e(),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoading,expression:"showLoading"}],ref:"main_viewer",staticClass:"main_viewer model-loaded has-model has-animation",attrs:{id:"main_viewer","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}}),t("div",{staticClass:"side_menu_wrap",class:[e.isActive?"left0":"left200"]},[t("div",{staticClass:"side-menu"},[e._m(6),t("div",{staticClass:"btns"},e._l(e.btns,(function(i,s){return t("span",{key:s,class:[e.tabIndex==s?"active":""],on:{click:function(t){return e.backgroundTabClick(s)}}},[e._v(e._s(i))])})),0),e._m(7),t("div",{staticClass:"envMaps"},e._l(e.envMaps,(function(i,s){return t("el-image",{key:s,staticClass:"img",staticStyle:{width:"45px",height:"45px"},attrs:{src:i.url},on:{click:function(t){return e.SetEnvironment(i.name,i.backgroundIsEnvMap)}}})})),1),t("p",{staticClass:"label_row"},[t("span",[e._v("Show Edges")]),t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.changeEdge},model:{value:e.ifShowEdge,callback:function(t){e.ifShowEdge=t},expression:"ifShowEdge"}})],1),e.ifShowEdge?t("div",{staticClass:"blast-slider"},[t("el-slider",{directives:[{name:"show",rawName:"v-show",value:e.showSlider,expression:"showSlider"}],attrs:{min:0,max:100},on:{change:e.edgeChange},model:{value:e.edgeVal,callback:function(t){e.edgeVal=t},expression:"edgeVal"}})],1):e._e(),t("p",{staticClass:"label_row"},[t("span",[e._v("模型拆分"+e._s(e.hasAnimate))])]),t("div",{staticClass:"blast-slider"},[t("el-slider",{directives:[{name:"show",rawName:"v-show",value:e.showSlider,expression:"showSlider"}],attrs:{min:1,max:100},on:{change:e.blastChange},model:{value:e.blastVal,callback:function(t){e.blastVal=t},expression:"blastVal"}})],1),t("el-row",{staticClass:"row"},[t("span",[e._v("显示网格")]),t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.changeWange},model:{value:e.wanggeValue,callback:function(t){e.wanggeValue=t},expression:"wanggeValue"}})],1),t("el-row",{staticClass:"row"},[t("span",[e._v("自动旋转")]),t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.autoRotation},model:{value:e.rotationValue,callback:function(t){e.rotationValue=t},expression:"rotationValue"}})],1),t("p",{staticClass:"label_row"},[t("span",[e._v("模型操作 "+e._s(e.hasAnimate)+" ")])]),t("div",{staticClass:"items"},[t("span",{class:[e.ifduxian?"active":""],on:{click:e.changeDuxian}},[t("i",{staticClass:"icon iconfont",class:[e.ifduxian?"icon-quanbu":"icon-yanjing"]}),t("b",[e._v(e._s(e.ifduxian?"全显":"独显"))])]),t("span",{class:[e.dragMeshBtn?"active":""],on:{click:e.dragMesh}},[t("i",{staticClass:"icon iconfont icon-yidong"}),t("b",[e._v("移动")])]),t("span",{on:{click:e.reset}},[t("i",{staticClass:"icon iconfont icon-ic_fuwei"}),t("b",[e._v("重置 ")])]),t("span",{class:[e.MeasureisActive?"active":""],on:{click:e.celiang}},[t("i",{staticClass:"icon iconfont icon-chizi"}),t("b",[e._v("测量")])]),t("span",{on:{click:e.changeYincang}},[t("i",{staticClass:"icon iconfont icon-yincang"}),t("b",[e._v("隐藏")])]),t("span",{on:{click:e.changeTouming2}},[t("i",{staticClass:"icon iconfont icon-toumingdutiaojie"}),t("b",[e._v("透明 ")])])])],1),t("div",{staticClass:"switch",on:{click:e.switchleft}},[t("i",{staticClass:"icon iconfont",class:[e.isActive?"icon-zuojiantou-copy ":"icon-zuojiantou"]})])]),t("div",{ref:"controls",staticClass:"controls"},[e.hasAnimate?t("div",{staticClass:"animation-controls"},[t("div",{ref:"timeline",staticClass:"timeline"},[t("div",{staticClass:"timeline-wrapper",on:{mousedown:e.onTimelineMouseDown}},[t("div",{staticClass:"track"},[t("div",{staticClass:"bar"}),t("div",{ref:"knob",staticClass:"knob",style:{transform:e.knobTransform}})])])]),t("div",{staticClass:"animation-controls__buttons"},[t("div",{staticClass:"play",class:[e.isPlaying?"active":""],on:{click:e.togglePlay}},[t("i",{staticClass:"icon iconfont",class:[e.isPlaying?"icon-zanting":"icon-playcircle"],staticStyle:{"font-size":"24px",color:"#fff"}})]),t("div",{staticClass:"animation-timer"},[t("span",{staticClass:"time"},[e._v(" "+e._s(e.nowTime))])]),t("el-popover",{attrs:{placement:"top",width:"200"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"toggle-button"},[t("el-radio-group",{attrs:{size:"mini"},on:{input:function(t){return e.changeRepeatMode(e.repeatType)}},model:{value:e.repeatType,callback:function(t){e.repeatType=t},expression:"repeatType"}},[t("el-tooltip",{attrs:{placement:"top",content:"Repeat one",enterable:!1}},[t("el-radio-button",{attrs:{label:"0"}},[t("i",{staticClass:"icon iconfont",class:["icon-repeat-one-copy"],staticStyle:{"font-size":"16px"}})])],1),t("el-tooltip",{attrs:{placement:"top",content:"Repeat all",enterable:!1}},[t("el-radio-button",{attrs:{label:"1"}},[t("i",{staticClass:"icon iconfont",class:["icon-repeat-copy"],staticStyle:{"font-size":"16px"}})])],1),t("el-tooltip",{attrs:{placement:"top",content:"no Repeat",enterable:!1}},[t("el-radio-button",{attrs:{label:"2"}},[t("i",{staticClass:"icon iconfont",class:["icon-repeatoff-copy"],staticStyle:{"font-size":"16px"}})])],1)],1)],1),t("div",{staticClass:"toggle-button__option"},[t("el-radio-group",{attrs:{size:"mini"},on:{input:function(t){return e.changeTimeScale(e.timeScale)}},model:{value:e.timeScale,callback:function(t){e.timeScale=t},expression:"timeScale"}},[t("el-tooltip",{attrs:{placement:"top",content:"Speed x0.1",enterable:!1}},[t("el-radio-button",{ref:"button",attrs:{label:"0.1"}})],1),t("el-tooltip",{attrs:{placement:"top",content:"Speed x0.5",enterable:!1}},[t("el-radio-button",{attrs:{label:"0.5"}})],1),t("el-tooltip",{attrs:{placement:"top",content:"Speed x1",enterable:!1}},[t("el-radio-button",{attrs:{label:"1"}})],1),t("el-tooltip",{attrs:{placement:"top",content:"Speed x2",enterable:!1}},[t("el-radio-button",{attrs:{label:"2"}})],1)],1)],1),t("el-divider"),t("ul",{staticClass:"animation-list"},[t("li",{on:{click:e.StaticPose}},[e._v(" Static Pose ")]),e._l(e.animations,(function(i,s){return t("li",{key:s,class:{selected:e.currentAnimationIndex===s},on:{click:function(t){return e.changeAnimation(s)}}},[e._v(e._s(i.name)+" "),e.currentAnimationIndex===s?t("span",[e._v("✔️")]):e._e()])}))],2),t("p",{staticClass:"animation-name",attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(e.currentAnimateName)+" "),t("span",{staticClass:"triangle",class:{up:e.isUpArrow}})])],1)],1)]):e._e(),t("div",{staticClass:"general-controls"},[t("el-tooltip",{attrs:{placement:"top",content:"help"}},[t("div",{staticClass:"btn",on:{click:e.help}},[t("i",{staticClass:"icon iconfont icon-qm",staticStyle:{"font-size":"16px"}})])]),t("el-tooltip",{attrs:{placement:"top",content:"全屏"}},[t("div",{staticClass:"btn",on:{click:e.fullScreen}},[t("i",{staticClass:"icon iconfont",class:[e.fullScreenBtn?"icon-quanping":"icon-quxiaoquanping"],staticStyle:{"font-size":"16px"}})])])],1)]),e.MeasureisActive?t("div",{staticClass:"measureInfo"},[e.showMeasureIInfo?t("div",[t("span",[t("i",{staticClass:"icon iconfont icon-guanxianchangdu"}),t("b",[e._v(e._s(e.pointsDistance))])]),t("span",[t("i",{staticClass:"icon iconfont icon-jiaodu"}),t("b",[e._v(e._s(e.facesAngle))])])]):t("div",[t("span",[e._v(" "+e._s(e.info))])])]):e._e()])])}),[function(){var e=this._self._c;return e("div",{staticClass:"main-progress-wrapper"},[e("div",{staticClass:"main-progress-percentage loading-percentage"},[this._v("100%")]),e("p",[this._v("Loading 3D model")]),e("div",{staticClass:"main-progress-display"},[e("div",{staticClass:"main-progress-display__progress"})])])},function(){var e=this._self._c;return e("div",{staticClass:"tip"},[e("div",[e("i",{staticClass:"icon iconfont icon-xunhuan1",staticStyle:{"font-size":"24px"}})]),e("div",[e("b",[this._v("Orbit around")]),e("div",[this._v(" Left click + drag or"),e("br"),this._v(" One finger drag (touch) ")])])])},function(){var e=this._self._c;return e("div",{staticClass:"tip"},[e("div",[e("i",{staticClass:"icon iconfont icon-fangda2",staticStyle:{"font-size":"24px"}})]),e("div",[e("b",[this._v("Orbit around")]),e("div",[this._v(" Left click + drag or"),e("br"),this._v(" One finger drag (touch) ")])])])},function(){var e=this._self._c;return e("div",{staticClass:"tip"},[e("div",[e("i",{staticClass:"icon iconfont icon-icon-",staticStyle:{"font-size":"24px"}})]),e("div",[e("b",[this._v("Orbit around")]),e("div",[this._v(" Left click + drag or"),e("br"),this._v(" One finger drag (touch) ")])])])},function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"section"},[t("span",{staticClass:"title"},[e._v("Orbit navigation")]),t("b",[e._v("Move camera:")]),e._v(" 1-finger drag or Left Mouse Button"),t("br"),t("b",[e._v("Pan:")]),e._v(" 2-finger drag or Right Mouse Button or "),t("kbd",[e._v("SHIFT")]),e._v("+ Left Mouse Button"),t("br"),t("b",[e._v("Zoom on object:")]),e._v(" Double-tap or Double-click on object"),t("br"),t("b",[e._v("Zoom out:")]),e._v(" Double-tap or Double-click on background"),t("br"),t("b",[e._v("Zoom:")]),e._v(" Pinch in/out or Mousewheel or "),t("kbd",[e._v("CTRL")]),e._v(" + Left Mouse Button"),t("br")]),t("div",{staticClass:"section rendering-shortcuts"},[t("span",{staticClass:"title"},[e._v("Rendering")]),t("b",[e._v("Wireframe: ")]),t("kbd",[e._v("5")]),t("br"),t("b",[e._v("Inspector: ")]),t("kbd",[e._v("i")]),t("br")]),t("div",{staticClass:"section inspector-shortcuts"},[t("span",{staticClass:"title"},[e._v("Inspector")]),t("b",[e._v("Render: ")]),t("kbd",[e._v("1")]),t("br"),t("b",[e._v("Materials: ")]),t("kbd",[e._v("2")]),t("br"),t("b",[e._v("Geometry: ")]),t("kbd",[e._v("3")]),t("br"),t("b",[e._v("UV: ")]),t("kbd",[e._v("4")]),t("br"),t("b",[e._v("Animation: ")]),t("kbd",[e._v("6")]),t("br")]),t("div",{staticClass:"section general-shortcuts"},[t("span",{staticClass:"title"},[e._v("General")]),t("b",[e._v("Fullscreen: ")]),t("kbd",[e._v("f")]),t("br")]),t("div",{staticClass:"section"},[t("span",{staticClass:"title"},[e._v("Lighting")]),t("b",[e._v("Rotate lighting:")]),e._v(" 3-finger drag or "),t("kbd",[e._v("ALT")]),e._v(" + Left Mouse Button"),t("br"),t("b",[e._v("Rotate env. only:")]),e._v(" "),t("kbd",[e._v("ALT")]),e._v(" + "),t("kbd",[e._v("SHIFT")]),e._v(" + Left Mouse Button"),t("br")]),t("div",{staticClass:"section annotation-shortcuts"},[t("span",{staticClass:"title"},[e._v("Annotations")]),t("b",[e._v("Previous: ")]),t("kbd",[e._v("j")]),e._v(" or "),t("kbd",[e._v("pageup")]),t("br"),t("b",[e._v("Next: ")]),t("kbd",[e._v("k")]),e._v(" or "),t("kbd",[e._v("pagedown")]),t("br")]),t("div",{staticClass:"section animation-shortcuts"},[t("span",{staticClass:"title"},[e._v("Animations")]),t("b",[e._v("Previous frame: ")]),t("kbd",[e._v("b")]),e._v(" or "),t("kbd",[e._v("ctrl+b")]),e._v(" or "),t("kbd",[e._v("shift+b")]),t("br"),t("b",[e._v("Next frame: ")]),t("kbd",[e._v("n")]),e._v(" or "),t("kbd",[e._v("ctrl+n")]),e._v(" or "),t("kbd",[e._v("shift+n")]),t("br"),t("b",[e._v("Go to time/frame: ")]),t("kbd",[e._v("enter")]),t("br"),t("b",[e._v("Play/Pause: ")]),t("kbd",[e._v("a")]),e._v(" or "),t("kbd",[e._v("ctrl+a")]),e._v(" or "),t("kbd",[e._v("shift+a")]),t("br")]),t("div",{staticClass:"section sound-shortcuts"},[t("span",{staticClass:"title"},[e._v("Sound")]),t("b",[e._v("Mute: ")]),t("kbd",[e._v("m")]),t("br")]),t("div",{staticClass:"section"},[t("span",{staticClass:"title"},[e._v("First-person navigation")]),t("b",[e._v("Move:")]),e._v(" "),t("kbd",[e._v("↑")]),e._v(","),t("kbd",[e._v("←")]),e._v(","),t("kbd",[e._v("↓")]),e._v(","),t("kbd",[e._v("→")]),e._v(" (or "),t("kbd",[e._v("W")]),e._v(","),t("kbd",[e._v("A")]),e._v(","),t("kbd",[e._v("S")]),e._v(","),t("kbd",[e._v("D")]),e._v(")"),t("br"),t("b",[e._v("Look around:")]),e._v(" 1-finger drag or Left Mouse Button"),t("br"),t("b",[e._v("Adjust speed:")]),e._v(" Mousewheel"),t("br")])])},function(){var e=this._self._c;return e("div",{staticClass:"action"},[e("button",{staticClass:"button"},[this._v("Reset camera view")])])},function(){var e=this._self._c;return e("p",{staticClass:"label_row"},[e("span",[this._v("背景")])])},function(){var e=this._self._c;return e("p",{staticClass:"label_row"},[e("span",[this._v("背景图片")])])}],!1,null,"20215a77",null).exports,l={name:"ModelEngine1",data(){return{model:null,animations:null,animationClips:null,mixer:null,animationMixer:null,actions:[],currentAction:{},animationClip:{},currentAnimateName:"",currentActionIndex:0,loopMode:"",animationMode:"repeat all"}},filters:{},watch:{},computed:{...(0,n.rn)({})},watch:{},methods:{playRepeatOne(){this.currentAction&&(alert(1),this.currentAction.setLoop(p.jAl,1),this.animationMode="repeat one",this.currentAction.play())},playRepeatAll(){this.currentAction&&(this.currentAction.setLoop(p.YKA,1/0),this.animationMode="repeat all")},playNoRepeat(){this.currentAction&&(this.currentAction.setLoop(p.jAl,1),this.currentAction.clampWhenFinished=!0,this.animationMode="no repeat")},setLoopMode(e){this.actions&&("repeat one"===e?(this.actions.forEach((e=>{e.setLoop(p.jAl,1)})),this.currentAction.setLoop(p.YKA),this.currentAction.play()):"repeat all"===e?(this.actions.forEach((e=>{e.setLoop(p.jAl,1)})),this.currentAction=this.actions[this.currentActionIndex],this.currentAction.setLoop(p.YKA),this.currentAction.play()):"no repeat"===e&&(this.actions.forEach((e=>{e.setLoop(p.jAl,1)})),this.currentAction=this.actions[this.currentActionIndex],this.currentAction.setLoop(p.jAl),this.currentAction.clampWhenFinished=!0,this.currentAction.play()))},onActionFinished2(){"repeat all"===this.animationMode?(this.currentActionIndex=(this.currentActionIndex+1)%this.animations.length,this.currentAction=At.clipAction(this.animations[this.currentActionIndex]),this.currentAction.play()):"no repeat"===this.animationMode&&this.currentActionIndex<this.animations.length-1&&(this.currentActionIndex++,this.currentAction=At.clipAction(this.animations[this.currentActionIndex]),this.currentAction.play())},onActionFinished(e){e.action._clip.name;e=(this.currentActionIndex+1)%this.animations.length;var t=this.actions[e];this.currentActionIndex>=this.animations.length-1?"repeat all"===this.loopMode?(this.currentAction.stop(),this.currentAction=this.actions[0],this.currentActionIndex=0,this.currentAction.play()):At.stopAllAction():(this.currentAction.stop(),this.currentAction=t,this.currentActionIndex=e,this.currentAction.play())}},updated(){},beforeDestroy(){},created(){},mounted(){this.website=Fi("",this.$store.state.app.edgeVal,{onModelLoaded:e=>{Et(this.model=e),_t(e),this.actions=At._actions,this.currentAction=this.actions[0],this.currentAnimateName=this.actions[0].getClip().name,this.mixer=At,this.animationMixer=At,this.animations=e.animations,this.animationClips=e.animations,this.animationClip=this.animations[0],this.animations.map((e=>At.clipAction(e))),this.loopMode="no repeat","repeat one"===this.loopMode?(this.actions.forEach((e=>{e.setLoop(p.YKA,1)})),this.actions[0].setLoop(p.YKA)):"repeat all"===this.loopMode?this.actions.forEach((e=>{e.setLoop(p.jAl)})):"no repeat"===this.loopMode&&this.actions.forEach((e=>{e.setLoop(p.jAl,1)})),this.currentAction=this.actions[0],this.currentAction.play(),At.addEventListener("finished",this.onActionFinished)}}),this.website.addEventListener("getmodel",(e=>{}))}},(0,a.Z)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"viewer"},[t("div",[t("button",{on:{click:function(e){}}},[e._v("Repeat One1")]),t("button",{on:{click:function(t){return e.setLoopMode("repeat all")}}},[e._v("Repeat All1")]),t("button",{on:{click:function(t){return e.setLoopMode("no repeat")}}},[e._v("No Repeat1")])]),t("div",[t("button",{on:{click:e.playRepeatOne}},[e._v("Repeat One")]),t("button",{on:{click:e.playRepeatAll}},[e._v("Repeat All")]),t("button",{on:{click:e.playNoRepeat}},[e._v("No Repeat")])]),t("div",{staticClass:"model-wrapper",attrs:{id:"model-wrapper"}},[t("div",{attrs:{id:"view2"}}),e._m(0),t("div",{ref:"main_viewer",staticClass:"main_viewer model-loaded has-model has-animation",attrs:{id:"main_viewer"}})])])}),[function(){var e=this._self._c;return e("div",{staticClass:"main-progress-wrapper"},[e("div",{staticClass:"main-progress-percentage loading-percentage"},[this._v("100%")]),e("p",[this._v("Loading 3D model")]),e("div",{staticClass:"main-progress-display"},[e("div",{staticClass:"main-progress-display__progress"})])])}],!1,null,"e94acb6c",null).exports;const Oi=[d];function Pi(e){Oi.forEach((t=>{e.component(t.name,t)}))}"undefined"!=typeof window&&window.Vue&&Pi(window.Vue),n={install:Pi},s.default.config.productionTip=!1,s.default.use(n),s.default.use(h()),new s.default({store:u,render:e=>e(o)}).$mount("#app")},6912:function(e){var t=new ArrayBuffer(950);new Uint8Array(t).set([0,97,115,109,1,0,0,0,1,165,128,128,128,0,7,96,0,1,127,96,1,127,0,96,0,0,96,1,127,1,127,96,2,125,125,1,125,96,3,127,127,127,1,127,96,3,127,126,127,1,126,3,150,128,128,128,0,21,2,0,4,2,0,0,0,0,0,1,3,0,1,0,1,1,0,2,3,1,3,4,133,128,128,128,0,1,112,1,1,1,5,134,128,128,128,0,1,1,128,2,128,2,6,151,128,128,128,0,4,127,1,65,128,128,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,7,163,130,128,128,0,15,6,109,101,109,111,114,121,2,0,17,95,95,119,97,115,109,95,99,97,108,108,95,99,116,111,114,115,0,0,18,115,104,111,119,95,109,101,95,116,104,101,95,97,110,115,119,101,114,0,1,3,97,100,100,0,2,25,95,95,105,110,100,105,114,101,99,116,95,102,117,110,99,116,105,111,110,95,116,97,98,108,101,1,0,16,95,95,101,114,114,110,111,95,108,111,99,97,116,105,111,110,0,7,6,102,102,108,117,115,104,0,20,21,101,109,115,99,114,105,112,116,101,110,95,115,116,97,99,107,95,105,110,105,116,0,3,25,101,109,115,99,114,105,112,116,101,110,95,115,116,97,99,107,95,103,101,116,95,102,114,101,101,0,4,25,101,109,115,99,114,105,112,116,101,110,95,115,116,97,99,107,95,103,101,116,95,98,97,115,101,0,5,24,101,109,115,99,114,105,112,116,101,110,95,115,116,97,99,107,95,103,101,116,95,101,110,100,0,6,9,115,116,97,99,107,83,97,118,101,0,8,12,115,116,97,99,107,82,101,115,116,111,114,101,0,9,10,115,116,97,99,107,65,108,108,111,99,0,10,28,101,109,115,99,114,105,112,116,101,110,95,115,116,97,99,107,95,103,101,116,95,99,117,114,114,101,110,116,0,11,10,132,132,128,128,0,21,4,0,16,3,11,11,1,1,127,65,42,33,0,32,0,15,11,59,2,3,127,3,125,35,0,33,2,65,16,33,3,32,2,32,3,107,33,4,32,4,32,0,56,2,12,32,4,32,1,56,2,8,32,4,42,2,12,33,5,32,4,42,2,8,33,6,32,5,32,6,146,33,7,32,7,15,11,18,0,65,128,128,4,36,2,65,0,65,15,106,65,112,113,36,1,11,7,0,35,0,35,1,107,11,4,0,35,2,11,4,0,35,1,11,6,0,65,128,128,4,11,4,0,35,0,11,6,0,32,0,36,0,11,18,1,2,127,35,0,32,0,107,65,112,113,34,1,36,0,32,1,11,4,0,35,0,11,6,0,32,0,36,3,11,4,0,35,3,11,2,0,11,2,0,11,12,0,65,132,128,4,16,14,65,136,128,4,11,8,0,65,132,128,4,16,15,11,4,0,65,1,11,2,0,11,180,2,1,3,127,2,64,32,0,13,0,65,0,33,1,2,64,65,0,40,2,140,128,4,69,13,0,65,0,40,2,140,128,4,16,20,33,1,11,2,64,65,0,40,2,140,128,4,69,13,0,65,0,40,2,140,128,4,16,20,32,1,114,33,1,11,2,64,16,16,40,2,0,34,0,69,13,0,3,64,65,0,33,2,2,64,32,0,40,2,76,65,0,72,13,0,32,0,16,18,33,2,11,2,64,32,0,40,2,20,32,0,40,2,28,70,13,0,32,0,16,20,32,1,114,33,1,11,2,64,32,2,69,13,0,32,0,16,19,11,32,0,40,2,56,34,0,13,0,11,11,16,17,32,1,15,11,65,0,33,2,2,64,32,0,40,2,76,65,0,72,13,0,32,0,16,18,33,2,11,2,64,2,64,2,64,32,0,40,2,20,32,0,40,2,28,70,13,0,32,0,65,0,65,0,32,0,40,2,36,17,5,0,26,32,0,40,2,20,13,0,65,127,33,1,32,2,13,1,12,2,11,2,64,32,0,40,2,4,34,1,32,0,40,2,8,34,3,70,13,0,32,0,32,1,32,3,107,172,65,1,32,0,40,2,40,17,6,0,26,11,65,0,33,1,32,0,65,0,54,2,28,32,0,66,0,55,3,16,32,0,66,0,55,2,4,32,2,69,13,1,11,32,0,16,19,11,32,1,11]);const{instantiate:i,Memory:s,Table:n}=WebAssembly;e.exports=function(e={global:{},env:{memory:new s({initial:10,limit:100}),table:new n({initial:0,element:"anyfunc"})}}){return i(t,e)}}},r={};function a(e){var t=r[e];return void 0!==t||(t=r[e]={id:e,loaded:!1,exports:{}},n[e].call(t.exports,t,t.exports,a),t.loaded=!0),t.exports}function o(e,t){var i,n,r,o=t[0],l=t[1],h=t[2],c=0;if(o.some((function(e){return 0!==s[e]}))){for(i in l)a.o(l,i)&&(a.m[i]=l[i]);h&&(r=h(a))}for(e&&e(t);c<o.length;c++)n=o[c],a.o(s,n)&&s[n]&&s[n][0](),s[n]=0;return a.O(r)}a.m=n,a.amdO={},e=[],a.O=function(t,i,s,n){if(!i){for(var r=1/0,o=0;o<e.length;o++){i=e[o][0],s=e[o][1],n=e[o][2];for(var l,h=!0,c=0;c<i.length;c++)(!1&n||n<=r)&&Object.keys(a.O).every((function(e){return a.O[e](i[c])}))?i.splice(c--,1):(h=!1,n<r&&(r=n));h&&(e.splice(o--,1),void 0!==(l=s()))&&(t=l)}return t}n=n||0;for(o=e.length;0<o&&e[o-1][2]>n;o--)e[o]=e[o-1];e[o]=[i,s,n]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,i){return a.f[i](e,t),t}),[]))},a.u=function(e){return"static/js/"+e+"."+{24:"cdad9de6",38:"4b28925b",225:"3b35c174",349:"81c8f4e3",375:"7ba096a4",383:"98f0724f",413:"88b78d50",433:"a8600e4c",449:"421c0b54",508:"ab2a80e4",539:"22ba1bc1",651:"99c52a00",669:"86171ced",744:"85721a2e",812:"fa16323a",907:"ba5be496",946:"f51f41a0",949:"412773bc",974:"e6bab01f"}[e]+".js"},a.miniCssF=function(e){},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(o){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t={},i="three-model-viewer:",a.l=function(e,s,n,r){if(t[e])t[e].push(s);else{var o,l;if(void 0!==n)for(var h=document.getElementsByTagName("script"),c=0;c<h.length;c++){var d=h[c];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+n){o=d;break}}function u(i,s){o.onerror=o.onload=null,clearTimeout(m);var n=t[e];if(delete t[e],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((function(e){return e(s)})),i)return i(s)}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",i+n),o.src=e),t[e]=[s];var m=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),l&&document.head.appendChild(o)}},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},a.p="",s={826:0},a.f.j=function(e,t){var i,n,r=a.o(s,e)?s[e]:void 0;0!==r&&(r?t.push(r[2]):(i=new Promise((function(t,i){r=s[e]=[t,i]})),t.push(r[2]=i),t=a.p+a.u(e),n=new Error,a.l(t,(function(t){var i;a.o(s,e)&&(0!==(r=s[e])&&(s[e]=void 0),r)&&(i=t&&("load"===t.type?"missing":t.type),t=t&&t.target&&t.target.src,n.message="Loading chunk "+e+" failed.\n("+i+": "+t+")",n.name="ChunkLoadError",n.type=i,n.request=t,r[1](n))}),"chunk-"+e,e)))},a.O.j=function(e){return 0===s[e]},(l=self.webpackChunkthree_model_viewer=self.webpackChunkthree_model_viewer||[]).forEach(o.bind(null,0)),l.push=o.bind(null,l.push.bind(l));var l=a.O(void 0,[998],(function(){return a(2503)}));a.O(l)}();