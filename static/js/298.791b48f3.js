"use strict";(self["webpackChunkthree_model_viewer"]=self["webpackChunkthree_model_viewer"]||[]).push([[298],{298:function(e,t,n){n.r(t),n.d(t,{STLLoader:function(){return o}});var r=n(277);class o extends r.aNw{constructor(e){super(e)}load(e,t,n,o){const s=this,a=new r.hH6(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(s.parse(n))}catch(r){o?o(r):console.error(r),s.manager.itemError(e)}}),n,o)}parse(e){function t(e){const t=new DataView(e),r=50,o=t.getUint32(80,!0),s=84+o*r;if(s===t.byteLength)return!0;const a=[115,111,108,105,100];for(let i=0;i<5;i++)if(n(a,t,i))return!1;return!0}function n(e,t,n){for(let r=0,o=e.length;r<o;r++)if(e[r]!==t.getUint8(n+r))return!1;return!0}function o(e){const t=new DataView(e),n=t.getUint32(80,!0);let o,s,a,i,l,c,u,h,g=!1;for(let r=0;r<70;r++)1129270351==t.getUint32(r,!1)&&82==t.getUint8(r+4)&&61==t.getUint8(r+5)&&(g=!0,i=new Float32Array(3*n*3),l=t.getUint8(r+6)/255,c=t.getUint8(r+7)/255,u=t.getUint8(r+8)/255,h=t.getUint8(r+9)/255);const f=84,w=50,p=new r.u9r,d=new Float32Array(3*n*3),F=new Float32Array(3*n*3);for(let r=0;r<n;r++){const e=f+r*w,n=t.getFloat32(e,!0),h=t.getFloat32(e+4,!0),p=t.getFloat32(e+8,!0);if(g){const n=t.getUint16(e+48,!0);0===(32768&n)?(o=(31&n)/31,s=(n>>5&31)/31,a=(n>>10&31)/31):(o=l,s=c,a=u)}for(let l=1;l<=3;l++){const c=e+12*l,u=3*r*3+3*(l-1);d[u]=t.getFloat32(c,!0),d[u+1]=t.getFloat32(c+4,!0),d[u+2]=t.getFloat32(c+8,!0),F[u]=n,F[u+1]=h,F[u+2]=p,g&&(i[u]=o,i[u+1]=s,i[u+2]=a)}}return p.setAttribute("position",new r.TlE(d,3)),p.setAttribute("normal",new r.TlE(F,3)),g&&(p.setAttribute("color",new r.TlE(i,3)),p.hasColors=!0,p.alpha=h),p}function s(e){const t=new r.u9r,n=/solid([\s\S]*?)endsolid/g,o=/facet([\s\S]*?)endfacet/g;let s=0;const a=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,i=new RegExp("vertex"+a+a+a,"g"),l=new RegExp("normal"+a+a+a,"g"),c=[],u=[],h=new r.Pa4;let g,f=0,w=0,p=0;while(null!==(g=n.exec(e))){w=p;const e=g[0];while(null!==(g=o.exec(e))){let e=0,t=0;const n=g[0];while(null!==(g=l.exec(n)))h.x=parseFloat(g[1]),h.y=parseFloat(g[2]),h.z=parseFloat(g[3]),t++;while(null!==(g=i.exec(n)))c.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3])),u.push(h.x,h.y,h.z),e++,p++;1!==t&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+s),3!==e&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+s),s++}const n=w,r=p-w;t.addGroup(n,r,f),f++}return t.setAttribute("position",new r.a$l(c,3)),t.setAttribute("normal",new r.a$l(u,3)),t}function a(e){return"string"!==typeof e?r.Zp0.decodeText(new Uint8Array(e)):e}function i(e){if("string"===typeof e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer||t}return e}const l=i(e);return t(l)?o(l):s(a(e))}}}}]);
//# sourceMappingURL=298.791b48f3.js.map