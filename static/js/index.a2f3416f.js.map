{"version":3,"file":"static/js/index.a2f3416f.js","mappings":"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","sources":["webpack://three-model-viewer/./examples/App.vue?e5fe","webpack://three-model-viewer/examples/App.vue","webpack://three-model-viewer/./examples/App.vue?a484","webpack://three-model-viewer/./examples/App.vue","webpack://three-model-viewer/./examples/store/getters.js","webpack://three-model-viewer/./examples/store/modules/app.js","webpack://three-model-viewer/./examples/store/modules/measure.js","webpack://three-model-viewer/./examples/store/index.js","webpack://three-model-viewer/./packages/modelEngine.vue?5a33","webpack://three-model-viewer/./packages/engine/geometry/coor2d.js","webpack://three-model-viewer/./packages/viewer/domutils.js","webpack://three-model-viewer/./packages/engine/geometry/coord3d.js","webpack://three-model-viewer/./packages/viewer/camera.js","webpack://three-model-viewer/./packages/engine/geometry/geometry.js","webpack://three-model-viewer/./packages/viewer/viewergeometry.js","webpack://three-model-viewer/./packages/engine/geometry/tween.js","webpack://three-model-viewer/./packages/viewer/navigation.js","webpack://three-model-viewer/./packages/engine/threejs/threeutils.js","webpack://three-model-viewer/./packages/viewer/shadingmodel.js","webpack://three-model-viewer/./packages/modelTool/blastTool.js","webpack://three-model-viewer/./packages/utils/EventDispatcher/EventDispatcher.js","webpack://three-model-viewer/./packages/modelTool/outlineobj.js","webpack://three-model-viewer/./packages/viewer/viewer.js","webpack://three-model-viewer/./packages/engine/parameters/parameterlist.js","webpack://three-model-viewer/./packages/website/hashhandler.js","webpack://three-model-viewer/./packages/engine/io/fileutils.js","webpack://three-model-viewer/./packages/website/eventhandler.js","webpack://three-model-viewer/./packages/engine/core/taskrunner.js","webpack://three-model-viewer/./packages/engine/import/importerfiles.js","webpack://three-model-viewer/./packages/engine/import/importerbase.js","webpack://three-model-viewer/./packages/engine/import/importerobj.js","webpack://three-model-viewer/./packages/engine/import/importer.js","webpack://three-model-viewer/./packages/engine/threejs/threemodelloader.js","webpack://three-model-viewer/./packages/website/threemodelloaderui.js","webpack://three-model-viewer/./packages/loader/LoaderUtils.js","webpack://three-model-viewer/./packages/engine/io/bufferutils.js","webpack://three-model-viewer/./packages/loader/DragLoader.js","webpack://three-model-viewer/./packages/engine/io/externallibs.js","webpack://three-model-viewer/./packages/loader/Loader.js","webpack://three-model-viewer/./packages/website/utils.js","webpack://three-model-viewer/./packages/engine/model/color.js","webpack://three-model-viewer/./packages/modelTool/modelTool.js","webpack://three-model-viewer/./packages/modelTool/wireframe.js","webpack://three-model-viewer/./packages/website/settings.js","webpack://three-model-viewer/./packages/website/themehandler.js","webpack://three-model-viewer/./packages/website/measuretool.js","webpack://three-model-viewer/./packages/website/website.js","webpack://three-model-viewer/./packages/website/index.js","webpack://three-model-viewer/./packages/modelTool/fullScreen.js","webpack://three-model-viewer/./src/store/index.js","webpack://three-model-viewer/packages/modelEngine.vue","webpack://three-model-viewer/./packages/modelEngine.vue?0b2e","webpack://three-model-viewer/./packages/modelEngine.vue","webpack://three-model-viewer/./packages/index.js","webpack://three-model-viewer/./examples/main.js","webpack://three-model-viewer/webpack/bootstrap","webpack://three-model-viewer/webpack/runtime/chunk loaded","webpack://three-model-viewer/webpack/runtime/compat get default export","webpack://three-model-viewer/webpack/runtime/define property getters","webpack://three-model-viewer/webpack/runtime/ensure chunk","webpack://three-model-viewer/webpack/runtime/get javascript chunk filename","webpack://three-model-viewer/webpack/runtime/get mini-css chunk filename","webpack://three-model-viewer/webpack/runtime/global","webpack://three-model-viewer/webpack/runtime/hasOwnProperty shorthand","webpack://three-model-viewer/webpack/runtime/load script","webpack://three-model-viewer/webpack/runtime/make namespace object","webpack://three-model-viewer/webpack/runtime/node module decorator","webpack://three-model-viewer/webpack/runtime/publicPath","webpack://three-model-viewer/webpack/runtime/jsonp chunk loading","webpack://three-model-viewer/webpack/startup"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{staticClass:\"content\"},[_c('model-engine',{attrs:{\"width\":_vm.width,\"height\":_vm.height}})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"app\">\n    <!-- <div class=\"wrapper\">\n      <div class=\"box1\"></div>\n      <div class=\"box2\"></div>\n      <div class=\"box3\"></div>\n      <div class=\"box4\"></div>\n      <div class=\"box5\"></div>\n    </div> -->\n\n    <!-- <img alt=\"Vue logo\" src=\"./assets/logo.png\"> -->\n    <!-- <HelloWorld msg=\"Welcome to Your Vue.js App\"/> -->\n    <div class=\"content\">\n      <model-engine :width=\"width\" :height=\"height\"></model-engine>\n    </div>\n    <!-- <div class=\"content\"><model-engine></model-engine></div> -->\n    <!-- <model-engine></model-engine> -->\n    <!-- <div class=\"test\">\n      <button @click=\"test\">button</button>\n    </div> -->\n  </div>\n</template>\n\n<script>\n// import HelloWorld from './components/HelloWorld.vue'\n\nexport default {\n  name: 'App',\n  components: {\n    // HelloWorld\n  },\n  data(){\n    return {\n      width:'800',\n      height:'800'\n    }\n  },\n  methods:{\n    test(){\n    alert(1)\n  }\n  }\n}\n</script>\n\n<style>\n* {\n  padding: 0;\n  margin: 0;\n}\n\nbody {\n  height: 100%;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-font-smoothing: antialiased;\n  text-rendering: optimizeLegibility;\n  font-family: Helvetica Neue, Helvetica, PingFang SC, Hiragino Sans GB, Microsoft YaHei, Arial, sans-serif;\n\n}\n\nhtml {\n  height: 100%;\n  /* //  content-box：padding和border不被包含在定义的width和height之内。 默认值\n  // 盒子的实际宽度=设置的width+padding+border\n  // border-box：padding和border被包含在定义的width和height之内。\n  // 盒子的实际宽度=设置的width（padding和border不会影响实际宽度） */\n  box-sizing: border-box;\n\n}\n\n#app {\n  /* font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px; */\n\n}\n\n\n\n.test {\n\n  width: 100%;\n  height: 300px;\n  padding-top: 100px;\n\n}\n\n.content {\n  /* border: px solid red; */\n  /* width: 400px;\n  height: 400px; */\n  width: 100%;\n  height: 100vh;\n  overflow: hidden;\n}\n</style>\n\n<style lang=\"less\">\n// .wrapper div {\n//   height: 1rem;\n// }\n\n// .box1 {\n//   // width: 2rem;  px to rem  转换\n//   width: 75px;\n//   background-color: coral;\n// }\n\n// .box2 {\n//   width: 4rem;\n//   background-color: skyblue;\n// }\n\n// .box3 {\n//   width: 6rem;\n//   background-color: palegreen;\n// }\n\n// .box4 {\n//   width: 8rem;\n//   background-color: wheat;\n// }\n\n// .box5 {\n//   width: 10rem;\n//   background-color: darkred;\n// }\n</style>","import mod from \"-!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=74c2758b&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=74c2758b&prod&lang=css&\"\nimport style1 from \"./App.vue?vue&type=style&index=1&id=74c2758b&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","const getters = {\r\n  showLoading: state => state.showLoading, // loading\r\n  getBlastVal:state=>state.blastVal, //爆炸\r\n\r\n    // measure\r\n    isActive:state=>state.isActive,\r\n    info: state => state.measure.info,\r\n    pointsDistance: state => state.measure.pointsDistance,\r\n    parallelFacesDistance: state => state.measure.parallelFacesDistance,\r\n    facesAngle: state => state.measure.facesAngle\r\n}\r\nexport default getters","const state = {\r\n  showLoading: false, // loading状态\r\n  blastVal:1, //TODO 如何一开始执行 10\r\n  duxian:false,\r\n  edgeVal:100\r\n}\r\nconst mutations = {\r\n  // 独显全显控制\r\n  DUXIAN(state,val){\r\n     state.duxian= val\r\n  },\r\n  // loading\r\n  SHOW_LOADING (state, val) {\r\n    state.showLoading = false\r\n  },\r\n  // 爆炸\r\n  CHANGE_BLASTVAL(state, val){\r\n     state.blastVal = val\r\n  },\r\n  RESET_BLASTVAL(state){\r\n    state.blastVal = 1\r\n  },\r\n  // edge\r\n\r\n  CHANGE_EDGE_VAL(state,val){\r\n     state.edgeVal = val\r\n  }\r\n}\r\nconst actions = {\r\n  showLoading ({ commit }, val) {\r\n    commit('SHOW_LOADING', false)\r\n  },\r\n changBlastVal({ commit }, val){\r\n  commit('CHANGE_BLASTVAL', val)\r\n },\r\n resetBlastVal({ commit }, val){\r\n  commit('RESET_BLASTVAL', val)\r\n }\r\n}\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n","\r\nconst state = {\r\n  info: '无',\r\n  pointsDistance: 0,\r\n  parallelFacesDistance: 0,\r\n  facesAngle: 0,\r\n  isActive:false,\r\n  showMeasureIInfo:false\r\n\r\n}\r\n// 同步修改\r\nconst mutations = {\r\n  ShowMeasureInfo(state,val){\r\n     state.showMeasureIInfo = val\r\n  },\r\n  IsActive(state,val){\r\n    state.isActive = val\r\n  },\r\n  // 信息\r\n  AddInfo (state, val) {\r\n    state.info = val\r\n  },\r\n  // 点距离\r\n  AddPointsDistance (state, val) {\r\n    state.pointsDistance = val\r\n  },\r\n  // 面距离\r\n  AddDistanceParallel (state, val) {\r\n    state.parallelFacesDistance = val\r\n  },\r\n  // 角度\r\n  AddAngel (state, val) {\r\n    state.facesAngle = val\r\n  },\r\n  // 重置\r\n  Reset () {\r\n \r\n    state.pointsDistance = 0\r\n    state.parallelFacesDistance = 0\r\n    state.facesAngle = 0\r\n    state.showMeasureIInfo = false\r\n  }\r\n\r\n}\r\n// 不涉及异步请求 https://blog.csdn.net/nnmmbb/article/details/126540391\r\n// https://blog.csdn.net/wwwkm123/article/details/110926595?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-9-110926595-blog-126540391.pc_relevant_3mothn_strategy_recovery&spm=1001.2101.3001.4242.6&utm_relevant_index=12\r\nconst actions = {\r\n  // AddDistance ({ commit }, val) {\r\n\r\n  // },\r\n  // AddDistanceParallel () {\r\n\r\n  // },\r\n  // AddAngel () {\r\n\r\n  // }\r\n\r\n\r\n}\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n","import Vue from 'vue'\nimport Vuex from 'vuex'\nimport getters from './getters'\nimport app from './modules/app'\nimport measure from './modules/measure'\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  // state: {\n   \n  // },\n  // getters: {\n   \n  // },\n  // mutations: {\n\n    \n  // },\n  // actions: {\n  \n  // },\n  modules: {\n    app,\n    measure\n  },\n  getters\n})\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"viewer\"},[_c('div',{staticClass:\"model-wrapper\",attrs:{\"id\":\"model-wrapper\"}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.showLoading),expression:\"showLoading\"}],staticClass:\"main_viewer\",attrs:{\"id\":\"main_viewer\",\"element-loading-text\":\"拼命加载中\",\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0.8)\"}}),_c('div',{staticClass:\"side_menu_wrap\",class:[_vm.isActive ? 'left0' : 'left200']},[_c('div',{staticClass:\"side-menu\"},[_vm._m(0),_c('div',{staticClass:\"btns\"},_vm._l((_vm.btns),function(item,index){return _c('span',{key:index,class:[_vm.tabIndex == index ? 'active' : ''],on:{\"click\":function($event){return _vm.backgroundTabClick(index)}}},[_vm._v(_vm._s(item))])}),0),_vm._m(1),_c('div',{staticClass:\"envMaps\"},_vm._l((_vm.envMaps),function(item,index){return _c('el-image',{key:index,staticClass:\"img\",staticStyle:{\"width\":\"45px\",\"height\":\"45px\"},attrs:{\"src\":item.url},on:{\"click\":function($event){return _vm.SetEnvironment(item.name, item.backgroundIsEnvMap)}}})}),1),_vm._m(2),_c('div',{staticClass:\"blast-slider\"},[_c('el-slider',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showSlider),expression:\"showSlider\"}],attrs:{\"min\":0,\"max\":100},on:{\"change\":_vm.edgeChange},model:{value:(_vm.edgeVal),callback:function ($$v) {_vm.edgeVal=$$v},expression:\"edgeVal\"}})],1),_vm._m(3),_c('div',{staticClass:\"blast-slider\"},[_c('el-slider',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showSlider),expression:\"showSlider\"}],attrs:{\"min\":1,\"max\":100},on:{\"change\":_vm.blastChange},model:{value:(_vm.blastVal),callback:function ($$v) {_vm.blastVal=$$v},expression:\"blastVal\"}})],1),_c('el-row',{staticClass:\"row\"},[_c('span',[_vm._v(\"显示网格\")]),_c('el-switch',{attrs:{\"active-color\":\"#13ce66\",\"inactive-color\":\"#ff4949\"},on:{\"change\":_vm.changeWange},model:{value:(_vm.wanggeValue),callback:function ($$v) {_vm.wanggeValue=$$v},expression:\"wanggeValue\"}})],1),_c('el-row',{staticClass:\"row\"},[_c('span',[_vm._v(\"自动旋转\")]),_c('el-switch',{attrs:{\"active-color\":\"#13ce66\",\"inactive-color\":\"#ff4949\"},on:{\"change\":_vm.autoRotation},model:{value:(_vm.rotationValue),callback:function ($$v) {_vm.rotationValue=$$v},expression:\"rotationValue\"}})],1),_vm._m(4),_c('div',{staticClass:\"items\"},[_c('span',{class:[_vm.ifduxian ? 'active' : ''],on:{\"click\":_vm.duxian}},[_c('i',{staticClass:\"icon iconfont\",class:[_vm.ifduxian ? 'icon-quanbu' : 'icon-yanjing']}),_c('b',[_vm._v(_vm._s(_vm.ifduxian? '全显': '独显'))])]),_c('span',{class:[_vm.dragMeshBtn ? 'active' : ''],on:{\"click\":_vm.dragMesh}},[_c('i',{staticClass:\"icon iconfont icon-yidong\"}),_c('b',[_vm._v(\"移动\")])]),_c('span',{on:{\"click\":_vm.reset}},[_c('i',{staticClass:\"icon iconfont icon-ic_fuwei\"}),_c('b',[_vm._v(\"重置\")])]),_c('span',{class:[_vm.MeasureisActive ? 'active' : ''],on:{\"click\":_vm.celiang}},[_c('i',{staticClass:\"icon iconfont icon-chizi\"}),_c('b',[_vm._v(\"测量\")])]),_c('span',{on:{\"click\":_vm.yincang}},[_c('i',{staticClass:\"icon iconfont icon-yincang\"}),_c('b',[_vm._v(\"隐藏\")])]),_c('span',{on:{\"click\":_vm.touming2}},[_c('i',{staticClass:\"icon iconfont icon-toumingdutiaojie\"}),_c('b',[_vm._v(\"透明\")])])])],1),_c('div',{staticClass:\"switch\",on:{\"click\":_vm.switchleft}},[_c('i',{staticClass:\"icon iconfont\",class:[_vm.isActive ? 'icon-zuojiantou-copy ' : 'icon-zuojiantou']})])]),_c('div',{staticClass:\"full-sceen\",on:{\"click\":_vm.fullScreen}},[_c('i',{staticClass:\"icon iconfont\",class:[_vm.fullScreenBtn ? 'icon-quanping' : 'icon-quxiaoquanping'],staticStyle:{\"font-size\":\"26px\"}})]),(_vm.MeasureisActive)?_c('div',{staticClass:\"measureInfo\"},[(!_vm.showMeasureIInfo)?_c('div',[_c('span',[_vm._v(\" \"+_vm._s(_vm.info))])]):_c('div',[_c('span',[_c('i',{staticClass:\"icon iconfont icon-guanxianchangdu\"}),_c('b',[_vm._v(_vm._s(_vm.pointsDistance))])]),_c('span',[_c('i',{staticClass:\"icon iconfont icon-jiaodu\"}),_c('b',[_vm._v(_vm._s(_vm.facesAngle))])])])]):_vm._e()])])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('p',{staticClass:\"label_row\"},[_c('span',[_vm._v(\"背景\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',{staticClass:\"label_row\"},[_c('span',[_vm._v(\"背景图片\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',{staticClass:\"label_row\"},[_c('span',[_vm._v(\"Edges\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',{staticClass:\"label_row\"},[_c('span',[_vm._v(\"模型拆分\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',{staticClass:\"label_row\"},[_c('span',[_vm._v(\"模型操作\")])])\n}]\n\nexport { render, staticRenderFns }","export class Coord2D {\r\n  constructor (x, y) {\r\n    this.x = x\r\n    this.y = y\r\n  }\r\n\r\n  Clone () {\r\n    return new Coord2D(this.x, this.y)\r\n  }\r\n}\r\n// 两点之间距离\r\nexport function SubCoord2D (a, b) {\r\n  return new Coord2D(a.x - b.x, a.y - b.y)\r\n}\r\n","import { Coord2D } from '../engine/geometry/coor2d.js'\r\n// 整数处理\r\nexport function GetIntegerFromStyle (parameter) {\r\n  return Math.round(parseFloat(parameter))\r\n}\r\n\r\n// 是否显示dom\r\nexport function ShowDomElement (element, show) {\r\n  if (show) {\r\n    element.style.display = 'block'\r\n  } else {\r\n    element.style.display = 'none'\r\n  }\r\n}\r\n\r\n// 获取dom宽\r\nexport function GetDomElementOuterWidth (element) {\r\n  let style = getComputedStyle(element)\r\n  console.log(GetIntegerFromStyle(style.borderWidth), ' style.borderWidth')// 1\r\n  console.log(style.marginRight, 'style.marginRight')\r\n  console.log(element.offsetWidth, 'element.offsetWidth')\r\n\r\n  // offset =  content+padding+border\r\n  return element.offsetWidth + GetIntegerFromStyle(style.marginLeft) + GetIntegerFromStyle(style.marginRight)\r\n}\r\n// 设置高 px\r\nexport function SetDomElementHeight (element, height) {\r\n  element.style.height = `${height.toString()}px`\r\n}\r\n// 获取额外的高 margin padding border\r\nexport function GetDomElementExternalHeight (style) {\r\n  let padding = GetIntegerFromStyle(style.paddingTop) + GetIntegerFromStyle(style.paddingBottom)\r\n  let border = GetIntegerFromStyle(style.borderTopWidth) + GetIntegerFromStyle(style.borderBottomWidth)\r\n  let margin = GetIntegerFromStyle(style.marginTop) + GetIntegerFromStyle(style.marginBottom)\r\n  return padding + border + margin\r\n}\r\n// 设置高\r\nexport function SetDomElementOuterHeight (element, height) {\r\n  let style = getComputedStyle(element)\r\n  SetDomElementHeight(element, height - GetDomElementExternalHeight(style))\r\n}\r\n\r\n// 设置宽 px\r\nexport function SetDomElementWidth (element, width) {\r\n  element.style.width = `${width.toString()}px`\r\n}\r\n// 获取额外的宽值\r\nexport function GetDomElementExternalWidth (style) {\r\n  let padding = GetIntegerFromStyle(style.paddingLeft) + GetIntegerFromStyle(style.paddingRight)\r\n  let border = GetIntegerFromStyle(style.borderLeftWidth) + GetIntegerFromStyle(style.borderRightWidth)\r\n  let margin = GetIntegerFromStyle(style.marginLeft) + GetIntegerFromStyle(style.marginRight)\r\n  return padding + border + margin\r\n}\r\n// 设置宽\r\nexport function SetDomElementOuterWidth (element, width) {\r\n  let style = getComputedStyle(element)\r\n  SetDomElementWidth(element, width - GetDomElementExternalWidth(style))\r\n}\r\n// 获取元素的宽高\r\nexport function GetDomElementInnerDimensions (element, outerWidth, outerHeight) {\r\n  let style = getComputedStyle(element)\r\n  let width = outerWidth - GetDomElementExternalWidth(style)\r\n  let height = outerHeight - GetDomElementExternalHeight(style)\r\n  return {\r\n    width,\r\n    height\r\n  }\r\n}\r\n// 创建元素\r\nexport function CreateDomElement (elementType, className, innerHTML) {\r\n  let element = document.createElement(elementType)\r\n  if (className) {\r\n    element.className = className\r\n  }\r\n  if (innerHTML) {\r\n    element.innerHTML = innerHTML\r\n  }\r\n  return element\r\n}\r\n// 往一个元素中添加另一个元素\r\nexport function AddDomElement (parentElement, elementType, className, innerHTML) {\r\n  let element = CreateDomElement(elementType, className, innerHTML)\r\n  parentElement.appendChild(element)\r\n  return element\r\n}\r\n\r\nexport function IsDomElementVisible (element) {\r\n  return element.offsetParent !== null\r\n}\r\n// 获得鼠标点击位置\r\nexport function GetDomElementClientCoordinates (element, clientX, clientY) {\r\n  if (element.getBoundingClientRect) {\r\n    // getBoundingClientRect()用于获得页面中某个元素的左，上，右和下分别相对浏览器视窗的位置。\r\n    let clientRect = element.getBoundingClientRect()\r\n    // console.log(clientRect, 'clientRect')\r\n    clientX -= clientRect.left\r\n    clientY -= clientRect.top\r\n  }\r\n  if (window.pageXOffset && window.pageYOffset) {\r\n    clientX += window.pageXOffset\r\n    clientY += window.pageYOffset\r\n  }\r\n  return (new Coord2D(clientX, clientY))\r\n}\r\n\r\n\r\n// 创建div\r\nexport function CreateDiv (className, innerHTML)\r\n{\r\n    return CreateDomElement ('div', className, innerHTML);\r\n}\r\n// 添加div子元素\r\nexport function AddDiv (parentElement, className, innerHTML)\r\n{\r\n    return AddDomElement (parentElement, 'div', className, innerHTML);\r\n}\r\n\r\n// 删除dom\r\nexport function ClearDomElement (element)\r\n{\r\n    while (element.firstChild) {\r\n        element.removeChild (element.firstChild);\r\n    }\r\n}","export class Coord3D {\r\n  constructor (x, y, z) {\r\n    this.x = x\r\n    this.y = y\r\n    this.z = z\r\n  }\r\n\r\n  Clone () {\r\n    return new Coord3D(this.x, this.y, this.z)\r\n  }\r\n\r\n  //  长度\r\n  Length () {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)\r\n  }\r\n\r\n  //  缩放\r\n \tMultiplyScalar (scalar) {\r\n    this.x *= scalar\r\n    this.y *= scalar\r\n    this.z *= scalar\r\n    return this\r\n  }\r\n\r\n  Normalize () {\r\n    let length = this.Length()\r\n    if (length > 0.0) {\r\n      this.MultiplyScalar(1.0 / length)\r\n    }\r\n    return this\r\n  }\r\n\r\n  Offset (direction, distance) {\r\n    let normal = direction.Clone().Normalize()\r\n    this.x += normal.x * distance\r\n    this.y += normal.y * distance\r\n    this.z += normal.z * distance\r\n    return this\r\n  }\r\n}\r\n\r\nexport function SubCoord3D (a, b) {\r\n  return new Coord3D(a.x - b.x, a.y - b.y, a.z - b.z)\r\n}\r\nexport function CoordDistance3D (a, b)\r\n{\r\n\treturn Math.sqrt ((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y) + (a.z - b.z) * (a.z - b.z));\r\n}\r\n","export class Camera {\r\n  constructor (eye, center, up, fov) {\r\n    this.eye = eye\r\n    this.center = center\r\n    this.up = up\r\n    this.fov = fov\r\n  }\r\n\r\n  Clone () {\r\n    return new Camera(\r\n      this.eye.Clone(),\r\n      this.center.Clone(),\r\n      this.up.Clone(),\r\n      this.fov\r\n    )\r\n  }\r\n}\r\n\r\n// new add \r\nexport const Eps = 0.00000001;\r\nexport function IsEqual (a, b)\r\n{\r\n\treturn Math.abs (b - a) < Eps;\r\n}\r\nexport function CoordIsEqual3D (a, b)\r\n{\r\n\treturn IsEqual (a.x, b.x) && IsEqual (a.y, b.y) && IsEqual (a.z, b.z);\r\n}\r\n\r\n\r\nexport function CameraIsEqual3D (a, b)\r\n{\r\n\treturn CoordIsEqual3D (a.eye, b.eye) && CoordIsEqual3D (a.center, b.center) && CoordIsEqual3D (a.up, b.up);\r\n}","export const Eps = 0.00000001\r\nexport const DegRad = 0.017453292519943\r\nexport function IsZero (a) {\r\n  return Math.abs(a) < Eps\r\n}\r\nexport const Direction =\r\n{\r\n  X: 1,\r\n  Y: 2,\r\n  Z: 3\r\n}\r\n","import * as THREE from 'three'\r\n\r\n// 模型的对象类\r\nexport class ViewerGeometry {\r\n  constructor (scene) {\r\n    console.log(scene, 'scene in ViewerGeometry')\r\n    this.scene = scene\r\n    this.mainObject = null\r\n  }\r\n\r\n  GetMainObject () {\r\n    return this.mainObject\r\n  }\r\n\r\n  // 设置模型\r\n  SetMainObject (mainObject) {\r\n    this.mainObject = mainObject\r\n    console.log(this.mainObject, 'this.mainObject')\r\n    this.scene.add(this.mainObject)\r\n  }\r\n\r\n  // 删除模型\r\n  Clear () {\r\n    this.ClearMainObject()\r\n  }\r\n\r\n  ClearMainObject () {\r\n    console.log(this.mainObject, 'this.mainObjectin ClearMainObject')\r\n    if (this.mainObject === null) {\r\n      return\r\n    }\r\n\r\n    this.EnumerateMeshes((mesh) => {\r\n      console.log(mesh, 'mesh in EnumerateMeshes ')\r\n      mesh.geometry.dispose()\r\n    })\r\n    this.scene.remove(this.mainObject)\r\n    this.mainObject = null\r\n  }\r\n\r\n  //  遍历模型执行一个函数\r\n  EnumerateMeshes (enumerator) {\r\n    console.log(this.mainObject, 'this.mainObject11111')\r\n    if (this.mainObject === null) {\r\n      return\r\n    }\r\n    this.mainObject.traverse((obj) => {\r\n      if (obj.isMesh) {\r\n        console.log(obj, 'obj in EnumerateMeshes ')\r\n        enumerator(obj)\r\n      }\r\n    })\r\n  }\r\n\r\n  //  TODO add\r\n  //   获得鼠标点击时选择的mesh\r\n  GetMeshIntersectionUnderMouse (mouseCoords, camera, width, height) {\r\n    console.log(mouseCoords, camera, width, height, 'in GetMeshIntersectionUnderMouse')\r\n    if (this.mainObject === null) {\r\n      return null\r\n    }\r\n\r\n    if (mouseCoords.x < 0.0 || mouseCoords.x > width || mouseCoords.y < 0.0 || mouseCoords.y > height) {\r\n      return null\r\n    }\r\n\r\n    let raycaster = new THREE.Raycaster()\r\n    let mousePos = new THREE.Vector2()\r\n    mousePos.x = (mouseCoords.x / width) * 2 - 1\r\n    mousePos.y = -(mouseCoords.y / height) * 2 + 1\r\n    raycaster.setFromCamera(mousePos, camera)\r\n    let iSectObjects = raycaster.intersectObject(this.mainObject, true)\r\n    console.log(iSectObjects, 'iSectObjects')\r\n    // if(iSectObjects.length>0){\r\n    //     return  iSectObjects[0].object\r\n    // }\r\n    for (let i = 0; i < iSectObjects.length; i++) {\r\n      let iSectObject = iSectObjects[i]\r\n      if (iSectObject.object.type === 'Mesh' && iSectObject.object.visible) {\r\n        return iSectObject\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  // 边界球\r\n  GetBoundingSphere (needToProcess) {\r\n    let boundingBox = this.GetBoundingBox(needToProcess)\r\n    console.log(boundingBox, 'boundingBox11')\r\n    if (boundingBox === null) {\r\n      return null\r\n    }\r\n\r\n    let boundingSphere = new THREE.Sphere()\r\n    boundingBox.getBoundingSphere(boundingSphere)\r\n    // 返回中心和半径\r\n    return boundingSphere\r\n  }\r\n\r\n  // mesh 和 模型 包围盒 取并集\r\n  GetBoundingBox (needToProcess) {\r\n    // console.log(needToProcess, 'needToProcess')\r\n    // TODO mesh 大小不一样 改成 计算模型的包围盒大小\r\n    // let hasMesh = false\r\n    // let boundingBox = new THREE.Box3()\r\n    // this.EnumerateMeshes((mesh) => {\r\n    //   console.log(mesh, 'mesh-GetBoundingBox')\r\n    //   if (needToProcess(mesh.userData)) {\r\n    //     let box = new THREE.Box3().setFromObject(mesh).getSize(new THREE.Vector3())\r\n\r\n    //     console.log(box, 'size111111')\r\n    //     console.log(new THREE.Box3().setFromObject(mesh), 'new THREE.Box3().setFromObject(mesh)')\r\n    //     boundingBox.union(new THREE.Box3().setFromObject(mesh))\r\n    //     hasMesh = true\r\n    //   }\r\n    // })\r\n    // if (!hasMesh) {\r\n    //   return null\r\n    // }\r\n    if (this.mainObject === null) {\r\n      return\r\n    }\r\n    let boundingBox = new THREE.Box3().setFromObject(this.mainObject)\r\n    // this.box3Helper = new THREE.Box3Helper(boundingBox, 0xffff00)\r\n    const center = new THREE.Vector3() // 0,0,0\r\n    boundingBox.getCenter(center)\r\n    console.log('查看几何体中心坐标', center)\r\n    // 模型居中\r\n    // this.mainObject.position.set(-center.x, -center.y, -center.z)\r\n    // this.scene.add(this.box3Helper)\r\n\r\n    // console.log(boundingBox.max, 'max')\r\n    // console.log(boundingBox.min, 'min')\r\n    // const mdlen = boundingBox.max.x - boundingBox.min.x // 长\r\n    // const mdhei = boundingBox.max.y - boundingBox.min.y // 高\r\n    // const mdwid = boundingBox.max.z - boundingBox.min.z// 宽\r\n    // 通过包围盒求出大小\r\n    console.log(boundingBox, 'boundingBox in GetBoundingBox')\r\n\r\n    return boundingBox\r\n  }\r\n}\r\n\r\n// 额外的对象类\r\nexport class ViewerExtraGeometry {\r\n  constructor (scene) {\r\n    this.scene = scene\r\n    this.ExtraObject = null\r\n  }\r\n\r\n  // 添加\r\n  AddObject (object) {\r\n    if (this.ExtraObject === null) {\r\n      this.ExtraObject = new THREE.Object3D()\r\n      this.scene.add(this.ExtraObject)\r\n    }\r\n    this.ExtraObject.add(object)\r\n  }\r\n\r\n  // 删除\r\n  Clear () {\r\n    if (this.ExtraObject === null) {\r\n      return\r\n    }\r\n    this.ExtraObject.traverse((obj) => {\r\n      if (obj.isMesh || obj.isLineSegments) {\r\n        obj.geometry.dispose()\r\n      }\r\n    })\r\n    this.scene.remove(this.ExtraObject)\r\n    this.ExtraObject = null\r\n  }\r\n}\r\n","import { CoordDistance3D, SubCoord3D } from './coord3d.js';\r\n\r\nexport function BezierTweenFunction (distance, index, count)\r\n{\r\n    let t = index / count;\r\n\treturn distance * (t * t * (3.0 - 2.0 * t));\r\n}\r\n\r\nexport function LinearTweenFunction (distance, index, count)\r\n{\r\n    return index * distance / count;\r\n}\r\n\r\nexport function ParabolicTweenFunction (distance, index, count)\r\n{\r\n    let t = index / count;\r\n    let t2 = t * t;\r\n    return distance * (t2 / (2.0 * (t2 - t) + 1.0));\r\n}\r\n\r\nexport function TweenCoord3D (a, b, count, tweenFunc)\r\n{\r\n\tlet dir = SubCoord3D (b, a).Normalize ();\r\n\tlet distance = CoordDistance3D (a, b);\r\n\tlet result = [];\r\n\tfor (let i = 0; i < count; i++) {\r\n        let step = tweenFunc (distance, i, count - 1);\r\n\t\tresult.push (a.Clone ().Offset (dir, step));\r\n\t}\r\n\treturn result;\r\n}\r\n","\r\nimport { GetDomElementClientCoordinates } from './domutils.js'\r\nimport { Coord2D, SubCoord2D } from '../engine/geometry/coor2d.js'\r\nimport { IsZero, DegRad } from '../engine/geometry/geometry.js'\r\nimport { SubCoord3D } from '../engine/geometry/coord3d.js'\r\n// new add\r\nimport { ParabolicTweenFunction, TweenCoord3D } from '../engine/geometry/tween.js';\r\nimport { CameraIsEqual3D } from './camera.js';\r\nexport class Navigation {\r\n  constructor (canvas,container, camera, callbacks) {\r\n    this.container = container\r\n    this.canvas = canvas\r\n    this.camera = camera\r\n    this.callbacks = callbacks\r\n\r\n    this.mouse = new MouseInteraction()/// / 鼠标位置记录\r\n    this.clickDetector = new ClickDetector()// 点击记录\r\n    this.onMouseClick = null\r\n    this.onMouseMove = null\r\n    if (this.canvas.addEventListener) {\r\n\r\n      console.log(this.canvas,'this.canvase111')\r\n      this.canvas.addEventListener('mousedown', this.OnMouseDown.bind(this))\r\n\r\n    }\r\n    if ( this.container.addEventListener) {\r\n\r\n\r\n      this.container.addEventListener('mousemove', this.OnMouseMove.bind(this))\r\n      this.container.addEventListener('mouseup', this.OnMouseUp.bind(this))\r\n      this.container.addEventListener('mouseleave', this.OnMouseLeave.bind(this))\r\n    }\r\n  }\r\n\r\n  //  获得新相机位置\r\n  GetFitToSphereCamera (center, radius) {\r\n    if (IsZero(radius)) {\r\n      return null\r\n    }\r\n    let fitCamera = this.camera.Clone()\r\n    console.log(fitCamera, 'fitCamera')\r\n    let offsetToOrigo = SubCoord3D(fitCamera.center, center)// 0 0 0 - 0 100 0\r\n    console.log(offsetToOrigo, 'offsetToOrigo') // 0 -100 0\r\n    fitCamera.eye = SubCoord3D(fitCamera.eye, offsetToOrigo) // -1.5 -3 2 ,0 -100 0\r\n    fitCamera.center = center.Clone()\r\n    let centerEyeDirection = SubCoord3D(fitCamera.eye, fitCamera.center).Normalize()\r\n    console.log(centerEyeDirection, 'centerEyeDirection')\r\n    let fieldOfView = this.camera.fov / 2.0\r\n    if (this.canvas.width < this.canvas.height) {\r\n      fieldOfView = fieldOfView * this.canvas.width / this.canvas.height\r\n    }\r\n    let distance = radius / Math.sin(fieldOfView * DegRad)\r\n    fitCamera.eye = fitCamera.center.Clone().Offset(centerEyeDirection, distance)\r\n    console.log(fitCamera, 'fitCamera2')\r\n    return fitCamera\r\n  }\r\n\r\n  Update () {\r\n    this.callbacks.onUpdate()\r\n  }\r\n\r\n  GetCamera () {\r\n    return this.camera\r\n  }\r\n\r\n  MoveCamera (newCamera, stepCount) {\r\n    // 没有动画\r\n    // if (newCamera === null) {\r\n    //   return\r\n    // }\r\n    // if (stepCount === 0) {\r\n    //   console.log(this.camera, 'this.camera1111')\r\n    //   this.camera = newCamera\r\n    //   console.log(this.camera, 'this.camera22222')\r\n    // }\r\n    // this.Update()\r\n    // 有动画\r\n    function Step (obj, steps, count, index)\r\n\t\t{\r\n\t\t\tobj.camera.eye = steps.eye[index];\r\n\t\t\tobj.camera.center = steps.center[index];\r\n\t\t\tobj.camera.up = steps.up[index];\r\n\t\t\tobj.Update ();\r\n\r\n\t\t\tif (index < count - 1) {\r\n\t\t\t\trequestAnimationFrame (() => {\r\n\t\t\t\t\tStep (obj, steps, count, index + 1);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (newCamera === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (stepCount === 0 || CameraIsEqual3D (this.camera, newCamera)) {\r\n\t\t\tthis.camera = newCamera;\r\n\t\t} else {\r\n\t\t\tlet tweenFunc = ParabolicTweenFunction;\r\n\t\t\tlet steps = {\r\n\t\t\t\teye : TweenCoord3D (this.camera.eye, newCamera.eye, stepCount, tweenFunc),\r\n\t\t\t\tcenter : TweenCoord3D (this.camera.center, newCamera.center, stepCount, tweenFunc),\r\n\t\t\t\tup : TweenCoord3D (this.camera.up, newCamera.up, stepCount, tweenFunc)\r\n\t\t\t};\r\n\t\t\trequestAnimationFrame (() => {\r\n\t\t\t\tStep (this, steps, stepCount, 0);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.Update ();\r\n  }\r\n\r\n  // 鼠标按下\r\n  OnMouseDown (ev) {\r\n    console.log(this, 'this in OnMouseDown')\r\n    ev.preventDefault()\r\n    this.mouse.Down(this.canvas, ev)\r\n    this.clickDetector.Start(this.mouse.GetPosition())\r\n  }\r\n\r\n  // 鼠标移动\r\n  OnMouseMove (ev) {\r\n    this.mouse.Move(this.canvas, ev)\r\n    this.clickDetector.Move(this.mouse.GetPosition())\r\n    if (this.onMouseMove) {\r\n      let mouseCoords = GetDomElementClientCoordinates(this.canvas, ev.clientX, ev.clientY)\r\n      this.onMouseMove(mouseCoords)\r\n    }\r\n    if (!this.mouse.IsButtonDown()) {\r\n      // return\r\n      return\r\n    }\r\n    // TODO\r\n    let moveDiff = this.mouse.GetMoveDiff()\r\n    console.log(moveDiff, 'movediff')\r\n    let mouseButton = this.mouse.GetButton()\r\n  }\r\n\r\n  // 鼠标抬起\r\n  OnMouseUp (ev) {\r\n    // TODO\r\n    this.mouse.Up(this.canvas, ev)\r\n    this.clickDetector.End()\r\n\r\n    if (this.clickDetector.IsClick()) {\r\n      let mouseCoords = this.mouse.GetPosition()\r\n      this.Click(ev.which, mouseCoords)\r\n    }\r\n  }\r\n\r\n  // 鼠标离开\r\n  OnMouseLeave (ev) {\r\n    // TODO\r\n    this.mouse.Leave(this.canvas, ev)\r\n    this.clickDetector.Cancel()\r\n  }\r\n\r\n  SetMouseClickHandler (onMouseClick) {\r\n    this.onMouseClick = onMouseClick\r\n  }\r\n\r\n  SetMouseMoveHandler (onMouseMove) {\r\n    this.onMouseMove = onMouseMove\r\n  }\r\n\r\n  Click (button, mouseCoords) {\r\n    if (this.onMouseClick) {\r\n      this.onMouseClick(button, mouseCoords)\r\n    }\r\n  }\r\n}\r\n// 鼠标坐标记录类\r\nexport class MouseInteraction {\r\n  constructor () {\r\n    this.buttons = []\r\n    this.curr = new Coord2D(0.0, 0.0)// 移动时当前位置\r\n    this.prev = new Coord2D(0.0, 0.0)// 上一个点位置\r\n    this.diff = new Coord2D(0.0, 0.0)// 两点之间距离\r\n  }\r\n\r\n  // 鼠标按下\r\n  Down (canvas, ev) {\r\n    console.log(canvas, ev, 'in Down')\r\n    this.buttons.push(ev.which)\r\n    console.log(this.buttons, 'this.buttons')\r\n    this.curr = this.GetPositionFromEvent(canvas, ev)\r\n    this.prev = this.curr.Clone()\r\n  }\r\n\r\n  // 鼠标移动\r\n  Move (canvas, ev) {\r\n    this.curr = this.GetPositionFromEvent(canvas, ev)\r\n    this.diff = SubCoord2D(this.curr, this.prev)\r\n    this.prev = this.curr.Clone()// 移动时 上一个位置为当前位置\r\n    // console.log(this.curr, this.diff, 'curr-diff')\r\n  }\r\n\r\n  //  TODO\r\n  // 鼠标抬起\r\n  Up (canvas, ev) {\r\n    // 左键的which值为1  右键值为3 中键键值为0\r\n    console.log(this.buttons, 'this.buttons 1')\r\n    let buttonIndex = this.buttons.indexOf(ev.which)\r\n    console.log(buttonIndex, 'buttonIndex')\r\n    // 删除重复的 数组中没找到指定元素则返回 -1\r\n    if (buttonIndex !== -1) {\r\n      this.buttons.splice(buttonIndex, 1)\r\n    }\r\n    console.log(this.buttons, 'this.buttons 2')\r\n    this.curr = this.GetPositionFromEvent(canvas, ev)\r\n  }\r\n\r\n  // 鼠标离开\r\n  Leave (canvas, ev) {\r\n    this.buttons = []\r\n    this.curr = this.GetPositionFromEvent(canvas, ev)\r\n    // console.log(this.curr, 'this.curr in leave')\r\n  }\r\n\r\n  GetButton () {\r\n    let { length } = this.buttons\r\n    console.log(length, 'length in GetButton')\r\n    if (length === 0) {\r\n      return 0\r\n    }\r\n    return this.buttons[length - 1]\r\n  }\r\n\r\n  // 获取移动的距离\r\n  GetMoveDiff () {\r\n    return this.diff\r\n  }\r\n\r\n  // 是否被按下\r\n  IsButtonDown () {\r\n    return this.buttons.length > 0\r\n  }\r\n\r\n  // 获得当前为位置\r\n  GetPosition () {\r\n    return this.curr\r\n  }\r\n\r\n  // 事件获得的位置\r\n  GetPositionFromEvent (canvas, ev) {\r\n    // console.log(GetDomElementClientCoordinates(canvas, ev.clientX, ev.clientY), '当前位置GetPositionFromEvent')\r\n    return GetDomElementClientCoordinates(canvas, ev.clientX, ev.clientY)\r\n  }\r\n}\r\n// 点击记录类\r\nexport class ClickDetector {\r\n  constructor () {\r\n    this.isClick = false\r\n    this.startPosition = null\r\n  }\r\n\r\n  // 开始点击\r\n  Start (startPosition) {\r\n    this.isClick = true\r\n    this.startPosition = startPosition\r\n    console.log(this.startPosition, 'this.startPosition')\r\n  }\r\n\r\n  Move (currentPosition) {\r\n    // console.log(currentPosition, 'currentPosition')\r\n    // 如果没有点击不执行\r\n    if (!this.isClick) {\r\n\r\n    }\r\n  }\r\n\r\n  // 结束\r\n  End () {\r\n    this.startPosition = null\r\n  }\r\n\r\n  Cancel () {\r\n    this.isClick = false\r\n    this.startPosition = null\r\n  }\r\n\r\n  IsClick () {\r\n    return this.isClick\r\n  }\r\n}\r\n","\r\nimport * as THREE from 'three'\r\nexport function ConvertColorToThreeColor (color) {\r\n  return new THREE.Color(\r\n    color.r / 255.0,\r\n    color.g / 255.0,\r\n    color.b / 255.0\r\n  )\r\n}\r\nexport const ShadingType =\r\n{\r\n  Phong: 1,\r\n  Physical: 2\r\n}\r\n","import * as THREE from 'three'\r\nimport { ShadingType } from '../engine/threejs/threeutils.js'\r\nexport class ShadingModel {\r\n  constructor (scene) {\r\n    this.scene = scene\r\n    // this.ambientLight = new THREE.AmbientLight(0x888888)\r\n    // this.directionalLight = new THREE.DirectionalLight(0x888888)\r\n    this.ambientLight = new THREE.AmbientLight(4210752, 3)\r\n    this.directionalLight = new THREE.DirectionalLight(16777215, 1)\r\n    this.directionalLight.castShadow = true\r\n    this.directionalLight.position.set(1200, 2800, 1200)\r\n    // 平行光辅助线\r\n    this.scene.add(new THREE.DirectionalLightHelper(this.directionalLight))\r\n    this.scene.add(new THREE.CameraHelper(this.directionalLight.shadow.camera))\r\n\r\n    //   平行光位置\r\n    // const sphereGeometry = new THREE.SphereBufferGeometry(5, 32, 32)\r\n    // const sphereMaterial = new THREE.MeshStandardMaterial({ color: 0xff0000 })\r\n    // const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial)\r\n    // sphere.castShadow = true // default is false\r\n    // sphere.position.set(1200, 2800, 1200)\r\n    // sphere.receiveShadow = false // default\r\n    // this.scene.add(sphere)\r\n    this.environment = null// 背景\r\n    this.backgroundIsEnvMap = false\r\n\r\n    this.scene.add(this.ambientLight)\r\n    this.scene.add(this.directionalLight)\r\n  }\r\n\r\n  SetType (type) {\r\n    this.type = type\r\n    this.UpdateShading()\r\n  }\r\n\r\n  SetEnvironment (textures, useAsBackground, onLoaded) {\r\n    let loader = new THREE.CubeTextureLoader()\r\n    this.environment = loader.load(textures, () => {\r\n      onLoaded()\r\n    })\r\n    this.backgroundIsEnvMap = useAsBackground\r\n  }\r\n\r\n  UpdateShading () {\r\n    console.log(this.backgroundIsEnvMap, 'this.backgroundIsEnvMap')\r\n    if (this.type === ShadingType.Phong) {\r\n      this.ambientLight.color.set(0x888888)\r\n      this.directionalLight.color.set(0x888888)\r\n      this.scene.environment = null\r\n    } else if (this.type === ShadingType.Physical) {\r\n      this.ambientLight.color.set(0x000000)\r\n      this.directionalLight.color.set(0x555555)\r\n      this.scene.environment = this.environment\r\n    }\r\n    if (this.backgroundIsEnvMap) {\r\n      this.scene.background = this.environment\r\n    } else {\r\n      this.scene.background = null\r\n      // this.scene.background = new THREE.Color(0xbfd1e5)\r\n    }\r\n  }\r\n}\r\n","// 爆炸的工具方法\r\nimport * as THREE from 'Three'\r\n\r\nexport function getWorldCenterPosition (box, scalar = 0.01) {\r\n  return new THREE.Vector3().addVectors(box.max, box.min).multiplyScalar(scalar)\r\n}\r\nexport function initExplodeModel (model) {\r\n  if (!model) return\r\n\r\n  // 计算模型中心\r\n  // https://blog.csdn.net/m0_49399323/article/details/107461063\r\n  const explodeBox = new THREE.Box3()// Box3在3D空间中表示一个包围盒\r\n  explodeBox.setFromObject(model)\r\n  const explodeCenter = getWorldCenterPosition(explodeBox)\r\n\r\n  const meshBox = new THREE.Box3()\r\n\r\n  // 遍历整个模型，保存数据到userData上，以便爆炸函数使用\r\n  model.traverse(function (value) {\r\n    if (value.isMark || value.isMarkChild || value.isLine || value.isSprite) return\r\n    if (value.isMesh) {\r\n      meshBox.setFromObject(value)\r\n\r\n      const meshCenter = getWorldCenterPosition(meshBox)\r\n\r\n      // 爆炸方向\r\n      value.userData.worldDir = new THREE.Vector3()\r\n        .subVectors(meshCenter, explodeCenter)\r\n        .normalize()\r\n      // 爆炸距离 mesh中心点到爆炸中心点的距离\r\n      value.userData.worldDistance = new THREE.Vector3().subVectors(meshCenter, explodeCenter)\r\n      // 原始坐标\r\n      value.userData.originPosition = value.getWorldPosition(new THREE.Vector3())\r\n      // mesh中心点\r\n      value.userData.meshCenter = meshCenter.clone()\r\n      value.userData.explodeCenter = explodeCenter.clone()\r\n    }\r\n  })\r\n}\r\nexport function explodeModel (model, scalar) {\r\n  console.log(model,scalar,'explodeModel')\r\n  model.traverse(function (value) {\r\n    console.log(value.userData, 'value.userData')\r\n    if (!value.isMesh || !value.userData.originPosition) return\r\n    const distance = value.userData.worldDir\r\n      .clone()\r\n      .multiplyScalar(value.userData.worldDistance.length() * scalar)\r\n    console.log(distance, 'distance')\r\n    const offset = new THREE.Vector3().subVectors(\r\n      value.userData.meshCenter,\r\n      value.userData.originPosition\r\n    )\r\n    console.log(offset, 'offset')\r\n    const center = value.userData.explodeCenter\r\n    console.log(center, 'center')\r\n    const newPos = new THREE.Vector3().copy(center).add(distance).sub(offset)\r\n    // TODO\r\n    //  a?.b    a && a.b ? a.b : undefined\r\n    const localPosition = value.parent && value.parent.worldToLocal(newPos.clone()) ? value.parent.worldToLocal(newPos.clone()) : undefined\r\n    // const localPosition = value.parent ? .worldToLocal(newPos.clone());\r\n    localPosition && value.position.copy(localPosition)\r\n  })\r\n}\r\n","/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nclass EventDispatcher {\r\n  addEventListener (type, listener) {\r\n    if (this._listeners === undefined) this._listeners = {}\r\n\r\n    const listeners = this._listeners\r\n\r\n    if (listeners[type] === undefined) {\r\n      listeners[type] = []\r\n    }\r\n\r\n    if (listeners[type].indexOf(listener) === -1) {\r\n      listeners[type].push(listener)\r\n    }\r\n  }\r\n\r\n  hasEventListener (type, listener) {\r\n    if (this._listeners === undefined) return false\r\n\r\n    const listeners = this._listeners\r\n\r\n    return listeners[type] !== undefined && listeners[type].indexOf(listener) !== -1\r\n  }\r\n\r\n  removeEventListener (type, listener) {\r\n    if (this._listeners === undefined) return\r\n\r\n    const listeners = this._listeners\r\n    const listenerArray = listeners[type]\r\n\r\n    if (listenerArray !== undefined) {\r\n      const index = listenerArray.indexOf(listener)\r\n\r\n      if (index !== -1) {\r\n        listenerArray.splice(index, 1)\r\n      }\r\n    }\r\n  }\r\n\r\n  dispatchEvent (event) {\r\n    if (this._listeners === undefined) return\r\n\r\n    const listeners = this._listeners\r\n    const listenerArray = listeners[event.type]\r\n\r\n    if (listenerArray !== undefined) {\r\n      event.target = this\r\n\r\n      // Make a copy, in case listeners are removed while iterating.\r\n      const array = listenerArray.slice(0)\r\n\r\n      for (let i = 0, l = array.length; i < l; i++) {\r\n        array[i].call(this, event)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport { EventDispatcher }\r\n","import * as THREE from 'three'\r\n// 高亮\r\nimport { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/addons/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/addons/postprocessing/ShaderPass.js'\r\nimport { OutlinePass } from 'three/addons/postprocessing/OutlinePass.js'\r\nimport { FXAAShader } from 'three/addons/shaders/FXAAShader.js'\r\nimport { DragControls } from 'three/addons/controls/DragControls.js'\r\n// 动画\r\nimport { TWEEN } from 'three/addons/libs/tween.module.min.js'\r\n\r\nimport {explodeModel} from '../modelTool/blastTool.js'\r\nimport { EventDispatcher } from '../utils/EventDispatcher/EventDispatcher.js'\r\nlet that \r\nimport store from '../../examples/store/index.js'\r\nexport class Outline extends EventDispatcher {\r\n  constructor (viewer,website) {\r\n    super()\r\n    that = viewer //viewer 父类\r\n    this.viewer = viewer\r\n    this.website = website\r\n    console.log(viewer, 'viewer in outline')\r\n    this.renderer = viewer.renderer\r\n    this.scene = viewer.scene\r\n    this.camera = viewer.camera\r\n    this.container = viewer.canvas\r\n    console.log(this.container, 'this.caontainer in outline')\r\n    // null\r\n    this.composer = null\r\n    this.effectFXAA = null\r\n    this.outlinePass = null\r\n    this.selectedObject = null\r\n    this.groups = []// 透明的child集合\r\n    this.toumingMaterials = {} // 存储透明的mesh\r\n    this.yincangMeshs= {}\r\n    this.phongMaterial = new THREE.MeshPhongMaterial({\r\n      color: 0x555555,\r\n      specular: 0xffffff,\r\n      shininess: 10,\r\n      flatShading: false,\r\n      side: THREE.DoubleSide,\r\n      skinning: true\r\n    })\r\n    this.model =null;\r\n    // 移动 \r\n    this.dragControls = null\r\n\r\n   this.cloneModel = null\r\n   this.dragGroup = new THREE.Group()\r\n   this.MeshPostions = new Map()\r\n   this.flag = false\r\n  //  爆炸\r\n  this.blastValue = 0\r\n\r\n  }\r\n  getSelectedObject(){\r\n     return this.selectedObject\r\n  }\r\n  Click (mouseCoordinates) {\r\n    console.log(mouseCoordinates, 'mouseCoordinates in Outline')\r\n    // TODO 使用这种方式 选择不准  已解决\r\n    let intersection = that.GetMeshIntersectionUnderMouse(mouseCoordinates)\r\n    console.log(intersection, 'intersection in OutlineClick')\r\n    if (intersection === null) {\r\n      return false\r\n    }\r\n    this.selectedObject = intersection.object\r\n    console.log(this.selectedObject.name, '选择的mesh')\r\n    this.addSelectedObject( this.selectedObject)\r\n    this.outlineObj(this.selectedObjects)\r\n  }\r\n  // 方式2 改变颜色\r\n  Click2 (mouseCoordinates) {\r\n    console.log(mouseCoordinates, 'mouseCoordinates in Outline')\r\n    let intersection = that.GetMeshIntersectionUnderMouse(mouseCoordinates)\r\n    console.log(intersection, 'intersection in OutlineClick')\r\n    if (intersection === null) {\r\n      return false\r\n    }\r\n    this.selectedObject = intersection.object\r\n    this.selectedObject.currentHex = this.selectedObject.material.emissive.getHex()\r\n    this.selectedObject.material.emissive.setHex( 0xff0000 );\r\n\r\n\r\n\r\n  }\r\n\r\n  addSelectedObject (object) {\r\n    this.selectedObjects = []\r\n    this.selectedObjects.push(object)\r\n  }\r\n\r\n  outlineObj (selectedObjects) {\r\n    console.log(selectedObjects, 'selectedObjects in outlineObj')\r\n    // postprocessing\r\n    this.composer = new EffectComposer(this.renderer) // 特效组件\r\n    console.log(this.composer, 'this.composer')\r\n    const renderPass = new RenderPass(this.scene, this.camera)\r\n    this.composer.addPass(renderPass) // 特效渲染\r\n    this.outlinePass = new OutlinePass(new THREE.Vector2(this.container.offsetWidth, this.container.offsetHeight), this.scene, this.camera)\r\n    console.log(this.outlinePass, 'this.outlinePass')\r\n    this.composer.addPass(this.outlinePass) // 加入高光特效\r\n\r\n    this.outlinePass.pulsePeriod = 2 // 数值越大，律动越慢\r\n    this.outlinePass.visibleEdgeColor.set('green') // 高光颜色0xff0000\r\n    this.outlinePass.hiddenEdgeColor.set('green') // 阴影颜色 0x000000\r\n    this.outlinePass.usePatternTexture = false // 使用纹理覆盖？\r\n    this.outlinePass.edgeStrength = 5 // 高光边缘强度\r\n    this.outlinePass.edgeGlow = 1 // 边缘微光强度\r\n    this.outlinePass.edgeThickness = 1 // 高光厚度\r\n\r\n    this.effectFXAA = new ShaderPass(FXAAShader)\r\n    this.effectFXAA.uniforms.resolution.value.set(1 / this.container.offsetWidth, 1 / this.container.offsetHeight)\r\n    // this.effectFXAA.renderToScreen = true\r\n    this.composer.addPass(this.effectFXAA)\r\n\r\n    this.outlinePass.selectedObjects = selectedObjects\r\n  }\r\n  // 独显 全显\r\n  duxian(model,active){\r\n    \r\n    this.model = model\r\n    console.log(this.selectedObject,'this.selectObj')\r\n     if(!this.selectedObject){\r\n       return\r\n     }\r\n    \r\n    //  独显\r\n     if(active){\r\n      store.commit('app/DUXIAN',true)\r\n      this.model.traverse((item)=>{\r\n        if (item instanceof THREE.Mesh) {\r\n          if (item.name !== this.selectedObject.name) {\r\n            item.visible = false\r\n          }\r\n        }\r\n      })\r\n      \r\n     }else{\r\n      store.commit('app/DUXIAN',false)\r\n      // 全显\r\n      this.model.traverse((item)=>{\r\n        if (item instanceof THREE.Mesh) {\r\n          item.visible = true\r\n        }\r\n      })\r\n     }\r\n  }\r\n  // 透明\r\n  touming(model,active){\r\n    this.model = model\r\n    if (!this.selectedObject) return\r\n    if(active){\r\n        console.log(this.selectedObject,'选择的mesh 透明')\r\n         this.model.traverse(item =>{\r\n          // console.log(item,'item1111')\r\n          if (item instanceof THREE.Mesh) {\r\n            this.groups.push(item)\r\n            if (item.name == this.selectedObject.name) { //选中\r\n               if( this.toumingMaterials.hasOwnProperty(this.selectedObject.name)){\r\n                // 如果透明\r\n                if(this.selectedObject.material.transparent){\r\n                  // alert('toumimg')\r\n                  this.selectedObject.material = this.toumingMaterials[item.name]\r\n                }else {     \r\n                  // item.material =  this.toumingMaterials[this.selectedObject.name]\r\n                  // alert('butoumimg')\r\n                  item.material = this.phongMaterial\r\n                  item.material.transparent = true\r\n                  item.material.opacity = 0.5\r\n                }\r\n              \r\n                 \r\n               }else {\r\n                // 没有第一次就透明\r\n                  this.toumingMaterials[item.name] = this.selectedObject.material\r\n                  item.material = this.phongMaterial\r\n                  item.material.transparent = true\r\n                  item.material.opacity = 0.5\r\n               }\r\n            \r\n            \r\n            }\r\n          }\r\n   \r\n         })\r\n    }else {\r\n      for (const key in this.toumingMaterials) {\r\n        console.log(key, 'key')\r\n        this.model.traverse(child=>{\r\n          if (child instanceof THREE.Mesh) {\r\n            if (child.name === key) {\r\n              child.material = this.toumingMaterials[key]\r\n            }\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n  // 隐藏\r\n  yincang(model){\r\n    this.model = model\r\n    this.model.traverse(item=>{\r\n      if (item instanceof THREE.Mesh) {\r\n        if (item.name === this.selectedObject.name) {\r\n          this.yincangMeshs[item.name] = this.selectedObject\r\n          item.visible = false\r\n        }\r\n        \r\n      }\r\n    })\r\n  }\r\n  dragMesh(model,flag){\r\n    this.flag = flag\r\n    this.model = model\r\n    this.cloneModel = model.clone()  //这个就不行 this.model 就能拖拽\r\n     console.log(this.selectedObjects,'selectedObjects -dragMesh')\r\n     console.log(this.model,'this.model in dragMesh1 ')\r\n     console.log(this.model,'this.cloneModel in dragMesh1 ')\r\n     if(this.flag){\r\n      this.dragControls = new DragControls([this.model], this.viewer.camera, this.viewer.renderer.domElement)\r\n      // 不执行 TODO\r\n      // this.dragControls.addEventListener('drag',function(){\r\n      //   debugger\r\n      //   alert(1)\r\n      // })\r\n      // this.dragControls.transformGroup = true\r\n        // 开始拖拽\r\n    this.dragControls.addEventListener('dragstart',  (event)=> {\r\n      console.log(event,'event0000')\r\n      that.controls.enabled = false\r\n      // event.object.material.emissive.set( 'red' )\r\n      console.log(this.selectedObject,'this.selectedObject1111')\r\n      this.MeshPostions.set(event.object.name,event.object.position)\r\n    })\r\n    // 拖拽结束\r\n    this.dragControls.addEventListener('dragend',  (event) =>{\r\n      console.log(event,'event11111111')\r\n      console.log(  this.MeshPostions,'  this.MeshPostions222')\r\n      that.controls.enabled = true\r\n      // event.object.material.emissive.set( 0xaaaaaa )\r\n    })\r\n    // // 选中模型 \r\n    //  this.dragControls.addEventListener('hoveron',function(event){\r\n    //   that.controls.enabled = false;\r\n    //  })\r\n      // if(flag){\r\n      //   // const draggableObjects =  this.dragControls.getObjects();\r\n      //   // draggableObjects.length = 0;\r\n      // }else {\r\n          \r\n      // }\r\n     }else {\r\n      // 只需要设置这个属性 就可以取消激活\r\n      that.controls.enabled = true;\r\n      this.dragControls.deactivate();\r\n    \r\n     }\r\n\r\n  }\r\n  // 旋转\r\n  rotation(val){\r\n      if(val){\r\n        that.controls.autoRotate = true;\r\n      }else {\r\n        that.controls.autoRotate = false;\r\n      }\r\n  }\r\n  // 设置背景\r\n  SetEnvironment(envMapName = 'ice_river', backgroundIsEnvMap = false, onLoaded){\r\n    if (backgroundIsEnvMap) {\r\n      const loader = new THREE.CubeTextureLoader()\r\n      const envMapPath = '/static/envmaps/' + envMapName + '/'\r\n      const envMapTextures = [\r\n        envMapPath + 'posx.jpg',\r\n        envMapPath + 'negx.jpg',\r\n        envMapPath + 'posy.jpg',\r\n        envMapPath + 'negy.jpg',\r\n        envMapPath + 'posz.jpg',\r\n        envMapPath + 'negz.jpg'\r\n      ]\r\n      const environment = loader.load(envMapTextures, function () {\r\n        onLoaded && onLoaded()\r\n      })\r\n      this.scene.background = environment\r\n    } else {\r\n      this.scene.background = new THREE.Color('#212121')\r\n    }\r\n  }\r\n  // 设置背景颜色\r\n  SetbackgroundColor(index){\r\n     if(index===0){\r\n      that.scene.background = new THREE.Color('#212121')\r\n     }else if(index===1){\r\n      that.scene.background = new THREE.Color('#474747')\r\n     }else {\r\n      that.scene.background = new THREE.Color('#afafaf')\r\n     }\r\n  }\r\n  // 重置\r\n  reset(){\r\n    // 测量重置\r\n  this.website.Measure(false)\r\n   if(!this.model){\r\n    return\r\n  } \r\n  // 独显 全显\r\n  store.commit('app/DUXIAN',false)\r\n      // 隐藏还原\r\n      for (const key in this.yincangMeshs) {\r\n        this.model.traverse(child => {\r\n          if (child instanceof THREE.Mesh) {\r\n            if (child.name === key) {\r\n              child.visible = true\r\n            }\r\n          }\r\n        })\r\n    }\r\n      // 全显还原\r\n      this.model.traverse((item)=>{\r\n        if (item instanceof THREE.Mesh) {\r\n          item.visible = true\r\n        }\r\n      })\r\n        // 透明还原  \r\n      for (const key in this.toumingMaterials) {\r\n        this.model.traverse(child => {\r\n          if (child instanceof THREE.Mesh) {\r\n            if (child.name === key) {\r\n              console.log(this.toumingMaterials[key], 'this.toumingMaterials[key]')\r\n              child.material = this.toumingMaterials[key]\r\n              // child = this.toumingMaterials[key]\r\n              // child.material.color.set('red')//ok\r\n            }\r\n          }\r\n        })\r\n      }\r\n      // 爆炸还原\r\n      this.blastValue = 0\r\n      //  store.commit('RESET_BLASTVAL')\r\n        store.dispatch('app/resetBlastVal')\r\n        explodeModel(this.model,  this.blastValue)\r\n    // mesh 移动还原\r\n    // https://www.cnblogs.com/yc-c/p/13901994.html\r\n    if( !this.MeshPostions){\r\n      return\r\n    }else {\r\n      for (let key of this.MeshPostions.keys()) {\r\n             console.log(key,'key in  reset ');\r\n             this.model.traverse(child=>{\r\n              if(child.name===key){\r\n                console.log(child,'child11111')\r\n                // 这一行就可以默认重置\r\n                child.position.set(0,0,0)\r\n              }\r\n             })\r\n   \r\n      }\r\n      if(this.flag){\r\n        this.dragControls.activate();\r\n      }else {     \r\n      }\r\n\r\n    }\r\n \r\n}\r\n\r\n// 相机移动\r\ntweenCamera (newCamera, duration) {\r\n  let position = new THREE.Vector3().copy(newCamera.center)\r\n\r\n// let  targetPosition =  new THREE.Vector3().copy(newCamera.eye)\r\nlet  targetPosition =  new THREE.Vector3(20,20,20)\r\n\r\n  // new TWEEN.Tween(position)\r\n  // .to(targetPosition, duration)\r\n  // .easing(TWEEN.Easing.Exponential.InOut)\r\n  // .onUpdate(function () {\r\n  //   that.camera.position.copy(position)\r\n  //   that.camera.lookAt(that.controls.target)\r\n  // })\r\n  // .onComplete(function () {\r\n  //   that.camera.position.copy(targetPosition)\r\n  //   that.camera.lookAt(that.controls.target)\r\n  //   that.controls.enabled = true\r\n  // })\r\n  // .start()\r\n}\r\n\r\n// 爆炸\r\nBlast (model, val) {\r\n  this.model = model\r\n  this.blastValue = val\r\n  explodeModel(this.model,  this.blastValue)\r\n  store.dispatch('app/changBlastVal',this.blastValue)\r\n}\r\n// edge\r\nEdge(model,val){\r\n  this.model = model\r\n  store.commit('app/CHANGE_EDGE_VAL',val)\r\n  this.website.UpdateEdgeDisplay(true,val)\r\n}\r\n// start(){\r\n//   this.dispatchEvent({ type: 'start', message: 'js通知vue文件!'+this.blastValue })\r\n// }\r\n}\r\n","import * as THREE from 'three'\r\nimport { OrbitControls } from 'three/addons/controls/OrbitControls.js'\r\nimport { Coord3D } from '../engine/geometry/coord3d.js'\r\nimport {\r\n  SetDomElementOuterHeight, SetDomElementOuterWidth, SetDomElementWidth, SetDomElementHeight, GetDomElementInnerDimensions\r\n} from './domutils.js'\r\nimport { Camera } from './camera.js'\r\nimport { Direction } from '../engine/geometry/geometry.js'\r\nimport { ViewerGeometry, ViewerExtraGeometry } from './viewergeometry.js'\r\nimport { Navigation } from './navigation.js'// 鼠标类事件\r\nimport { ShadingModel } from './shadingmodel.js'// 设置 光 环境等\r\nimport { ShadingType } from '../engine/threejs/threeutils.js'// 材质类型\r\n// 模型高亮\r\nimport { Outline } from '../modelTool/outlineobj.js'\r\nimport { GUI } from 'three/addons/libs/lil-gui.module.min.js'\r\n\r\n// TODO\r\n// import store from '../../../store/index.js'\r\nexport function TraverseThreeObject (object, processor) {\r\n  if (!processor(object)) {\r\n    return false\r\n  }\r\n  for (let child of object.children) {\r\n    if (!TraverseThreeObject(child, processor)) {\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\nexport function GetShadingTypeOfObject (mainObject) {\r\n  let shadingType = null\r\n  TraverseThreeObject(mainObject, (obj) => {\r\n    if (obj.isMesh) {\r\n      // TODO obj.material\r\n      // for (const material of obj.material) {\r\n      //   if (material.type === 'MeshPhongMaterial') {\r\n      //     shadingType = ShadingType.Phong\r\n      //   } else if (material.type === 'MeshStandardMaterial') {\r\n      //     shadingType = ShadingType.Physical\r\n      //   }\r\n      //   return false\r\n      // }\r\n      if (obj.material.type === 'MeshPhongMaterial') {\r\n        shadingType = ShadingType.Phong\r\n      } else if (obj.material.type === 'MeshStandardMaterial') {\r\n        shadingType = ShadingType.Physical\r\n      }\r\n    }\r\n    return true\r\n  })\r\n  return shadingType\r\n}\r\n\r\nexport function GetDefaultCamera (direction) {\r\n  let fieldOfView = 45.0\r\n  if (direction === Direction.X) {\r\n    return new Camera(\r\n      new Coord3D(2.0, -3.0, 1.5),\r\n      new Coord3D(0.0, 0.0, 0.0),\r\n      new Coord3D(1.0, 0.0, 0.0),\r\n      fieldOfView\r\n    )\r\n  } else if (direction === Direction.Y) {\r\n    return new Camera(\r\n      new Coord3D(-1.5, 2.0, 3.0),\r\n      new Coord3D(0.0, 0.0, 0.0),\r\n      new Coord3D(0.0, 1.0, 0.0),\r\n      fieldOfView\r\n    )\r\n  } else if (direction === Direction.Z) {\r\n    return new Camera(\r\n      new Coord3D(-1.5, -3.0, 2.0),\r\n      new Coord3D(0.0, 0.0, 0.0),\r\n      new Coord3D(0.0, 0.0, 1.0),\r\n      fieldOfView\r\n    )\r\n  }\r\n  return null\r\n}\r\nlet showCamera2 = false // 是否开启裁剪区域\r\nexport class Viewer {\r\n  constructor (mainDiv, view2, settings, website) {\r\n    this.website= website\r\n    this.signals = website.signals\r\n    console.log(this.signals, 'this.signals  in Viewer')\r\n\r\n    // this.settings = settings\r\n    this.settings = {\r\n      animationSteps : 40\r\n  };\r\n    console.log(mainDiv, 'mainDiv in Viewer')\r\n    this.canvas = null\r\n    this.mainDiv = mainDiv\r\n    this.renderer = null\r\n    this.scene = null\r\n    this.camera = null\r\n    this.fov = 45.0\r\n    this.near = 0.1\r\n    this.far = 10000.0\r\n    this.navigation = null\r\n    this.shading = null\r\n    this.outline = null // 高亮效果\r\n    this.view2 = view2\r\n    console.log(view2, 'view2 in Viewer')\r\n  }\r\n\r\n  Init (canvas) {\r\n    this.canvas = canvas\r\n    this.canvas.id = 'viewer'\r\n    // 渲染器\r\n    let parameters = {\r\n      // alpha: true, // canvas 是否支持 alpha 透明度\r\n      canvas: this.canvas,\r\n      // preserveDrawingBuffer: true,//是否保存 BUFFER 直到手动清除\r\n      antialias: true// 平滑效果 抗锯齿\r\n    }\r\n    this.renderer = new THREE.WebGLRenderer(parameters)\r\n    if (window.devicePixelRatio) {\r\n      this.renderer.setPixelRatio(window.devicePixelRatio)\r\n    }\r\n    // 添加下面这两行 相机辅助线才能出来\r\n    this.renderer.shadowMap.enabled = true\r\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap // default THREE.PCFShadowMap\r\n    // add hdr 相关\r\n    // this.renderer.outputEncoding = THREE.sRGBEncoding\r\n    // this.renderer.toneMapping = THREE.ACESFilmicToneMapping\r\n    this.renderer.setClearColor('#ffffff', 1.0)\r\n    this.renderer.setSize(this.canvas.width, this.canvas.height)\r\n\r\n    // 场景\r\n    this.scene = new THREE.Scene()\r\n    this.scene.background = new THREE.Color(0xbfd1e5)\r\n    // this.signals.sceneAdded.dispatch()\r\n\r\n    // 相机\r\n    /**\r\n     * @params {Number} fov 视野角度\r\n     * @params {Number} x 长宽比\r\n     * @params {Number} y 近截面\r\n     * @params {Number} z 远截面\r\n     */\r\n\r\n    this.camera = new THREE.PerspectiveCamera(45.0, this.canvas.width / this.canvas.height, this.near, this.far)\r\n    // this.camera = new THREE.PerspectiveCamera(this.settings.angle, this.canvas.width / this.canvas.height, this.settings.nearest, this.settings.farthest)\r\n    this.camera.position.set(500, 500, 500)\r\n\r\n    console.log(this.camera, 'this.camera....')\r\n    if (showCamera2) {\r\n      // camera2\r\n      this.camera2 = new THREE.PerspectiveCamera(50, this.canvas.width / this.canvas.height, 0.1, 3000)\r\n      this.camera2.position.set(600, 600, 600)\r\n      this.camera2.lookAt(0, 0, 0)\r\n    }\r\n\r\n    // 相机辅助线\r\n    // const cameraPerspective = new THREE.PerspectiveCamera(50, this.canvas.width / this.canvas.height, 0.1, 30000)\r\n    this.cameraHelper = new THREE.CameraHelper(this.camera)\r\n    this.scene.add(this.cameraHelper)\r\n    // 相机位置\r\n    const geometry = new THREE.BoxGeometry(10, 10, 10)\r\n    const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 })\r\n    const mesh = new THREE.Mesh(geometry, material)\r\n    mesh.position.set(500, 500, 500)\r\n    this.scene.add(mesh)\r\n\r\n    // this.initGui(this.camera)\r\n    this.InitShading()\r\n    // 控制器\r\n    this.controls = new OrbitControls(this.camera, this.mainDiv)\r\n    this.controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled\r\n    // this.controls.dampingFactor = 1.5;\r\n    this.controls.target.set(0, 0, 0)\r\n    this.controls.update()\r\n\r\n\r\n    if (showCamera2) {\r\n      this.controls2 = new OrbitControls(this.camera2, this.view2)\r\n      this.controls2.target.set(0, 0, 0)\r\n      this.controls2.update()\r\n    }\r\n\r\n    // 下面好像可有可无\r\n    // this.controls.addEventListener('change', () => {\r\n    //   // console.log('change-当前相机位置', this.camera);\r\n    //   this.renderer.render(this.scene, this.camera)\r\n    // })\r\n    // 添加模型对象\r\n    this.geometry = new ViewerGeometry(this.scene)\r\n    // 添加其它对象\r\n    this.extraGeometry = new ViewerExtraGeometry(this.scene)\r\n    // 事件\r\n    let canvasElem = this.renderer.domElement\r\n    let camera = GetDefaultCamera(Direction.Y)\r\n    console.log(camera, 'camera in GetDefaultCamera')\r\n    this.navigation = new Navigation(canvasElem,  this.mainDiv,camera, {\r\n      onUpdate: () => {\r\n        // alert('onupdate')\r\n        // 重置相机位置\r\n        this.RenderCamera()\r\n      }\r\n    })\r\n    //  高亮\r\n    this.outline = new Outline(this,this.website)\r\n    // 其它\r\n    // 坐标系辅助\r\n    let axes = new THREE.AxesHelper(1000)/// / 红线是X轴，绿线是Y轴，蓝线是Z轴\r\n    this.scene.add(axes)\r\n    //  添加网格辅助线\r\n    //  size -- 网格宽度，默认为 10.\r\n    // divisions -- 等分数，默认为 10.\r\n    // colorCenterLine -- 中心线颜色，默认 0x444444\r\n    // colorGrid --  网格线颜色，默认为 0x888888\r\n    let gridHelper = new THREE.GridHelper(10000, 100, 0x2c2c2c, 0x888888)\r\n    this.scene.add(gridHelper)\r\n    // 添加平面辅助\r\n    // const ground = new THREE.Mesh(new THREE.PlaneGeometry(200000, 200000), new THREE.MeshPhongMaterial({ color: 0x888888, shininess: 0 }))\r\n    // ground.rotation.x = -Math.PI * 0.5\r\n    // this.scene.add(ground)\r\n    this.animate()\r\n    // store.commit('website/ADD_SCENE', this.scene)\r\n  }\r\n\r\n  // gui test\r\n  initGui (camera) {\r\n    class MinMaxGUIHelper {\r\n      constructor (obj, minProp, maxProp, minDif) {\r\n        this.obj = obj\r\n        this.minProp = minProp\r\n        this.maxProp = maxProp\r\n        this.minDif = minDif\r\n      }\r\n\r\n      get min () {\r\n        return this.obj[this.minProp]\r\n      }\r\n\r\n      set min (v) {\r\n        this.obj[this.minProp] = v\r\n        this.obj[this.maxProp] = Math.max(this.obj[this.maxProp], v + this.minDif)\r\n      }\r\n\r\n      get max () {\r\n        return this.obj[this.maxProp]\r\n      }\r\n\r\n      set max (v) {\r\n        this.obj[this.maxProp] = v\r\n        this.min = this.min // this will call the min setter\r\n      }\r\n    }\r\n\r\n    function updateCamera () {\r\n      console.log(camera, 'camera updateCamera')\r\n      camera.updateProjectionMatrix()\r\n    }\r\n    const gui = new GUI()\r\n    gui.add(this.camera, 'fov', 1, 180).onChange(updateCamera)\r\n    const minMaxGUIHelper = new MinMaxGUIHelper(this.camera, 'near', 'far', 0.1)\r\n    gui.add(minMaxGUIHelper, 'min', 0.1, 50, 0.1).name('near').onChange(updateCamera)\r\n    gui.add(minMaxGUIHelper, 'max', 0.1, 30000, 0.1).name('far').onChange(updateCamera)\r\n    this.makeXYZGUI(gui, camera.position, 'position', updateCamera)\r\n  }\r\n\r\n  makeXYZGUI (gui, vector3, name, onChangeFn) {\r\n    const folder = gui.addFolder(name)\r\n    folder.add(vector3, 'x', vector3.x - 5000, vector3.x + 5000).onChange(onChangeFn)\r\n    folder.add(vector3, 'y', vector3.y - 50000, vector3.y + 5000).onChange(onChangeFn)\r\n    folder.add(vector3, 'z', vector3.z - 50000, vector3.z + 5000).onChange(onChangeFn)\r\n    folder.open()\r\n  }\r\n\r\n  //  光\r\n  InitShading () {\r\n    this.shading = new ShadingModel(this.scene)\r\n  }\r\n\r\n  // 设置背景\r\n  SetEnvironmentMapSettings (textures, useAsBackground) {\r\n    console.log(textures, useAsBackground, 'SetEnvironmentMapSettings')\r\n    this.shading.SetEnvironment(textures, useAsBackground, () => {\r\n\r\n    })\r\n    this.shading.UpdateShading()\r\n  }\r\n\r\n  // 设置相机\r\n  SetCamera (camera) {\r\n\r\n  }\r\n\r\n  //  设置dom宽高\r\n  Resize (width, height) {\r\n    console.log(width, 'width', height, 'height')\r\n    // // TODO 35\r\n    // SetDomElementOuterHeight(this.mainDiv, height);\r\n    // SetDomElementOuterWidth(this.mainDiv, width - 35);\r\n\r\n    // TODO 12\r\n    // let innerSize = GetDomElementInnerDimensions(this.mainDiv, width, height);\r\n    // SetDomElementOuterHeight(this.mainDiv, innerSize.height);\r\n    // SetDomElementOuterWidth(this.mainDiv, innerSize.width - 12);\r\n\r\n    // TODO 18\r\n    let innerSize = GetDomElementInnerDimensions(this.canvas, width, height)\r\n    // this.ResizeRenderer(innerSize.width, innerSize.height)\r\n\r\n    // this.camera.aspect = width / height\r\n    // this.camera.updateProjectionMatrix()\r\n    // TODO\r\n    console.log(this.outline, 'this.outline')\r\n    // this.outline.composer.setSize(width, height)\r\n    // this.outline.effectFXAA.uniforms.resolution.value.set(1 / window.innerWidth, 1 / window.innerHeight)\r\n\r\n    console.log(this.mainDiv.offsetWidth, 'this.mainDiv.offsetWidth')\r\n    console.log(this.mainDiv.offsetHeight, 'this.mainDiv.height')\r\n    this.ResizeRenderer(this.mainDiv.offsetWidth, this.mainDiv.offsetHeight)\r\n    // this.ResizeRenderer(width, height)\r\n  }\r\n\r\n  //  重置dom大小\r\n  ResizeRenderer (width, height) {\r\n    if (window.devicePixelRatio) {\r\n      this.renderer.setPixelRatio(window.devicePixelRatio)\r\n    }\r\n    // this.camera.aspect = window.innerWidth / window.innerHeight\r\n    this.camera.aspect = width / height\r\n    // 更新相机投影矩阵\r\n    this.camera.updateProjectionMatrix()\r\n    this.renderer.setSize(width, height)\r\n  }\r\n\r\n  // 设置模型对象\r\n  SetMainObject (object) {\r\n    // 获取模型材质类型\r\n    // const shadingType = GetShadingTypeOfObject(object)\r\n    // console.log(shadingType, 'shadingType')\r\n    console.log(object, 'object in viewer SetMainObject')\r\n    this.geometry.SetMainObject(object)\r\n\r\n    // this.shading.SetType(shadingType)\r\n  }\r\n\r\n  // 添加其它对象\r\n  AddExtraObject (object) {\r\n    this.extraGeometry.AddObject(object)\r\n  }\r\n\r\n  // 删除全部对象\r\n  Clear () {\r\n    this.geometry.Clear()\r\n    this.extraGeometry.Clear()\r\n  }\r\n\r\n  //  删除额外对象\r\n  ClearExtra () {\r\n    this.extraGeometry.Clear()\r\n  }\r\n\r\n  // 循环渲染\r\n  animate () {\r\n    requestAnimationFrame(this.animate.bind(this))\r\n    // this.renderer.render(this.scene, this.camera)\r\n    this.controls && this.controls.update()//每一帧都需要更新\r\n    this.render()\r\n  }\r\n\r\n  setScissorForElement (elem) {\r\n    // console.log(elem, 'elem in setScissorForElement')\r\n    let canvas = this.mainDiv\r\n    const canvasRect = canvas.getBoundingClientRect()\r\n    const elemRect = elem.getBoundingClientRect()\r\n\r\n    // compute a canvas relative rectangle\r\n    const right = Math.min(elemRect.right, canvasRect.right) - canvasRect.left\r\n    const left = Math.max(0, elemRect.left - canvasRect.left)\r\n    const bottom = Math.min(elemRect.bottom, canvasRect.bottom) - canvasRect.top\r\n    const top = Math.max(0, elemRect.top - canvasRect.top)\r\n\r\n    const width = Math.min(canvasRect.width, right - left)\r\n    const height = Math.min(canvasRect.height, bottom - top)\r\n\r\n    // setup the scissor to only render to that part of the canvas\r\n    const positiveYUpBottom = canvasRect.height - bottom\r\n    this.renderer.setScissor(left, positiveYUpBottom, width, height)\r\n    this.renderer.setViewport(left, positiveYUpBottom, width, height)\r\n\r\n    // return the aspect\r\n    return width / height\r\n  }\r\n\r\n  resizeRendererToDisplaySize (renderer) {\r\n    const canvas = renderer.domElement\r\n    // console.log(canvas, 'canvas1111')\r\n    const width = canvas.clientWidth\r\n    const height = canvas.clientHeight\r\n    const needResize = canvas.width !== width || canvas.height !== height\r\n    if (needResize) {\r\n      this.renderer.setSize(width, height, false)\r\n    }\r\n    return needResize\r\n  }\r\n\r\n  // 重置相机\r\n  RenderCamera () {\r\n    let navigationCamera = this.navigation.GetCamera() // 得到navigation 的新新相机位置\r\n    console.log(navigationCamera, 'navigationCamera11111111')\r\n    this.camera.position.set(navigationCamera.eye.x, navigationCamera.eye.y, navigationCamera.eye.z)\r\n    this.camera.up.set(navigationCamera.up.x, navigationCamera.up.y, navigationCamera.up.z)\r\n    this.camera.lookAt(new THREE.Vector3(navigationCamera.center.x, navigationCamera.center.y, navigationCamera.center.z))\r\n\r\n    // this.camera.aspect = this.canvas.width / this.canvas.height\r\n    // this.camera.fov = navigationCamera.fov\r\n    // this.camera.updateProjectionMatrix()\r\n    // this.renderer.render(this.scene, this.camera)\r\n    // 如果不手写控制器的方式 就得更新控制器\r\n    this.controls.target.set(navigationCamera.center.x, navigationCamera.center.y, navigationCamera.center.z)\r\n    this.controls.update()\r\n    // this.initGui(this.camera)\r\n  }\r\n\r\n  // https://blog.csdn.net/qq_41741576/article/details/99567689 裁剪\r\n  render () {\r\n    if (!this.renderer) {\r\n      return\r\n    }\r\n\r\n    if (showCamera2) {\r\n      // way1\r\n    // render the original view\r\n      let view1Elem = this.mainDiv\r\n      let view2Elem = this.view2\r\n      this.resizeRendererToDisplaySize(this.renderer)\r\n      // turn on the scissor\r\n      this.renderer.setScissorTest(true)\r\n      {\r\n        const aspect = this.setScissorForElement(view1Elem)\r\n        // const aspect = this.canvas.width / this.canvas.height\r\n        // this.renderer.setScissor(0, 0, this.canvas.width, this.canvas.height)\r\n        // this.renderer.setViewport(0, 0, this.canvas.width, this.canvas.height)\r\n        // console.log(aspect, 'aspect')\r\n        // adjust the camera for this aspect\r\n        this.camera.aspect = aspect\r\n        this.camera.updateProjectionMatrix()\r\n        this.cameraHelper.update()\r\n\r\n        // don't draw the camera helper in the original view\r\n        // this.cameraHelper.visible = true\r\n\r\n        // this.scene.background.set(0xbfd1e5) // 0x000000\r\n\r\n        // render\r\n        this.renderer.render(this.scene, this.camera)\r\n      }\r\n      // render from the 2nd camera\r\n      {\r\n        const aspect = this.setScissorForElement(view2Elem)\r\n        // const aspect = 1\r\n        // this.renderer.setScissor(0, 0, 100, 100)\r\n        // this.renderer.setViewport(0, 0, 100, 100)\r\n        // adjust the camera for this aspect\r\n        this.camera2.aspect = aspect\r\n        this.camera2.updateProjectionMatrix()\r\n\r\n        // draw the camera helper in the 2nd view\r\n        this.cameraHelper.visible = true\r\n\r\n        // this.scene.background.set(0x000040)\r\n\r\n        this.renderer.render(this.scene, this.camera2)\r\n      }\r\n\r\n      // way2\r\n      // {\r\n      //  //\r\n      // this.camera.aspect= this.canvas.width/this.canvas.height\r\n      // this.camera.updateProjectionMatrix()\r\n      // this.cameraHelper.update()\r\n      // this.cameraHelper.visible = false;\r\n      // // this.scene.background.set(0x000000);\r\n\r\n      // this.renderer.setViewport(0,0,this.canvas.width,this.canvas.height);\r\n      // this.renderer.setClearColor(0x000000,0);//设置颜色和透明度，让两个区域显示对比\r\n      // this.renderer.render(this.scene, this.camera)\r\n      // this.renderer.clearDepth();//清除深度缓存。\r\n      // }\r\n\r\n    // //启用或禁用剪裁检测. 若启用，则只有在所定义的裁剪区域内的像素才会受之后的渲染器影响\r\n    //   this.renderer.setScissorTest( true );\r\n    //  {\r\n    //   this.camera2.aspect = 1;\r\n    //   this.camera2.updateProjectionMatrix();\r\n    //   this.cameraHelper.visible = true;\r\n    //   // this.scene.background.set(0x000040);\r\n    //    //将剪裁区域设为(x, y)到(x + width, y + height)\r\n    //    this.renderer.setScissor(0,0,200,200);\r\n    //    //将视口大小设置为(x, y)到 (x + width, y + height).\r\n    //   this.renderer.setViewport(0,0,200,200);\r\n    //   // 跟随主相机的旋转角度和位置\r\n    //   // this.camera2.position.copy(this.camera.position);//复制主相机的位置\r\n    // \t// this.camera2.quaternion.copy(this.camera.quaternion);//复制主相机的四元数\r\n    //   this.renderer.setClearColor(0x222222,1);\r\n    //   this.renderer.render(this.scene,this.camera2);\r\n    //   this.renderer.setScissorTest(false);//关闭裁剪，避免裁剪主场景\r\n    //  }\r\n    } else {\r\n      this.renderer.clear()\r\n      this.renderer.render(this.scene, this.camera)\r\n    }\r\n\r\n    if (this.outline.composer != null) {\r\n      this.outline.composer.render()\r\n    }\r\n  }\r\n\r\n  // 事件\r\n  SetMouseClickHandler (onMouseClick) {\r\n    this.navigation.SetMouseClickHandler(onMouseClick)\r\n  }\r\n\r\n  SetMouseMoveHandler (onMouseMove) {\r\n    this.navigation.SetMouseMoveHandler(onMouseMove)\r\n  }\r\n\r\n  //\r\n  // 获得当前canvas 尺寸\r\n  GetCanvasSize () {\r\n    let width = this.canvas.width\r\n    let height = this.canvas.height\r\n    if (window.devicePixelRatio) {\r\n      width /= window.devicePixelRatio\r\n      height /= window.devicePixelRatio\r\n    }\r\n    return {\r\n      width: width,\r\n      height: height\r\n    }\r\n  }\r\n\r\n  // 获得鼠标点击时的mesh\r\n  GetMeshIntersectionUnderMouse (mouseCoords) {\r\n    let canvasSize = this.GetCanvasSize()\r\n    console.log(canvasSize, 'canvasSize')\r\n    let intersection = this.geometry.GetMeshIntersectionUnderMouse(mouseCoords, this.camera, canvasSize.width, canvasSize.height)\r\n    if (intersection === null) {\r\n      return null\r\n    }\r\n    return intersection\r\n  }\r\n\r\n  GetBoundingSphere (needToProcess) {\r\n    return this.geometry.GetBoundingSphere(needToProcess)\r\n  }\r\n\r\n  // 相机适配\r\n  AdjustClippingPlanesToSphere (boundingSphere) {\r\n    if (boundingSphere === null) {\r\n      return\r\n    }\r\n    if (boundingSphere.radius < 10.0) {\r\n      this.camera.near = 0.01\r\n      this.camera.far = 100.0\r\n    } else if (boundingSphere.radius < 100.0) {\r\n      this.camera.near = 0.1\r\n      this.camera.far = 1000.0\r\n    } else if (boundingSphere.radius < 1000.0) {\r\n      this.camera.near = 10.0\r\n      this.camera.far = 10000.0\r\n    } else {\r\n      this.camera.near = 100.0\r\n      this.camera.far = 1000000.0\r\n    }\r\n    this.camera.updateProjectionMatrix()\r\n    this.RenderCamera()\r\n  }\r\n\r\n  FitSphereToWindow (boundingSphere, animation) {\r\n    console.log(boundingSphere, animation, 'FitSphereToWindow')\r\n    if (boundingSphere === null) {\r\n      return\r\n    }\r\n    // let center = [boundingSphere.center.x, boundingSphere.center.y, boundingSphere.center.z]\r\n    let center = new Coord3D(boundingSphere.center.x, boundingSphere.center.y, boundingSphere.center.z)\r\n    console.log(center, 'center in  FitSphereToWindow')\r\n    let radius = boundingSphere.radius\r\n    // let newCamera = this.GetFitToSphereCamera(center, radius)\r\n    let newCamera = this.navigation.GetFitToSphereCamera(center, radius)\r\n    console.log(newCamera, 'newCamera')\r\n     // self tween 动画\r\n    // this.outline.tweenCamera(newCamera,1000)\r\n    this.navigation.MoveCamera(newCamera, animation ? this.settings.animationSteps : 60)\r\n   \r\n  }\r\n}\r\n","// 转换方法\r\nexport let ParameterConverter = {\r\n  StringToModelUrls(str) {\r\n    if (str === null || str.length === 0) {\r\n      return null;\r\n    }\r\n    return str.split(',');\r\n  },\r\n};\r\nexport class ParameterListParser {\r\n  constructor(paramList, separator) {\r\n    this.separator = separator;// 标识 $\r\n    // model=https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.obj,https://...,\r\n    this.paramList = paramList;// list\r\n  }\r\n\r\n  //  获得url数组\r\n  GetModelUrls() {\r\n    // detect legacy links\r\n    // 如果不存在=\r\n    if (this.paramList.indexOf('=') === -1) {\r\n      return this.paramList.split(',');\r\n    }\r\n    let keywordParams = this.GetKeywordParams('model');// 去掉model =\r\n    // console.log(keywordParams, 'keywordParams');\r\n    // 将url 转成数组 [url1,url2,url3...]\r\n    return ParameterConverter.StringToModelUrls(keywordParams);\r\n  }\r\n\r\n  //  关键字\r\n  GetKeywordParams(keyword) {\r\n    if (this.paramList === null || this.paramList.length === 0) {\r\n      return null;\r\n    }\r\n    let keywordToken = `${keyword}=`;\r\n    console.log(this.paramList, ' this.paramList GetKeywordParams');\r\n    // console.log(this.separator, 'this.separator');\r\n    // TODO  以$分组 如果没有数组第一项就是这个值\r\n    let urlParts = this.paramList.split(this.separator); // 以 $符号分割成数组\r\n    console.log(urlParts, 'urlParts');\r\n    for (let i = 0; i < urlParts.length; i++) {\r\n      let urlPart = urlParts[i];\r\n      if (urlPart.startsWith(keywordToken)) {\r\n        return urlPart.substring(keywordToken.length);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n}\r\nexport function CreateUrlParser(urlParams) {\r\n  // console.log(urlParams, 'urlParams');\r\n  return new ParameterListParser(urlParams, '$');\r\n}\r\n\r\n// let str = 'model=https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.obj,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.mtl,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_13_9264.jpg,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_2_7987.jpg,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_6_8580.jpg';\r\n// let n = str.split('?');\r\n// console.log(n, 'n-test');\r\n","import { CreateUrlParser } from '../engine/parameters/parameterlist.js'\r\n// http://127.0.0.1:5173/layout#model=https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.obj,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.mtl,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_13_9264.jpg,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_2_7987.jpg,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_6_8580.jpg\r\nexport class HashHandler {\r\n  constructor () {\r\n    this.eventListener = null\r\n    this.skipNextEvent = false\r\n  }\r\n\r\n  // 设置 事件监听器\r\n  SetEventListener (eventListener) {\r\n    this.eventListener = eventListener\r\n    window.onhashchange = this.OnChange.bind(this)\r\n  }\r\n\r\n  //  hash 变化触发的事件\r\n  OnChange () {\r\n    alert('OnChange')\r\n    if (this.skipNextEvent) {\r\n      alert('skipNextEvent')\r\n    }\r\n  }\r\n\r\n  // 是否有hash\r\n  HasHash () {\r\n    let hash = this.GetHash()\r\n    console.log(hash, 'hash-----')\r\n    return hash.length > 0\r\n  }\r\n\r\n  // 获得url hash\r\n  GetHash () {\r\n    // console.log(window.location.hash.substring(1), ' window.location.hash.substring(1)');\r\n    return window.location.hash.substring(1)\r\n  }\r\n\r\n  //  获得url 数组\r\n  GetModelFilesFromHash () {\r\n    // 获得实例\r\n    let parser = CreateUrlParser(this.GetHash())\r\n    return parser.GetModelUrls()\r\n  }\r\n}\r\n","// 文件来源类型\r\nexport const FileSource = {\r\n  Url: 1,\r\n  File: 2,\r\n  Decompressed: 3\r\n}\r\n// 替换url\r\nexport function TransformFileHostUrls (urls) {\r\n  for (let i = 0; i < urls.length; i++) {\r\n    let url = urls[i]\r\n    if (url.search(/www\\.dropbox\\.com/u) !== -1) {\r\n      url = url.replace('www.dropbox.com', 'dl.dropbox.com')\r\n      let separatorPos = url.indexOf('?')\r\n      if (separatorPos !== -1) {\r\n        url = url.substring(0, separatorPos)\r\n      }\r\n      urls[i] = url\r\n    } else if (url.search(/github\\.com/u) !== -1) {\r\n      url = url.replace('github.com', 'raw.githubusercontent.com')\r\n      url = url.replace('/blob', '')\r\n      let separatorPos = url.indexOf('?')\r\n      if (separatorPos !== -1) {\r\n        url = url.substring(0, separatorPos)\r\n      }\r\n      urls[i] = url\r\n    }\r\n    console.log(urls, 'TransformFileHostUrls')\r\n  }\r\n}\r\n// 获取文件名\r\n\r\nexport function GetFileName (filePath) {\r\n  // console.log(filePath, 'filePath');\r\n  let firstSeparator = filePath.lastIndexOf('/')\r\n  // console.log(firstSeparator, 'firstSeparator');\r\n  if (firstSeparator === -1) {\r\n    firstSeparator = filePath.lastIndexOf('\\\\')\r\n  }\r\n  let fileName = filePath\r\n  if (firstSeparator !== -1) {\r\n    fileName = filePath.substring(firstSeparator + 1)\r\n  }\r\n  // TODO 如果带问号\r\n  let firstParamIndex = fileName.indexOf('?')\r\n  if (firstParamIndex !== -1) {\r\n    fileName = fileName.substring(0, firstParamIndex)\r\n  }\r\n  // console.log(fileName, 'fileName');\r\n  // console.log(decodeURI(fileName), 'decodeURI');\r\n  // decodeURI() 函数可对 encodeURI() 函数编码过的 URI 进行解码\r\n  return decodeURI(fileName)\r\n}\r\n\r\n// 获取别名\r\nexport function GetFileExtension (filePath) {\r\n  let fileName = GetFileName(filePath)\r\n  // console.log(fileName, 'filenName in GetFileExtension')\r\n  let firstPoint = fileName.lastIndexOf('.')\r\n  console.log(firstPoint, 'firstPoint in GetFileExtension')// 最后出现的位置\r\n  if (firstPoint === -1) {\r\n    return ''\r\n  }\r\n  let extension = fileName.substring(firstPoint + 1)\r\n  return extension.toLowerCase()\r\n}\r\n\r\n// 通过url的方式\r\nexport function RequestUrl (url, onProgress) {\r\n  return new Promise((resolve, reject) => {\r\n    console.log(url, 'url in RequestUrl')\r\n    let request = new XMLHttpRequest()\r\n    request.open('GET', url, true)\r\n    request.onprogress = (event) => {\r\n      onProgress(event.loaded, event.total)\r\n    }\r\n    request.onload = () => {\r\n      console.log(request, 'request in RequestUrl')\r\n      if (request.status === 200) {\r\n        resolve(request.response)\r\n      } else {\r\n        reject()\r\n      }\r\n    }\r\n\r\n    request.onerror = () => {\r\n      reject()\r\n    }\r\n    request.responseType = 'arraybuffer'\r\n    request.send(null)\r\n  })\r\n}\r\nexport function RequestUrl2 (url, onProgress) {\r\n  return new Promise((resolve, reject) => {\r\n    console.log(url, 'url in RequestUrl')\r\n    let request = new XMLHttpRequest()\r\n    request.open('GET', url, true)\r\n    request.onprogress = (event) => {\r\n      onProgress(event.loaded, event.total)\r\n    }\r\n    request.onload = () => {\r\n      console.log(request, 'request in RequestUrl')\r\n      if (request.status === 200) {\r\n        resolve(request.response)\r\n      } else {\r\n        reject()\r\n      }\r\n    }\r\n\r\n    request.onerror = () => {\r\n      reject()\r\n    }\r\n    request.responseType = 'blob'\r\n    request.send(null)\r\n  })\r\n}\r\n// 通过拖拽的方式\r\nexport function ReadFile (file, onProgress) {\r\n  return new Promise((resolve, reject) => {\r\n    let reader = new FileReader()\r\n\r\n    reader.onprogress = (event) => {\r\n      onProgress(event.loaded, event.total)\r\n    }\r\n\r\n    reader.onloadend = (event) => {\r\n      if (event.target.readyState === FileReader.DONE) {\r\n        resolve(event.target.result)\r\n      }\r\n    }\r\n\r\n    reader.onerror = () => {\r\n      reject()\r\n    }\r\n\r\n    reader.readAsArrayBuffer(file)\r\n  })\r\n}\r\nexport function testasync () {\r\n  return new Promise((resolve, reject) => {\r\n    resolve({\r\n      msg: 'success'\r\n    })\r\n  })\r\n}\r\n","let eventHandlerFunc = null;\r\n\r\nexport function SetEventHandler(eventHandler) {\r\n  eventHandlerFunc = eventHandler;\r\n}\r\n\r\nexport function HandleEvent(eventName, eventLabel, eventParams) {\r\n  if (eventHandlerFunc === undefined || eventHandlerFunc === null) {\r\n    return;\r\n  }\r\n  eventHandlerFunc(eventName, eventLabel, eventParams);\r\n}\r\n","export class TaskRunner {\r\n  constructor () {\r\n    this.count = null\r\n    this.current = null\r\n    this.callbacks = null\r\n  }\r\n\r\n  // 执行 connt :5\r\n  Run (count, callbacks) {\r\n    this.count = count\r\n    this.current = 0\r\n    this.callbacks = callbacks\r\n    if (count === 0) {\r\n      alert('run 0')\r\n      // this.TaskReady ();\r\n    } else {\r\n      this.RunOnce()\r\n    }\r\n  }\r\n\r\n  // TODO 如果当前文件卡住会不会跳过先执行其它异步任务\r\n  // 异步执行\r\n  RunOnce () {\r\n    console.log(this.callbacks, 'this.callbacks in RunOnce ')\r\n    // this.callbacks.runTask(this.current, this.TaskReady.bind(this))\r\n    setTimeout(() => {\r\n      this.callbacks.runTask(this.current, this.TaskReady.bind(this))\r\n    }, 0)\r\n  }\r\n\r\n  TaskReady () {\r\n    // console.log(this, 'gaga')\r\n    this.current += 1\r\n    if (this.current < this.count) {\r\n      this.RunOnce()\r\n    } else {\r\n      // 如果执行完了\r\n      if (this.callbacks.onReady) {\r\n        this.callbacks.onReady()\r\n      }\r\n    }\r\n  }\r\n}\r\nexport function RunTasks (count, callbacks) {\r\n  let taskRunner = new TaskRunner()\r\n  taskRunner.Run(count, callbacks)\r\n}\r\n","import { FileSource, GetFileName, GetFileExtension, RequestUrl, ReadFile, testasync } from '../io/fileutils.js'\r\nimport { RunTasks } from '../core/taskrunner.js'\r\n// 测试例子\r\nclass TestFile {\r\n  constructor () {\r\n    this.content = null\r\n  }\r\n\r\n  SetContent (content) {\r\n    this.content = content\r\n  }\r\n}\r\nlet testfile = new TestFile()\r\nlet testPromise = testasync()\r\nfunction test (testfile) {\r\n  testPromise.then((content) => {\r\n    console.log(testfile, 'testfile in testPromise')\r\n    // testfile = content\r\n    testfile.SetContent(content) //\r\n    console.log(testfile, 'testfile2 in testPromise')\r\n    console.log(content, 'content in testPromise')\r\n  }).catch(() => {\r\n  }).finally(() => {\r\n    console.log('testPromise-finally')\r\n  })\r\n}\r\ntest(testfile)\r\n\r\nexport class ImporterFile {\r\n  constructor (name, source, data) {\r\n    this.name = GetFileName(name)\r\n    this.extension = GetFileExtension(name)\r\n    // this.name = name\r\n    // this.extension = name\r\n    this.source = source\r\n    this.data = data\r\n    this.content = null\r\n  }\r\n\r\n  SetContent (content) {\r\n    this.content = content\r\n  }\r\n}\r\n// 包含五个选项的files\r\nexport class ImporterFileList {\r\n  constructor () {\r\n    this.files = []\r\n  }\r\n\r\n  GetFiles () {\r\n    return this.files\r\n  }\r\n\r\n  // 执行异步任务获取内容\r\n  GetContent (callbacks) {\r\n    console.log('GetContent-3')\r\n    // 此时的files 已经被FillFromInputFiles 赋值过 ，并不是一个新的new 实例\r\n    console.log(this.files, 'this.files in GetContent')\r\n    RunTasks(this.files.length, {\r\n\r\n      runTask: (index, onTaskComplete) => {\r\n        callbacks.onFileListProgress(index, this.files.length)\r\n        console.log('GetContent-5')// 同步测试 1352 异步 132 5 5为异步最后执行\r\n        console.log(index, 'index in RunTask')\r\n        console.log(onTaskComplete, 'onTaskComplete in RunTask')\r\n        // 获取文件内容\r\n        this.GetFileContent(this.files[index], {\r\n          // onReady: () => {\r\n          //   alert('当前执行完 执行下一个任务')// onTaskComplete\r\n          // },\r\n          onReady: onTaskComplete,\r\n          onProgress: callbacks.onFileLoadProgress\r\n        })\r\n      },\r\n      onReady: callbacks.onReady\r\n    })\r\n  }\r\n\r\n  // TODO\r\n  // http://localhost:8080/127new#model=https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_6_8580.jpg,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.obj,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.mtl,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_13_9264.jpg,https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/Mat3d66_1265862_2_7987.jpg\r\n  GetFileContent (file, callbacks) {\r\n    if (file.content !== null) {\r\n      callbacks.onReady()// 继续执行下一步\r\n      return\r\n    } else {\r\n\r\n    }\r\n    // TODO 如果下面异步 SetContent 这里file content 中已经有content\r\n    console.log(file, 'file in GetFileContent')// 第一个有可能时obj mtl 或jpj\r\n    let loaderPromise = null\r\n    // 如果是从url加载过来的\r\n    if (file.source === FileSource.Url) {\r\n      loaderPromise = RequestUrl(file.data, callbacks.onProgress)\r\n      console.log(loaderPromise, 'loaderPromise')\r\n    } else if (file.source === FileSource.File) {\r\n      loaderPromise = ReadFile(file.data, callbacks.onProgress)\r\n    }\r\n    // 异步测试   1 ，3  2 finally\r\n    console.log('loaderPromise1')\r\n    loaderPromise.then((content) => {\r\n      // debugger\r\n      // alert(file.content)// null\r\n      console.log(content, 'content in GetFileContent')\r\n      // TODO 没有设置 已经有内容了 难道是因为file是类的实例传过来的原因？ 好像是谷歌浏览器的bug\r\n      console.log(file, 'file in loaderPromise')\r\n      file.SetContent(content)\r\n      // alert(file.content)\r\n      // console.log(file, 'file in loaderPromise2')\r\n    }).catch(() => {\r\n    }).finally(() => {\r\n      console.log('finally')\r\n      callbacks.onReady()\r\n    })\r\n    console.log('loaderPromise3')\r\n  }\r\n\r\n  FillFromInputFiles (inputFiles) {\r\n    this.files = []\r\n    for (let inputFile of inputFiles) {\r\n      let file = new ImporterFile(inputFile.name, inputFile.source, inputFile.data)\r\n      this.files.push(file)\r\n    }\r\n  }\r\n}\r\nexport class InputFile {\r\n  constructor (name, source, data) {\r\n    this.name = name\r\n    this.source = source\r\n    this.data = data\r\n  }\r\n}\r\n// 通过url的方式\r\nexport function InputFilesFromUrls (urls) {\r\n  let inputFiles = []\r\n  for (let url of urls) {\r\n    let fileName = GetFileName(url)\r\n    inputFiles.push(new InputFile(fileName, FileSource.Url, url))\r\n  }\r\n  return inputFiles\r\n}\r\n// 通过拖拽\r\nexport function InputFilesFromFileObjects (fileObjects) {\r\n  let inputFiles = []\r\n  for (let fileObject of fileObjects) {\r\n    let fileName = GetFileName(fileObject.name)\r\n    inputFiles.push(new InputFile(fileName, FileSource.File, fileObject))\r\n  }\r\n  return inputFiles\r\n}\r\n","export class ImporterBase {\r\n  constructor () {\r\n    this.name = null\r\n    this.extension = null\r\n    this.callbacks = null\r\n    this.model = null\r\n    this.error = null\r\n    this.message = null\r\n  }\r\n}\r\n","import { ImporterBase } from './importerbase.js'\r\nexport class ImporterObj extends ImporterBase {\r\n  constructor () {\r\n    super()\r\n  }\r\n\r\n  CanImportExtension (extension) {\r\n    return extension === 'obj'\r\n  }\r\n}\r\n","// return return 可以跳出循环，同时阻止后面代码的执行，在js中return语句只能放在函数中。若只有循环则会报错\r\n//     function fn () {\r\n//   for (var i = 1; i <= 5; i++) {\r\n//     if (i === 3) {\r\n//       return false   // a为 false\r\n//       // return      // a为 undefine\r\n//     }\r\n//     console.log(i); // 分别输出  1，2\r\n//   }\r\n//   console.log('end'); // 未执行\r\n// }\r\n// fn();\r\n// const a = fn()\r\nimport * as THREE from 'three'\r\nimport { ImporterFileList } from './importerfiles.js'\r\nimport { ImporterObj } from './importerobj.js'\r\nexport class Importer {\r\n  constructor () {\r\n    this.importers = [\r\n      new ImporterObj()\r\n    ]\r\n    // console.log(this.importers, 'this.importers')\r\n    this.fileList = new ImporterFileList()\r\n    // console.log(this.fileList, 'this.fileList')\r\n  }\r\n\r\n  ImportFiles (inputFiles, settings, callbacks) {\r\n    callbacks.onLoadStart()// 开始\r\n    this.LoadFiles(inputFiles, {\r\n      // 如果不是异步 ，callback里同步执行 加载文件内容的时候 不能执行其它操作\r\n      onReady: () => {\r\n        console.log(this.fileList, 'GetContent-0')\r\n        // 因为是最后执行 在这里进行文件的引入\r\n        callbacks.onImportStart()\r\n        // ....\r\n      },\r\n      onFileListProgress: callbacks.onFileListProgress,\r\n      onFileLoadProgress: callbacks.onFileLoadProgress\r\n    })\r\n  }\r\n\r\n  LoadFiles (inputFiles, callbacks) {\r\n    // 拷贝一份\r\n    let newFileList = new ImporterFileList()\r\n    newFileList.FillFromInputFiles(inputFiles)\r\n    console.log(JSON.stringify(newFileList), 'newFileList')\r\n    let reset = false\r\n    // 如果支持有\r\n    if (this.HasImportableFile(newFileList)) {\r\n      reset = true\r\n    } else {\r\n      // 进行缺失文件判断\r\n      // alert('没有相应的loader')\r\n    }\r\n    // 如果有复制给fileList\r\n    if (reset) {\r\n      // console.log(this.fileList, 'this.fileList1')\r\n      this.fileList = newFileList\r\n      // console.log(this.fileList, 'this.fileList2')\r\n    }\r\n    console.log('GetContent-1')\r\n    this.fileList.GetContent({\r\n      onReady: callbacks.onReady,\r\n      onFileListProgress: callbacks.onFileListProgress,\r\n      onFileLoadProgress: callbacks.onFileLoadProgress\r\n    })\r\n    console.log('GetContent-2')\r\n    // TODO 为什么要异步\r\n    console.log(this.fileList, 'this.fileList in LoadFiles')\r\n  }\r\n\r\n  // 是否有可疑解析的loader\r\n  HasImportableFile (fileList) {\r\n    let importableFiles = this.GetImportableFiles(fileList)\r\n    return importableFiles.length > 0\r\n  }\r\n\r\n  // 获得 [file,importer]数组\r\n  GetImportableFiles (fileList) {\r\n    function FindImporter (file, importers) {\r\n      // 遍历importers 是否有可以解析文件后缀的别明的loader\r\n      for (let importerIndex = 0; importerIndex < importers.length; importerIndex++) {\r\n        let importer = importers[importerIndex]\r\n        if (importer.CanImportExtension(file.extension)) {\r\n          console.log(importer, 'importer in GetImportableFiles')\r\n          return importer\r\n        }\r\n      }\r\n      //\r\n      return null\r\n    }\r\n    let importableFiles = []\r\n    let files = fileList.GetFiles()// 获得ImporterFileList类的files\r\n    console.log(files, 'files in GetImportableFiles')\r\n    // 遍历文件找到对应的类型文件和importer\r\n    for (let fileIndex = 0; fileIndex < files.length; fileIndex++) {\r\n      let file = files[fileIndex]\r\n      // 遍历importer\r\n      let importer = FindImporter(file, this.importers)\r\n      // console.log(importer, 'importer in GetImportableFiles')\r\n      if (importer !== null) {\r\n        importableFiles.push({\r\n          file: file,\r\n          importer: importer\r\n        })\r\n        console.log(importableFiles, 'importableFiles  inGetImportableFiles')\r\n      }\r\n    }\r\n    return importableFiles\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { Importer } from '../import/importer.js'\r\nexport class ThreeModelLoader {\r\n  constructor () {\r\n    // 加载状态\r\n    this.inProgress = false\r\n    this.importer = new Importer()\r\n  }\r\n\r\n  InProgress () {\r\n    return this.inProgress\r\n  }\r\n\r\n  LoadModel (inputFiles, settings, callbacks) {\r\n    if (this.inProgress) {\r\n      // return\r\n    }\r\n    this.inProgress = true\r\n    // this.RevokeObjectUrls ();\r\n    this.importer.ImportFiles(inputFiles, settings, {\r\n      onLoadStart: () => {\r\n        callbacks.onLoadStart()\r\n      },\r\n      onFileListProgress: (current, total) => {\r\n        callbacks.onFileListProgress(current, total)\r\n      },\r\n      onFileLoadProgress: (current, total) => {\r\n        callbacks.onFileLoadProgress(current, total)\r\n      },\r\n      onImportStart: () => {\r\n        callbacks.onImportStart()\r\n      },\r\n      onSelectMainFile: () => {\r\n\r\n      },\r\n      onImportSuccess: () => {\r\n        callbacks.onVisualizationStart()\r\n      },\r\n      onImportError: (importError) => {\r\n        callbacks.onLoadError(importError)\r\n      }\r\n    })\r\n  }\r\n}\r\n","// 加载模型的loader\r\nimport { ThreeModelLoader } from '../engine/threejs/threemodelloader.js'\r\nexport class ThreeModelLoaderUI {\r\n  constructor () {\r\n    this.modelLoader = new ThreeModelLoader()\r\n  }\r\n\r\n  LoadModel (inputFiles, settings, callbacks) {\r\n    console.log(inputFiles, 'inputFiles in ThreeModelLoaderUI')\r\n    console.log(settings, 'settings')\r\n    console.log(callbacks, 'callbacks')\r\n    if (this.modelLoader.InProgress()) {\r\n      return\r\n      // 如果正在进行 下面不再执行\r\n    }\r\n\r\n    this.modelLoader.LoadModel(inputFiles, settings, {\r\n      onLoadStart: () => {\r\n        callbacks.onStart()\r\n      },\r\n      // 读取文件进度list\r\n      onFileListProgress: (current, total) => {\r\n        console.log(current, total, 'onFileListProgress文件进度')\r\n      },\r\n      // 文件getcontent 进行时\r\n      onFileLoadProgress: (current, total) => {\r\n        console.log(current, total, 'onFileLoadProgress')// 如果文件大 就会有多条\r\n      },\r\n      onSelectMainFile: () => {},\r\n      onImportStart: () => {},\r\n      onVisualizationStart: () => {},\r\n      onModelFinished: () => {},\r\n      onTextureLoaded: () => {},\r\n      onLoadError: () => {}\r\n    })\r\n  }\r\n}\r\n","// let a = 1\r\n// a++\r\n// let b = a\r\n// console.log(b, 'b22222222')\r\n// console.log(a, 'a1111111111')\r\nimport { FileSource, GetFileName, GetFileExtension, RequestUrl, RequestUrl2, ReadFile, testasync } from '../engine/io/fileutils.js'\r\nimport { RunTasks } from '../engine/core/taskrunner.js'\r\n\r\nclass InputFile {\r\n  constructor (name, source, data) {\r\n    this.name = name\r\n    this.source = source\r\n    this.data = data\r\n  }\r\n}\r\nexport class ImporterFile {\r\n  constructor (name, source, data) {\r\n    this.name = GetFileName(name)\r\n    this.extension = GetFileExtension(name)\r\n    this.source = source\r\n    this.data = data\r\n    this.content = null\r\n    this.size = data.size\r\n  }\r\n\r\n  SetContent (content) {\r\n    this.content = content\r\n    console.log(this, content, 'this in setContent')\r\n  }\r\n\r\n  setSize (size) {\r\n    this.size = size\r\n  }\r\n}\r\nexport class ImporterFileList {\r\n  constructor () {\r\n    this.files = []\r\n  }\r\n\r\n  GetFiles () {\r\n    return this.files\r\n  }\r\n\r\n  FillFromInputFiles (inputFiles) {\r\n    this.files = []\r\n    for (let inputFile of inputFiles) {\r\n      let file = new ImporterFile(inputFile.name, inputFile.source, inputFile.data)\r\n      this.files.push(file)\r\n    }\r\n  }\r\n\r\n  // 设置内容和大小\r\n  GetContent (callbacks) {\r\n    console.log(this.files, 'this.files in GetContent')\r\n    RunTasks(this.files.length, {\r\n      runTask: (index, onTaskComplete) => {\r\n        console.log(index, 'index in runTask')\r\n        // 文件加载进度\r\n        callbacks.onFileListProgress(index, this.files.length)\r\n        this.GetFileContent(this.files[index], {\r\n          onReady: onTaskComplete,\r\n          // onProgress: callbacks.onFileLoadProgress,\r\n          onProgress: (loaded, total) => {\r\n            console.log(loaded, total, 'load onProgress')\r\n            // 设置文件大小\r\n            this.files[index].setSize(total)\r\n            callbacks.onFileLoadProgress(loaded, total)\r\n          }\r\n        })\r\n      },\r\n      // 设置content完毕后的事件\r\n      onReady: callbacks.onReady\r\n    })\r\n  }\r\n\r\n  GetFileContent (file, callbacks) {\r\n    console.log(file, ' file in GetFileContent')\r\n    let loaderPromise = null\r\n    if (file.source === FileSource.Url) {\r\n      loaderPromise = RequestUrl(file.data, callbacks.onProgress)// callback onprogess\r\n    } else if (file.source === FileSource.File) {\r\n      loaderPromise = ReadFile(file.data, callbacks.onProgress)\r\n    }\r\n    loaderPromise.then((content) => {\r\n      console.log(content, file, 'content in loaderPromise')\r\n      file.SetContent(content)\r\n      console.log(content, file, 'content in loaderPromise2')\r\n    }).catch((err) => {\r\n\r\n    }).finally(() => {\r\n      callbacks.onReady()\r\n    })\r\n  }\r\n}\r\n// 通过url的方式\r\nexport function InputFilesFromUrls (urls) {\r\n  let inputFiles = []\r\n  for (let url of urls) {\r\n    console.log(url, 'url in InputFilesFromUrls')\r\n    let fileName = GetFileName(url)\r\n    inputFiles.push(new InputFile(fileName, FileSource.Url, url))\r\n  }\r\n  return inputFiles\r\n}\r\n// 通过拖拽\r\nexport function InputFilesFromFileObjects (fileObjects) {\r\n  let inputFiles = []\r\n  for (let fileObject of fileObjects) {\r\n    console.log(fileObject, 'fileObject')\r\n    let fileName = GetFileName(fileObject.name)\r\n    inputFiles.push(new InputFile(fileName, FileSource.File, fileObject, fileObject.size))\r\n  }\r\n  return inputFiles\r\n}\r\nconst LoaderUtils = {\r\n  createFilesMap: function (files) {\r\n    // const map = {}\r\n\r\n    // for (let i = 0; i < files.length; i++) {\r\n    //   const file = files[i]\r\n    //   map[file.name] = file\r\n    // }\r\n\r\n    // return map\r\n\r\n    const map = new Map()\r\n    for (let i = 0; i < files.length; i++) {\r\n      const file = files[i]\r\n      map.set(file.name, files[i])\r\n    }\r\n    return map\r\n  },\r\n  getFilesFromItemList: function (items, onDone) {\r\n      \t// TOFIX: setURLModifier() breaks when the file being loaded is not in root\r\n    let itemsCount = 0\r\n    let itemsTotal = 0\r\n    const files = []// file 数组\r\n    const filesMap = {}\r\n    function onEntryHandled () {\r\n      // // https://blog.csdn.net/dylanns/article/details/101437724\r\n      itemsCount++ // a++称为“后增量”，++a称为“前增量”。\r\n      console.log(itemsCount, 'itemsCount')\r\n      if (itemsCount === itemsTotal) { // 加载完毕 同步的方式\r\n        onDone(files, filesMap)\r\n      }\r\n    }\r\n    function handleEntry (entry) {\r\n      // 如果时目录递归调用\r\n      if (entry.isDirectory) {\r\n        const reader = entry.createReader()\r\n        reader.readEntries(function (entries) {\r\n          for (let i = 0; i < entries.length; i++) {\r\n            handleEntry(entries[i])\r\n          }\r\n          onEntryHandled()\r\n        })\r\n      } else if (entry.isFile) {\r\n        entry.file(function (file) {\r\n          console.log(file, 'file in entry.file')\r\n          files.push(file)\r\n          // filesMap[entry.fullPath.slice(1)] = file //fullPath :\"/beats_highpoly.fbx\"\r\n          filesMap[entry.name] = file // {name:file}\r\n\r\n          onEntryHandled()\r\n        })\r\n        console.log(entry, 'entry ')\r\n        console.log(files, 'files in handleEntry')\r\n      }\r\n      itemsTotal++ // 每次执行完一个文件+1\r\n    }\r\n    for (let i = 0; i < items.length; i++) {\r\n      const item = items[i]\r\n      console.log(item, 'item in getFilesFromItemList')\r\n      // 如果是文件\r\n      if (item.kind === 'file') {\r\n        console.log(item.webkitGetAsEntry(), 'item.webkitGetAsEntry()')\r\n        handleEntry(item.webkitGetAsEntry())\r\n      }\r\n    }\r\n  }\r\n}\r\nexport { LoaderUtils }\r\n","export function ArrayBufferToUtf8String (buffer) {\r\n  let decoder = new TextDecoder('utf-8')\r\n  return decoder.decode(buffer)\r\n}\r\n\r\nexport function ArrayBufferToAsciiString (buffer) {\r\n  let text = ''\r\n  let bufferView = new Uint8Array(buffer)\r\n  for (let i = 0; i < bufferView.byteLength; i++) {\r\n    text += String.fromCharCode(bufferView[i])\r\n  }\r\n  return text\r\n}\r\n\r\nexport function AsciiStringToArrayBuffer (str) {\r\n  let buffer = new ArrayBuffer(str.length)\r\n  let bufferView = new Uint8Array(buffer)\r\n  for (let i = 0; i < str.length; i++) {\r\n    bufferView[i] = str.charCodeAt(i)\r\n  }\r\n  return buffer\r\n}\r\n\r\nexport function Utf8StringToArrayBuffer (str) {\r\n  let encoder = new TextEncoder()\r\n  let uint8Array = encoder.encode(str)\r\n  return uint8Array.buffer\r\n}\r\n\r\nexport function Base64DataURIToArrayBuffer (uri) {\r\n  let dataPrefix = 'data:'\r\n  if (!uri.startsWith(dataPrefix)) {\r\n    return null\r\n  }\r\n\r\n  let mimeSeparator = uri.indexOf(';')\r\n  if (mimeSeparator === -1) {\r\n    return null\r\n  }\r\n\r\n  let bufferSeparator = uri.indexOf(',')\r\n  if (bufferSeparator === -1) {\r\n    return null\r\n  }\r\n\r\n  let mimeType = uri.substring(dataPrefix.length, dataPrefix.length + mimeSeparator - 5)\r\n  let base64String = atob(uri.substring(bufferSeparator + 1))\r\n  let buffer = new ArrayBuffer(base64String.length)\r\n  let bufferView = new Uint8Array(buffer)\r\n  for (let i = 0; i < base64String.length; i++) {\r\n    bufferView[i] = base64String.charCodeAt(i)\r\n  }\r\n\r\n  return {\r\n    mimeType: mimeType,\r\n    buffer: buffer\r\n  }\r\n}\r\n\r\nexport function GetFileExtensionFromMimeType (mimeType) {\r\n  if (mimeType === undefined || mimeType === null) {\r\n    return ''\r\n  }\r\n  let mimeParts = mimeType.split('/')\r\n  if (mimeParts.length === 0) {\r\n    return ''\r\n  }\r\n  return mimeParts[mimeParts.length - 1]\r\n}\r\n\r\nexport function CreateObjectUrl (content) {\r\n  let blob = new Blob([content])\r\n  let url = URL.createObjectURL(blob)\r\n  return url\r\n}\r\n\r\nexport function CreateObjectUrlWithMimeType (content, mimeType) {\r\n  let blob = new Blob([content], { type: mimeType })\r\n  let url = URL.createObjectURL(blob)\r\n  return url\r\n}\r\n\r\nexport function RevokeObjectUrl (url) {\r\n  URL.revokeObjectURL(url)\r\n}\r\n","// URL.revokeObjectURL() 静态方法用来释放一个之前已经存在的、通过调用 URL.createObjectURL() 创建的 URL 对象。当你结束使用某个 URL 对象之后，应该通过调用这个方法来让浏览器知道不用在内存中继续保留对这个文件的引用了。\r\nimport * as THREE from 'three'\r\nimport { TGALoader } from 'three/addons/loaders/TGALoader.js'\r\nimport { LoaderUtils } from './LoaderUtils.js'\r\nimport { RevokeObjectUrl } from '../engine/io/bufferutils.js'\r\n\r\nfunction addLoadModeltoScene (object, callbacks) {\r\n  // editor.execute(new AddObjectCommand(editor, object)))\r\n  // (1) 通过传递过来的scene 添加的方式 this 指向必须改为箭头函数\r\n  // this.viewer.scene.add(object)\r\n  // （2） 通过callbacks 的方式 来自website传递过来的callback\r\n  // callbacks.render(object)\r\n  callbacks.onModelFinished(object)\r\n  // (3)通过传递函数的方式\r\n  // (4) 发布订阅 vuex的方式\r\n  // (5) 通过sinals 的方式\r\n}\r\nvar that;\r\nexport class DragLoader {\r\n  constructor (viewer) {\r\n    that = this;\r\n    this.viewer = viewer\r\n    this.callbacks = null\r\n    // 使用URL回调初始化加载管理器。\r\n    this.objectURLs = []\r\n  }\r\n\r\n  // 释放file blob内存\r\n  RevokeObjectUrls () {\r\n    console.log(this.objectURLs, 'this.objectURLs in RevokeObjectUrls')\r\n    if (this.objectURLs === null) {\r\n      return\r\n    }\r\n    for (let objectUrl of this.objectURLs) {\r\n      RevokeObjectUrl(objectUrl)\r\n    }\r\n    this.objectURLs = []\r\n  }\r\n\r\n  DragLoadFiles (files, filesMap, callbacks) {\r\n    this.callbacks = callbacks\r\n    if (files.length > 0) {\r\n      console.log(files, 'files in DragLoadFiles')\r\n      filesMap = filesMap || LoaderUtils.createFilesMap(files)\r\n      console.log(filesMap, 'filesMap in DragLoadFiles')\r\n      // TODO\r\n      // https://blog.csdn.net/damadashen/article/details/125695071\r\n      // 处理并跟踪已加载和待处理的数据\r\n      const manager = new THREE.LoadingManager()\r\n      // // 执行顺序   开始  错误 过程中 完成\r\n      // // 开始\r\n      // manager.onStart = function (url, itemsLoaded, itemsTotal) {\r\n      //   console.log('开始-Started loading file: ' + url + '.\\nLoaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.')\r\n      // }\r\n      // // 完成\r\n      // manager.onLoad = function () {\r\n      //   console.log('完成-Loading complete!')\r\n      // }\r\n      // // 过程中\r\n      // manager.onProgress = function (url, itemsLoaded, itemsTotal) {\r\n      //   console.log('过程中-Loading file: ' + url + '.\\nLoaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.')\r\n      // }\r\n      // // 错误\r\n      // manager.onError = function (url) {\r\n      //   console.log('错误-There was an error loading ' + url)\r\n      // }\r\n\r\n      // 覆写资源URL\r\n      // manager.setURLModifier((url) => {\r\n\r\n      // })\r\n      // 如果本身是blob url\r\n      manager.setURLModifier((url) => {\r\n        console.log(url, 'url in setURLModifier')\r\n        url = url.replace(/^(\\.?\\/)/, '') // remove './'\r\n        const file = filesMap[url]\r\n        console.log('file-url', file)\r\n        if (file) {\r\n          console.log('Loading in setURLModifier', url)\r\n          console.log(URL.createObjectURL(file), 'URL.createObjectURL(file)')\r\n          this.objectURLs.push(URL.createObjectURL(file))\r\n          return URL.createObjectURL(file)\r\n        } else {\r\n          // alert(`缺少${url}`)\r\n        }\r\n\r\n        return url\r\n      })\r\n      console.log(this.objectURLs, 'objectURLs')\r\n      // tga 格式纹理\r\n      manager.addHandler(/\\.tga$/i, new TGALoader())\r\n      for (let i = 0; i < files.length; i++) {\r\n        this.DragLoadFile(files[i], manager, callbacks)\r\n      }\r\n    }\r\n  }\r\n\r\n  // 一个个读取文件\r\n  DragLoadFile (file, manager, callbacks) {\r\n    console.log(this, 'this in DragLoadFile')\r\n    const filename = file.name\r\n    const extension = filename.split('.').pop().toLowerCase()\r\n    const reader = new FileReader()\r\n    reader.addEventListener('progress', function (event) {\r\n      const size = '(' + Math.floor(event.total / 1000).format() + ' KB)'\r\n      const progress = Math.floor((event.loaded / event.total) * 100) + '%'\r\n\r\n      console.log('Loading', filename, size, progress)\r\n    })\r\n    switch (extension) {\r\n      case 'fbx':\r\n\r\n      {\r\n        reader.addEventListener('load', async function (event) {\r\n          const contents = event.target.result\r\n\r\n          const { FBXLoader } = await import('three/addons/loaders/FBXLoader.js')\r\n\r\n          const loader = new FBXLoader(manager)\r\n          const object = loader.parse(contents)\r\n\r\n          console.log(this.objectURLs, 'this.objectURLs in fbx')\r\n          // this.objectURLs.forEach((url) => {\r\n          //   // TODO  URL.revokeObjectURL(url)\r\n          //   // 撤销blob\r\n          //   console.log(url, URL.revokeObjectURL(url), 'URL.revokeObjectURL(url)')\r\n          //   return URL.revokeObjectURL(url)\r\n          // })\r\n          //  that.viewer.scene.add(object)  //ok\r\n          // this.viewer.scene.add.call(that.viewer.scene,object) err\r\n          // console.log(this, 'this in dragloader') //必须是箭头函数才能指向当前类 否则指向fileReader\r\n          addLoadModeltoScene(object, callbacks)\r\n        }, false)\r\n        reader.readAsArrayBuffer(file)\r\n\r\n        break\r\n      }\r\n      case 'obj':\r\n\r\n      {\r\n        reader.addEventListener('load', async function (event) {\r\n          const contents = event.target.result\r\n\r\n          const { OBJLoader } = await import('three/addons/loaders/OBJLoader.js')\r\n\r\n          const object = new OBJLoader().parse(contents)\r\n          object.name = filename\r\n\r\n          // editor.execute(new AddObjectCommand(editor, object))\r\n\r\n          addLoadModeltoScene(object, callbacks)\r\n        }, false)\r\n        reader.readAsText(file)\r\n\r\n        break\r\n      }\r\n    }\r\n  }\r\n}\r\n","let externalLibLocation = null\r\nlet loadedExternalLibs = new Set()\r\n\r\nexport function SetExternalLibLocation (newExternalLibLocation) {\r\n  externalLibLocation = newExternalLibLocation\r\n}\r\n\r\nexport function GetExternalLibPath (libName) {\r\n  if (externalLibLocation === null) {\r\n    return null\r\n  }\r\n  return externalLibLocation + '/' + libName\r\n}\r\n\r\nexport function LoadExternalLibrary (libName) {\r\n  return new Promise((resolve, reject) => {\r\n    if (externalLibLocation === null) {\r\n      reject()\r\n      return\r\n    }\r\n\r\n    if (loadedExternalLibs.has(libName)) {\r\n      resolve()\r\n      return\r\n    }\r\n\r\n    let scriptElement = document.createElement('script')\r\n    scriptElement.type = 'text/javascript'\r\n    scriptElement.src = GetExternalLibPath(libName)\r\n    scriptElement.onload = () => {\r\n      loadedExternalLibs.add(libName)\r\n      resolve()\r\n    }\r\n    scriptElement.onerror = () => {\r\n      reject()\r\n    }\r\n    document.head.appendChild(scriptElement)\r\n  })\r\n}\r\n","import * as THREE from 'three'\r\nimport { LoaderUtils, InputFilesFromUrls, InputFilesFromFileObjects, ImporterFileList } from './LoaderUtils.js'\r\nimport { GetFileName } from '../engine/io/fileutils.js'\r\nimport { ArrayBufferToUtf8String, ArrayBufferToAsciiString } from '../engine/io/bufferutils.js'\r\nimport { DragLoader } from './DragLoader.js'\r\nimport { LoadExternalLibrary } from '../engine/io/externallibs.js'\r\nimport { AddObjectCommand } from '../editor/commands/AddObjectCommand.js'\r\n\r\nfunction addLoadModeltoScene (object, callbacks) {\r\n  callbacks.onModelFinished(object)\r\n}\r\n\r\nexport function isGLTF1 (contents) {\r\n  let resultContent\r\n\r\n  if (typeof contents === 'string') {\r\n    // contents is a JSON string\r\n    resultContent = contents\r\n  } else {\r\n    const magic = THREE.LoaderUtils.decodeText(new Uint8Array(contents, 0, 4))\r\n\r\n    if (magic === 'glTF') {\r\n      // contents is a .glb file; extract the version\r\n      const version = new DataView(contents).getUint32(4, true)\r\n\r\n      return version < 2\r\n    } else {\r\n      // contents is a .gltf file\r\n      resultContent = THREE.LoaderUtils.decodeText(new Uint8Array(contents))\r\n    }\r\n  }\r\n\r\n  const json = JSON.parse(resultContent)\r\n\r\n  return (json.asset != undefined && json.asset.version[0] < 2)\r\n}\r\nexport function handleJSON (data, callbacks) {\r\n  if (data.metadata === undefined) { // 2.0\r\n    data.metadata = { type: 'Geometry' }\r\n  }\r\n\r\n  if (data.metadata.type === undefined) { // 3.0\r\n    data.metadata.type = 'Geometry'\r\n  }\r\n\r\n  if (data.metadata.formatVersion !== undefined) {\r\n    data.metadata.version = data.metadata.formatVersion\r\n  }\r\n\r\n  switch (data.metadata.type.toLowerCase()) {\r\n    case 'buffergeometry':\r\n\r\n    {\r\n      const loader = new THREE.BufferGeometryLoader()\r\n      const result = loader.parse(data)\r\n\r\n      const mesh = new THREE.Mesh(result)\r\n      addLoadModeltoScene(mesh, callbacks)\r\n      // editor.execute(new AddObjectCommand(editor, mesh))\r\n\r\n      break\r\n    }\r\n\r\n    case 'geometry':\r\n\r\n      console.error('Loader: \"Geometry\" is no longer supported.')\r\n\r\n      break\r\n\r\n    case 'object':\r\n\r\n    {\r\n      const loader = new THREE.ObjectLoader()\r\n      loader.setResourcePath(scope.texturePath)\r\n\r\n      loader.parse(data, function (result) {\r\n        if (result.isScene) {\r\n          alert('scene')\r\n          // TODO 场景\r\n          addLoadModeltoScene(result, callbacks)\r\n          // editor.execute(new SetSceneCommand(editor, result))\r\n        } else {\r\n          addLoadModeltoScene(result, callbacks)\r\n          // editor.execute(new AddObjectCommand(editor, result))\r\n        }\r\n      })\r\n\r\n      break\r\n    }\r\n\r\n    case 'app':\r\n\r\n      editor.fromJSON(data)\r\n\r\n      break\r\n  }\r\n}\r\nlet editor, scope\r\nexport class Loader {\r\n  constructor (website, viewer) {\r\n    scope = this\r\n    editor = website\r\n    this.signals = website.signals\r\n    // console.log(signals, 'signals in Loader')\r\n\r\n    this.callbacks = null\r\n    // 使用URL回调初始化加载管理器。\r\n    this.objectURLs = []\r\n    console.log(viewer, 'viewer in Loader')\r\n    this.fileList = new ImporterFileList()\r\n    this.viewer = viewer\r\n    this.dragLoader = new DragLoader(this.viewer)\r\n    this.texturePath = ''\r\n  }\r\n\r\n  // url的方式\r\n  loadItemUrls (urls, callbacks) {\r\n    this.callbacks = callbacks\r\n    console.log(this.fileList, 'this.fileList')\r\n    console.log(urls, 'urls in loadItemUrls')\r\n    let inputFiles = InputFilesFromUrls(urls)\r\n    console.log(inputFiles, 'inputFiles in loadItemUrls') //\r\n    let newFileList = new ImporterFileList()\r\n    newFileList.FillFromInputFiles(inputFiles) // 6项\r\n    console.log(newFileList, 'newFileList in loadItemUrls') // size 为undefined\r\n    this.fileList = newFileList\r\n    console.log(this.fileList, 'this.fileList2')\r\n    // RunTasks()执行异步 设置content ????\r\n    callbacks.onLoadStart()\r\n    this.fileList.GetContent({\r\n      onReady: () => {\r\n        callbacks.onImportStart()\r\n        this.loadFiles(this.fileList, urls, filesMap)\r\n      },\r\n      onFileListProgress: callbacks.onFileListProgress,\r\n      onFileLoadProgress: callbacks.onFileLoadProgress\r\n    })\r\n    // map\r\n    // const filesMap = {}\r\n    // for (let i = 0; i < urls.length; i++) {\r\n    //   const file = urls[i]\r\n    //   console.log(file, 'file in loadItemUrls11 ')\r\n    //   filesMap[GetFileName(file)] = file\r\n    // }\r\n\r\n    const filesMap = new Map()\r\n    for (let i = 0; i < urls.length; i++) {\r\n      const file = urls[i]\r\n      console.log(file, 'file in loadItemUrls11 ')\r\n      filesMap.set(GetFileName(file), file)\r\n    }\r\n\r\n    // let filesMap = LoaderUtils.createFilesMap(urls)\r\n    console.log(filesMap, 'filesMap in  loadItemUrls')\r\n  }\r\n\r\n  // 拖拽的方式\r\n  loadItemList (items, callbacks) {\r\n    this.callbacks = callbacks\r\n\r\n    console.log(items, 'items in loadItemList')\r\n    LoaderUtils.getFilesFromItemList(items, (files, filesMap) => {\r\n      // alert('callback in loadItemList')\r\n      console.log(files, 'files in loadItemList')\r\n      console.log(InputFilesFromFileObjects(files), 'InputFilesFromFileObjects(files)')// 3项 data name source 拖拽的方式\r\n      let inputFiles = InputFilesFromFileObjects(files)\r\n      let newFileList = new ImporterFileList()\r\n      newFileList.FillFromInputFiles(inputFiles) // 6项\r\n      console.log(newFileList, 'newFileList in loadItemList')\r\n      this.fileList = newFileList\r\n      console.log(this.fileList, 'this.fileList in  loadItemList')\r\n      let filesMap1 = LoaderUtils.createFilesMap(files)\r\n      // 合并处理的方式\r\n      callbacks.onLoadStart()\r\n      this.fileList.GetContent({\r\n        onReady: () => {\r\n          callbacks.onImportStart()\r\n          this.loadFiles(this.fileList, files, filesMap1)\r\n        },\r\n        onFileListProgress: callbacks.onFileListProgress,\r\n        onFileLoadProgress: callbacks.onFileLoadProgress\r\n      })\r\n\r\n      // console.log(filesMap1, 'filesMap1')\r\n\r\n      // **单独处理的方式\r\n      // callbacks.onLoadStart()\r\n      // this.fileList.GetContent({\r\n      //   onReady: () => {\r\n      //     // url 和 drag 统一处理的方式\r\n      //     // this.loadFiles(this.fileList, files, filesMap)\r\n      //     // 抽离出去，单独处理file文件的方式\r\n      //     callbacks.onImportStart()\r\n      //     // this.dragLoader.DragLoadFiles(files, filesMap, {\r\n      //     //   render: (object) => {\r\n      //     //     // this.viewer.scene.add(object)// that.viewer.SetMainObject(threeObject);\r\n      //     //     // callbacks.onFinish(object)\r\n      //     //     callbacks.onModelFinished(object)\r\n      //     //   }\r\n\r\n      //     // })\r\n      //     this.dragLoader.DragLoadFiles(files, filesMap, callbacks)\r\n      //   },\r\n      //   onFileListProgress: callbacks.onFileListProgress,\r\n      //   onFileLoadProgress: callbacks.onFileLoadProgress\r\n      // })\r\n    })\r\n  }\r\n\r\n  // 这里通过hash的方式\r\n  loadFiles (fileList, files, filesMap) {\r\n    console.log(fileList, files, 'fileList in loadFiles')\r\n    if (files.length > 0) {\r\n      filesMap = filesMap || LoaderUtils.createFilesMap(files)\r\n      console.log(filesMap, 'filesMap in loadFiles')\r\n      const manager = new THREE.LoadingManager()\r\n      manager.onStart = () => {\r\n        console.log('Started loading file')\r\n      }\r\n\r\n      manager.setURLModifier((url) => {\r\n        console.log(url, 'url in setURLModifier')\r\n        // url = url.replace(/^(\\.?\\/)/, '') // remove './'\r\n\r\n        if(url.substring(0,5)=='blob:'){\r\n          url = url\r\n       }else{\r\n         url = GetFileName(url)\r\n       }\r\n        console.log(url, filesMap, 'url2222222')\r\n        // const file = filesMap[url]\r\n        // const file = filesMap.get(url)// 会查找所有的贴图\r\n        let filetest = fileList.files.find(item => item.name === url)\r\n        console.log(filetest, 'filetest')\r\n        // let file = fileList.files.find(item => item.name === url).content// 这样缺少文件为undefined不可以\r\n        let file = fileList.files.find(item => item.name === url)\r\n        console.log('file-url', file)\r\n        if (file && file.content) {\r\n          file = file.content\r\n          console.log('Loading in setURLModifier', url)\r\n          // https://blog.csdn.net/qq_39258552/article/details/84133770\r\n\r\n          //  法1 ok\r\n          // arraybuffer =>blob\r\n          let blob = new Blob([file])\r\n          console.log(blob, 'blob')\r\n          console.log(URL.createObjectURL(blob), 'URL.createObjectURL(blob)')\r\n          this.objectURLs.push(URL.createObjectURL(blob))\r\n          return URL.createObjectURL(blob)\r\n          // 法2 ok\r\n          // 如果是一个网络url\r\n          // this.objectURLs.push(file)\r\n          // return file\r\n        } else {\r\n          // alert(`缺少${url}`)\r\n          // this.signals.missingFile.dispatch(url)\r\n        }\r\n\r\n        return url\r\n      })\r\n      console.log(this.objectURLs, 'objectURLs')\r\n      // chang name\r\n      let filearr = fileList.files\r\n      for (let i = 0; i < filearr.length; i++) {\r\n        this.loadFile(filearr[i], filesMap, manager)\r\n      }\r\n    }\r\n\r\n    // manager.setURLModifier(function (url) {\r\n    //   // TODO\r\n    //   // 在这里判断缺失贴图图片\r\n    //   console.log(url, 'url222222222')// 需要的\r\n\r\n    //   url = url.replace(/^(\\.?\\/)/, '') // remove './'\r\n    //   console.log(url, 'url1111111xx11')\r\n    //   const file = filesMap[url]\r\n    //   console.log('file-url', file)\r\n    //   // 如果有赋值\r\n    //   if (file) {\r\n    //     // console.log(URL.createObjectURL(file), ' URL.createObjectURL(file)')\r\n    //     // return URL.createObjectURL(file)\r\n    //     this.objectURLs.push(file)\r\n    //     return file\r\n    //   } else {\r\n    //     alert(`缺少${url}`)\r\n    //   }\r\n    //   return url\r\n    // })\r\n  }\r\n\r\n  async loadFile (file, filesMap, manager) {\r\n    console.log(file, filesMap, 'file in loadFile')\r\n    const extension = file.extension\r\n    let source = file.source\r\n    const reader = new FileReader()\r\n    reader.addEventListener('progress', function (event) {\r\n      const size = '(' + Math.floor(event.total / 1000).format() + ' KB)'\r\n      const progress = Math.floor((event.loaded / event.total) * 100) + '%'\r\n\r\n      console.log('Loading', file.name, size, progress)\r\n    })\r\n    try {\r\n      switch (extension) {\r\n        case 'obj':\r\n        {\r\n          // TODO damo.obj 贴图在damo/ 不行\r\n          console.log(this.fileList, 'this.fileList in obj')\r\n          let name = file.name.split('.')[0]\r\n          // console.log(file.name.split('.'), 'file.name.split')\r\n          if (filesMap.has(`${name}.obj`) && filesMap.has(`${name}.mtl`)) {\r\n            const { MTLLoader } = await import('three/addons/loaders/MTLLoader.js')\r\n\t\t      \tconst { OBJLoader } = await import('three/addons/loaders/OBJLoader.js')\r\n            // const materials = new MTLLoader().parse(filesMap.get('damo.mtl'))\r\n            let materialsContent = this.fileList.files.find(item => item.name === `${name}.mtl`).content\r\n            const materials = new MTLLoader(manager).parse(ArrayBufferToUtf8String(materialsContent))\r\n            console.log(materials, 'materials')\r\n            const objloader = new OBJLoader()\r\n            let objcontent = this.fileList.files.find(item => item.name === `${name}.obj`).content\r\n            const object = objloader.setMaterials(materials).parse(ArrayBufferToUtf8String(objcontent))\r\n\r\n            console.log(object, 'object')\r\n            // this.callbacks.onFinish(object)\r\n            addLoadModeltoScene(object, this.callbacks)\r\n            // editor.execute(new AddObjectCommand(editor, object))\r\n          } else if (filesMap.has(`${name}.obj`)) {\r\n            // TODO 如果缺少纹理文件要提示\r\n            const { OBJLoader } = await import('three/addons/loaders/OBJLoader.js')\r\n            const objloader = new OBJLoader()\r\n            let objcontent = this.fileList.files.find(item => item.name === `${name}.obj`).content\r\n            const object = objloader.parse(ArrayBufferToUtf8String(objcontent))\r\n            addLoadModeltoScene(object, this.callbacks)\r\n          }\r\n\r\n          // //法1 arraybufff转utf8string\r\n          // let contents = ArrayBufferToUtf8String(file.content)\r\n          // //法2\r\n          // // let decoder = new TextDecoder('utf-8')\r\n\t        // // //  console.log(decoder.decode(file.content), 'decoder.decode (buffer)')\r\n          // // let contents = decoder.decode(file.content)\r\n          // // ok\r\n          // const { OBJLoader } = await\r\n          // import('three/addons/loaders/OBJLoader.js')\r\n\r\n          // const object = new OBJLoader(manager).parse(contents)\r\n          // console.log(object, 'object in obj')\r\n          // // this.viewer.scene.add(object)\r\n          // this.callbacks.onFinish(object)\r\n          break\r\n        }\r\n\r\n        case 'fbx':\r\n        {\r\n          // 这个就不用转成arraybuffer\r\n          let contents = file.content\r\n          const { FBXLoader } = await\r\n          import('three/addons/loaders/FBXLoader.js')\r\n          const loader = new FBXLoader(manager)\r\n          const object = loader.parse(contents)\r\n          console.log(this, 'this in fbx22')\r\n          console.log(object, 'object in fbx')\r\n          // this.viewer.scene.add(object)\r\n          // this.callbacks.onFinish(object)\r\n          addLoadModeltoScene(object, this.callbacks)\r\n          break\r\n        }\r\n        case '3dm':\r\n        {\r\n          let contents = file.content\r\n          // TODO\r\n          // way1\r\n          // const { Rhino3dmLoader } = await import('three/addons/loaders/3DMLoader.js')\r\n          // const loader = new Rhino3dmLoader(manager)\r\n          // LoadExternalLibrary('loaders/rhino3dm.min.js').then(res => {\r\n          //   console.log(res, 'res in LoadExternalLibrary')\r\n          //   rhino3dm().then((rhino) => {\r\n          //     console.log(rhino, 'rhino')\r\n          //   })\r\n          // })\r\n          // way2 不能加manager\r\n          const { Rhino3dmLoader } = await import('three/addons/loaders/3DMLoader.js')\r\n          const loader = new Rhino3dmLoader()\r\n          // loader.setLibraryPath('/static/example/jsm/libs/rhino3dm/') // ok\r\n          // loader.setLibraryPath('https://cdn.jsdelivr.net/npm/rhino3dm@7.11.1/')//OK\r\n\r\n          loader.setLibraryPath('/static/js/loaders/rhino3dm/')\r\n          loader.parse(contents, (object) => {\r\n            addLoadModeltoScene(object, this.callbacks)\r\n          })\r\n          break\r\n        }\r\n        case '3ds':\r\n        {\r\n          const { TDSLoader } = await import('three/addons/loaders/TDSLoader.js')\r\n\r\n          const loader = new TDSLoader(manager)\r\n          const object = loader.parse(file.content)\r\n          console.log(object, 'object in 3ds')\r\n          addLoadModeltoScene(object, this.callbacks)\r\n\r\n          break\r\n        }\r\n        case '3mf':\r\n        {\r\n          const { ThreeMFLoader } = await import('three/addons/loaders/3MFLoader.js')\r\n\r\n          const loader = new ThreeMFLoader()\r\n          const object = loader.parse(file.content)\r\n          addLoadModeltoScene(object, this.callbacks)\r\n          break\r\n        }\r\n        case 'amf':\r\n        {\r\n          const { AMFLoader } = await import('three/addons/loaders/AMFLoader.js')\r\n\r\n          const loader = new AMFLoader()\r\n          const amfobject = loader.parse(file.content)\r\n          addLoadModeltoScene(amfobject, this.callbacks)\r\n          break\r\n        }\r\n        case 'dae':\r\n        {\r\n          const contents = ArrayBufferToUtf8String(file.content)\r\n          console.log(contents, 'contents in dae')\r\n          const { ColladaLoader } = await import('three/addons/loaders/ColladaLoader.js')\r\n\r\n          const loader = new ColladaLoader(manager)\r\n          const collada = loader.parse(contents)\r\n          collada.scene.name = file.name\r\n          addLoadModeltoScene(collada.scene, this.callbacks)\r\n          break\r\n        }\r\n        case 'drc':\r\n        {\r\n          const contents = file.content\r\n          const { DRACOLoader } = await import('three/addons/loaders/DRACOLoader.js')\r\n\r\n          const loader = new DRACOLoader()\r\n          // loader.setDecoderPath('../examples/jsm/libs/draco/')\r\n          // TODO\r\n          // loader.setDecoderPath('/static/') // ok\r\n          // loader.setDecoderPath('/draco/') // ok\r\n          // loader.setDecoderPath('/static/examples/jsm/libs/draco/')\r\n          loader.setDecoderPath('/static/js/loaders/draco/') // ok\r\n          loader.decodeDracoFile(contents, (geometry) => {\r\n            let object\r\n\r\n            if (geometry.index !== null) {\r\n              const material = new THREE.MeshStandardMaterial()\r\n\r\n              object = new THREE.Mesh(geometry, material)\r\n              // object.name = filename\r\n              object.name = file.name\r\n            } else {\r\n              const material = new THREE.PointsMaterial({ size: 0.01 })\r\n              material.vertexColors = geometry.hasAttribute('color')\r\n\r\n              object = new THREE.Points(geometry, material)\r\n              object.name = file.name\r\n              // object.name = filename\r\n            }\r\n\r\n            loader.dispose()\r\n            // editor.execute(new AddObjectCommand(editor, object))\r\n            addLoadModeltoScene(object, this.callbacks)\r\n          })\r\n          break\r\n        }\r\n\r\n        case 'glb':\r\n        {\r\n        \r\n          const contents = file.content\r\n\r\n          const { DRACOLoader } = await import('three/addons/loaders/DRACOLoader.js')\r\n          const { GLTFLoader } = await import('three/addons/loaders/GLTFLoader.js')\r\n\r\n          const dracoLoader = new DRACOLoader()\r\n          // dracoLoader.setDecoderPath('../examples/jsm/libs/draco/gltf/')\r\n          // dracoLoader.setDecoderPath('/static/')// ok\r\n          // dracoLoader.setDecoderPath('/draco/gltf/')// ok\r\n          dracoLoader.setDecoderPath('/static/js/loaders/draco/')\r\n          \r\n\r\n          const loader = new GLTFLoader()\r\n          loader.setDRACOLoader(dracoLoader)\r\n          \r\n          // TODO try catch 不能抛出错误\r\n            loader.parse(contents, '', (result) => {\r\n              const scene = result.scene\r\n              scene.name = file.name\r\n  \r\n              scene.animations.push(...result.animations)\r\n              // editor.execute(new AddObjectCommand(editor, scene))\r\n              addLoadModeltoScene(scene, this.callbacks)\r\n          \r\n            },(err)=>{\r\n              //  alert(err)\r\n               this.callbacks.onLoadError(err)\r\n            })\r\n       \r\n \r\n          break\r\n        }\r\n        case 'gltf':\r\n        {\r\n          const contents = file.content\r\n\r\n          let loader\r\n\r\n          if (isGLTF1(contents)) {\r\n           \r\n            alert('Import of glTF asset not possible. Only versions >= 2.0 are supported. Please try to upgrade the file to glTF 2.0 using glTF-Pipeline.')\r\n          } else {\r\n           \r\n            const { DRACOLoader } = await import('three/addons/loaders/DRACOLoader.js')\r\n            const { GLTFLoader } = await import('three/addons/loaders/GLTFLoader.js')\r\n\r\n            const dracoLoader = new DRACOLoader()\r\n            // dracoLoader.setDecoderPath('../examples/jsm/libs/draco/gltf/')\r\n            // dracoLoader.setDecoderPath('/static/')// ok\r\n            // dracoLoader.setDecoderPath('/draco/gltf/')\r\n            // dracoLoader.setDecoderPath('/static/examples/jsm/libs/draco/gltf/')\r\n            dracoLoader.setDecoderPath('/js/loaders/gltf/')\r\n            loader = new GLTFLoader(manager)\r\n            loader.setDRACOLoader(dracoLoader)\r\n          }\r\n\r\n          loader.parse(contents, '', (result) => {\r\n            const scene = result.scene\r\n            // scene.name = filename\r\n            scene.name = file.name\r\n\r\n            scene.animations.push(...result.animations)\r\n            // editor.execute(new AddObjectCommand(editor, scene))\r\n            addLoadModeltoScene(scene, this.callbacks)\r\n          })\r\n          break\r\n        }\r\n        // TODO\r\n        case 'js':\r\n        case 'json':\r\n        {\r\n          let contents = ArrayBufferToUtf8String(file.content)\r\n\r\n          // 2.0\r\n\r\n          if (contents.indexOf('postMessage') !== -1) {\r\n            const blob = new Blob([contents], { type: 'text/javascript' })\r\n            console.log(blob, 'blob-jsjson')\r\n            const url = URL.createObjectURL(blob)\r\n            console.log(url, 'url-jsjson')\r\n\r\n            const worker = new Worker(url)\r\n\r\n            worker.onmessage = function (event) {\r\n              event.data.metadata = { version: 2 }\r\n              handleJSON(event.data, scope.callbacks)\r\n            }\r\n\r\n            worker.postMessage(Date.now())\r\n\r\n            return\r\n          }\r\n\r\n          // >= 3.0\r\n\r\n          let data\r\n\r\n          try {\r\n            data = JSON.parse(contents)\r\n          } catch (error) {\r\n            alert(error)\r\n            return\r\n          }\r\n\r\n          handleJSON(data, scope.callbacks)\r\n          break\r\n        }\r\n        case 'ifc':\r\n        {\r\n          const { IFCLoader } = await import('three/addons/loaders/IFCLoader.js')\r\n\r\n          let loader = new IFCLoader()\r\n          // loader.ifcManager.setWasmPath('three/addons/loaders/ifc/')\r\n          // TODO\r\n          loader.ifcManager.setWasmPath('/loaders/ifc/')\r\n          const model = await loader.parse(file.content)\r\n          console.log(model, 'model')\r\n          // model.mesh.name = filename\r\n          model.mesh.name = file.name\r\n          // editor.execute(new AddObjectCommand(editor, model.mesh))\r\n          addLoadModeltoScene(model, this.callbacks)\r\n          break\r\n        }\r\n        case 'kmz':\r\n        {\r\n          const { KMZLoader } = await import('three/addons/loaders/KMZLoader.js')\r\n\r\n          const loader = new KMZLoader()\r\n          const collada = loader.parse(file.content)\r\n\r\n          collada.scene.name = file.name\r\n\r\n          // editor.execute(new AddObjectCommand(editor, collada.scene))\r\n          addLoadModeltoScene(collada.scene, this.callbacks)\r\n          break\r\n        }\r\n        case 'ldr':\r\n\t\t\t  case 'mpd':\r\n        {\r\n          let contents = ArrayBufferToUtf8String(file.content)\r\n          const { LDrawLoader } = await import('three/addons/loaders/LDrawLoader.js')\r\n\r\n          const loader = new LDrawLoader()\r\n          // loader.setPath('../../examples/models/ldraw/officialLibrary/')\r\n          // loader.setPath('/static/example/models/ldraw/officialLibrary/')\r\n          // TODO 去掉第二个参数 加载\r\n          loader.parse(contents, function (group) {\r\n          // loader.parse(contents, undefined, function (group) {\r\n            group.name = file.name\r\n            // Convert from LDraw coordinates: rotate 180 degrees around OX\r\n            group.rotation.x = Math.PI\r\n\r\n            // editor.execute(new AddObjectCommand(editor, group))\r\n            addLoadModeltoScene(group, scope.callbacks)\r\n          })\r\n          break\r\n        }\r\n        case 'md2':\r\n        {\r\n          const { MD2Loader } = await import('three/addons/loaders/MD2Loader.js')\r\n\r\n          const geometry = new MD2Loader().parse(file.content)\r\n          const material = new THREE.MeshStandardMaterial()\r\n\r\n          const mesh = new THREE.Mesh(geometry, material)\r\n          mesh.mixer = new THREE.AnimationMixer(mesh)\r\n          // mesh.name = filename;\r\n          mesh.name = file.name\r\n\r\n          mesh.animations.push(...geometry.animations)\r\n          // editor.execute( new AddObjectCommand( editor, mesh ) );\r\n          addLoadModeltoScene(mesh, scope.callbacks)\r\n          break\r\n        }\r\n        case 'pcd':\r\n        {\r\n          const contents = file.content\r\n\r\n          // const { PCDLoader } = await import('../../examples/jsm/loaders/PCDLoader.js')\r\n          const { PCDLoader } = await\r\n          import('three/addons/loaders/PCDLoader.js')\r\n\r\n          const points = new PCDLoader().parse(contents)\r\n          points.name = file.name\r\n\r\n          // editor.execute(new AddObjectCommand(editor, points))\r\n          addLoadModeltoScene(points, scope.callbacks)\r\n          break\r\n        }\r\n        case 'ply':\r\n        {\r\n          const contents = file.content\r\n          const { PLYLoader } = await import('three/addons/loaders/PLYLoader.js')\r\n          const geometry = new PLYLoader().parse(contents)\r\n          let object\r\n          if (geometry.index !== null) {\r\n            const material = new THREE.MeshStandardMaterial({ color: 0x0055ff, flatShading: true })\r\n            object = new THREE.Mesh(geometry, material)\r\n            object.name = file.name\r\n          } else {\r\n            const material = new THREE.PointsMaterial({ size: 0.01 })\r\n            material.vertexColors = geometry.hasAttribute('color')\r\n            object = new THREE.Points(geometry, material)\r\n            object.name = file.name\r\n          }\r\n          // editor.execute(new AddObjectCommand(editor, object))\r\n          addLoadModeltoScene(object, scope.callbacks)\r\n          break\r\n        }\r\n        case 'stl':\r\n        {\r\n          // 使用reader 的方式\r\n          reader.addEventListener('load', async function (event) {\r\n            const contents = event.target.result\r\n\r\n            const { STLLoader } = await import('three/addons/loaders/STLLoader.js')\r\n\r\n            const geometry = new STLLoader().parse(contents)\r\n            const material = new THREE.MeshStandardMaterial()\r\n\r\n            const mesh = new THREE.Mesh(geometry, material)\r\n            mesh.name = file.name\r\n            // editor.execute( new AddObjectCommand( editor, mesh ) );\r\n            addLoadModeltoScene(mesh, scope.callbacks)\r\n          }, false)\r\n          // FileReader提供了如下方法：\r\n\r\n          // readAsArrayBuffer(file)：按字节读取文件内容，结果用ArrayBuffer对象表示\r\n\r\n          // readAsBinaryString(file)：按字节读取文件内容，结果为文件的二进制串\r\n\r\n          // readAsDataURL(file)：读取文件内容，结果用data:url的字符串形式表示\r\n\r\n          // readAsText(file,encoding)：按字符读取文件内容，结果用字符串形式表示\r\n\r\n          if (reader.readAsBinaryString !== undefined) {\r\n            // alert('bibarayString')\r\n            reader.readAsBinaryString(file.data)\r\n          } else {\r\n            // alert('readAsArrayBuffer')\r\n            reader.readAsArrayBuffer(file.data)\r\n          }\r\n          break\r\n          // TODO\r\n          // console.log(ArrayBufferToAsciiString(file.data), 'ArrayBufferToAsciiString')\r\n          // // ascli\r\n          // if (ArrayBufferToAsciiString(file.content) !== undefined) {\r\n          //   alert('bibarayString')\r\n          // } else {\r\n          //   alert('readAsArrayBuffer')\r\n          // }\r\n        }\r\n        case 'svg':\r\n        {\r\n          const contents = ArrayBufferToUtf8String(file.content)\r\n\r\n          const { SVGLoader } = await import('three/addons/loaders/SVGLoader.js')\r\n\r\n          const loader = new SVGLoader()\r\n          const paths = loader.parse(contents).paths\r\n          const group = new THREE.Group()\r\n          group.scale.multiplyScalar(0.1)\r\n          group.scale.y *= -1\r\n\r\n          for (let i = 0; i < paths.length; i++) {\r\n            const path = paths[i]\r\n\r\n            const material = new THREE.MeshBasicMaterial({\r\n              color: path.color,\r\n              depthWrite: false\r\n            })\r\n\r\n            const shapes = SVGLoader.createShapes(path)\r\n\r\n            for (let j = 0; j < shapes.length; j++) {\r\n              const shape = shapes[j]\r\n\r\n              const geometry = new THREE.ShapeGeometry(shape)\r\n              const mesh = new THREE.Mesh(geometry, material)\r\n\r\n              group.add(mesh)\r\n            }\r\n          }\r\n          // editor.execute( new AddObjectCommand( editor, group ) );\r\n          addLoadModeltoScene(group, scope.callbacks)\r\n          break\r\n        }\r\n        case 'usdz':\r\n        {\r\n          break\r\n        }\r\n        case 'vox':\r\n        {\r\n          break\r\n        }\r\n        case 'vtk':\r\n        case 'vtp':\r\n        {\r\n          break\r\n        }\r\n        case 'wrl':\r\n        {\r\n          break\r\n        }\r\n        case 'xyz':\r\n        {\r\n          break\r\n        }\r\n        case 'zip':\r\n        {\r\n          break\r\n        }\r\n      }\r\n    } catch (error) {\r\n\r\n      console.error('THREE.WebGLState:', error)\r\n      this.callbacks.onLoadError(error)\r\n    }\r\n  }\r\n}\r\n","import { CreateVerticalSplitter } from './splitter.js'\r\nimport { GetDomElementOuterWidth, SetDomElementOuterWidth,AddDomElement,CreateDiv } from '../viewer/domutils.js'\r\n// 是否是小尺寸\r\nexport function IsSmallWidth () {\r\n  return window.matchMedia('(max-width: 1000px)').matches\r\n}\r\nexport function AddSmallWidthChangeEventListener (onChange) {\r\n  let mediaQuery = window.matchMedia('(max-width: 1000px)')\r\n  mediaQuery.addEventListener('change', onChange)\r\n}\r\n// split\r\nexport function InstallVerticalSplitter (splitterDiv, resizedDiv, flipped, onResize) {\r\n  let originalWidth = null\r\n  CreateVerticalSplitter(splitterDiv, {\r\n    // 开始移动\r\n    onSplitStart: () => {\r\n      originalWidth = GetDomElementOuterWidth(resizedDiv)\r\n      console.log(originalWidth, 'originalWidth')\r\n    },\r\n    onSplit: (xDiff) => {\r\n      const minWidth = 280\r\n      const maxWidth = 450\r\n      let newWidth = 0\r\n      // 只能扩展\r\n      if (flipped) {\r\n        newWidth = originalWidth - xDiff\r\n      } else {\r\n        newWidth = originalWidth + xDiff\r\n      }\r\n      if (newWidth < minWidth) {\r\n        newWidth = minWidth\r\n      } else if (newWidth > maxWidth) {\r\n        newWidth = maxWidth\r\n      }\r\n      SetDomElementOuterWidth(resizedDiv, newWidth)\r\n      onResize()\r\n    }\r\n  })\r\n}\r\n// TODO\r\n//  拖拽导入\r\nexport function GetFilesFromDataTransfer (dataTransfer, onReady) {\r\n  console.log(dataTransfer, 'dataTransfe-GetFilesFromDataTransfer')\r\n  console.log(onReady, 'onReady')\r\n  async function GetFileEntriesFromDirectory (dirEntry, fileEntries) {\r\n    let reader = dirEntry.createReader()\r\n    return new Promise((resolve, reject) => {\r\n      reader.readEntries(\r\n        async (dirEntries) => {\r\n          for (let entry of dirEntries) {\r\n            if (entry.isFile) {\r\n              fileEntries.push(entry)\r\n            } else if (entry.isDirectory) {\r\n              await GetFileEntriesFromDirectory(entry, fileEntries)\r\n            }\r\n          }\r\n          resolve()\r\n        },\r\n        (error) => {\r\n          reject(error)\r\n        }\r\n      )\r\n    })\r\n  }\r\n\r\n  async function GetFileObjectsFromEntries (entries, onReady) {\r\n    let fileEntries = []\r\n    for (let entry of entries) {\r\n      if (entry.isFile) {\r\n        fileEntries.push(entry)\r\n      } else if (entry.isDirectory) {\r\n        await GetFileEntriesFromDirectory(entry, fileEntries)\r\n      }\r\n    }\r\n\r\n    let fileObjects = await Promise.all(fileEntries.map((fileEntry) => new Promise((resolve, reject) => {\r\n      fileEntry.file(\r\n        (file) => {\r\n          resolve(file)\r\n        },\r\n        (error) => {\r\n          reject(error)\r\n        }\r\n      )\r\n    })))\r\n\r\n    onReady(fileObjects)\r\n  }\r\n\r\n  let getAsEntryFunc = null\r\n  if (DataTransferItem) {\r\n    if (DataTransferItem.prototype.getAsEntry) {\r\n      getAsEntryFunc = DataTransferItem.prototype.getAsEntry\r\n    } else if (DataTransferItem.prototype.webkitGetAsEntry) {\r\n      getAsEntryFunc = DataTransferItem.prototype.webkitGetAsEntry\r\n    }\r\n  }\r\n\r\n  if (getAsEntryFunc !== null) {\r\n    let entries = []\r\n    for (let item of dataTransfer.items) {\r\n      let entry = getAsEntryFunc.call(item)\r\n      if (entry !== null) {\r\n        entries.push(entry)\r\n      }\r\n    }\r\n    GetFileObjectsFromEntries(entries, (allEntries) => {\r\n      onReady(allEntries)\r\n    })\r\n  } else {\r\n    onReady(dataTransfer.files)\r\n  }\r\n}\r\n\r\n\r\n// dom 添加svg \r\nexport function CreateSvgIconElement (iconName, className)\r\n{\r\n    let iconDiv = CreateDiv ('ov_svg_icon');\r\n    if (className) {\r\n        iconDiv.classList.add (className);\r\n    }\r\n    AddDomElement (iconDiv, 'i', 'icon icon-' + iconName);\r\n    return iconDiv;\r\n}\r\n\r\n\r\nexport function AddSvgIconElement (parentElement, iconName, className)\r\n{\r\n    let iconDiv = CreateSvgIconElement (iconName, className);\r\n    parentElement.appendChild (iconDiv);\r\n    return iconDiv;\r\n}\r\n\r\n","export class RGBColor {\r\n  constructor (r, g, b) {\r\n    this.r = r // 0 .. 255\r\n    this.g = g // 0 .. 255\r\n    this.b = b // 0 .. 255\r\n  }\r\n\r\n  Set (r, g, b) {\r\n    this.r = r\r\n    this.g = g\r\n    this.b = b\r\n  }\r\n\r\n  Clone () {\r\n    return new RGBColor(this.r, this.g, this.b)\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { RGBColor } from '../engine/model/color.js'\r\nimport { ConvertColorToThreeColor } from '../engine/threejs/threeutils.js'\r\n// import { CSS3DRenderer, CSS3DObject, CSS3DSprite } from 'three/addons/renderers/CSS3DRenderer.js'\r\nimport { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js'\r\n\r\nexport function SetThreeMeshPolygonOffset (mesh, offset) {\r\n  function SetMaterialsPolygonOffset (materials, offset) {\r\n    for (let material of materials) {\r\n      material.polygonOffset = offset\r\n      material.polygonOffsetUnit = 1\r\n      material.polygonOffsetFactor = 1\r\n    }\r\n  }\r\n\r\n  SetMaterialsPolygonOffset(mesh.material, offset)\r\n  if (mesh.userData.threeMaterials) {\r\n    SetMaterialsPolygonOffset(mesh.userData.threeMaterials, offset)\r\n  }\r\n}\r\nexport class ModelTool {\r\n  constructor (viewer) {\r\n    this.viewer = viewer\r\n    console.log(this.viewer, 'this.viewer in moelTools')\r\n    this.camera = this.viewer.camera\r\n    console.log(this.camera, 'this.camera in moelTools')\r\n    this.canvas = this.viewer.canvas\r\n    console.log(this.canvas, 'this.canvas in moelTools')\r\n    this.box3Helper = null\r\n  }\r\n\r\n  // 设置相机\r\n  // SetCamera (camera) {\r\n  //   this.camera = camera\r\n  // }\r\n  resetCamera (group, resetCamera) {\r\n    const bbox = new THREE.Box3().setFromObject(group)\r\n    const size = bbox.getSize(new THREE.Vector3())\r\n    const radius = Math.max(size.x, Math.max(size.y, size.z)) * 0.5\r\n    if (resetCamera) {\r\n      console.log(this.viewer.controls, 'this.controls')\r\n      this.viewer.controls.target0.copy(bbox.getCenter(new THREE.Vector3()))\r\n      this.viewer.controls.position0.set(-2.3, 1, 2).multiplyScalar(radius).add(this.viewer.controls.target0)\r\n      this.viewer.controls.reset()\r\n    }\r\n  }\r\n\r\n  // 将模型显示在中心\r\n  modelCenter (group) {\r\n    const modelBox = new THREE.Box3().setFromObject(group)\r\n    this.box3Helper = new THREE.Box3Helper(modelBox, 0xffff00)\r\n    console.log(modelBox.max, 'max')\r\n    console.log(modelBox.min, 'min')\r\n\r\n    const center = new THREE.Vector3() // 0,0,0\r\n    console.log('center', center)\r\n    modelBox.getCenter(center)\r\n    console.log('查看几何体中心坐标', center)\r\n    // 居中\r\n    group.position.set(-center.x, -center.y, -center.z)\r\n    // group.position.set(0, 0, 0) // 将模型原点归零\r\n\r\n    const mdlen = modelBox.max.x - modelBox.min.x // 长\r\n    const mdhei = modelBox.max.y - modelBox.min.y // 高\r\n    const mdwid = modelBox.max.z - modelBox.min.z// 宽\r\n    console.log(mdlen, mdhei, mdwid)\r\n    let scaleMax = 1.5\r\n    // let a = 0.05\r\n    // console.log(1 / 0.05, 'test1111')\r\n    const maxLength = (mdlen > mdwid ? mdlen : mdwid) > mdhei ? (mdlen > mdwid ? mdlen : mdwid) : mdhei\r\n    console.log(maxLength, 'maxLength')\r\n    if (maxLength < 1) {\r\n      scaleMax = 1 / maxLength\r\n    } else {\r\n      console.log(this.camera, 'this.camera')\r\n      // this.camera.position.copy({ x: maxLength * scaleMax, y: mdhei * scaleMax, z: maxLength * scaleMax * scaleMax })\r\n      this.camera.position.set(maxLength * scaleMax, mdhei * scaleMax, maxLength * scaleMax * scaleMax)\r\n      this.camera.lookAt(0, 0, 0)\r\n      this.camera.updateProjectionMatrix()\r\n    }\r\n\r\n    console.log(group.position, 'group.prositon')\r\n\r\n    // 模型大小test\r\n    let box3 = new THREE.Box3()\r\n    box3.expandByObject(group)\r\n    let v3 = new THREE.Vector3()\r\n    box3.getSize(v3)\r\n    console.log('size', v3)\r\n    // 立体世界坐标转屏幕坐标\r\n    // 创建一个三维向量作为世界坐标\r\n    // let worldVector = new THREE.Vector3()\r\n    // 获取网格模型的世界坐标，赋值给worldVector\r\n    // group.getWorldPosition(worldVector)\r\n    // console.log(worldVector, 'worldVector')\r\n\r\n    // 模型的世界坐标\r\n    let worldVector = group.position.clone()\r\n    console.log(worldVector, 'worldVector')\r\n    // 世界坐标转标准设备坐标，standardVector是WebGL设备坐标\r\n    // .project 方法提取相机参数的视图矩阵，投影矩阵对世界坐标进行转换\r\n    let standardVector = worldVector.project(this.camera)\r\n    console.log(standardVector, 'standardVector')\r\n    let a = this.canvas.width / 2\r\n    let b = this.canvas.height / 2\r\n    let x = Math.round(standardVector.x * a + a) // 模型标签x坐标\r\n    let y = Math.round(-standardVector.y * b + b)// 模型标签y坐标\r\n    // 创建div 元素\r\n    let div = document.createElement('div')\r\n    div.innerHTML = '立方体'\r\n    div.style.padding = '10px'\r\n    div.style.color = '#fff'\r\n    div.style.position = 'absolute'\r\n    div.style.backgroundColor = 'rgba(25,25,25,0.5)'\r\n    div.style.borderRadius = '5px'\r\n    // document.body.appendChild(div)\r\n    // // 设置标签元素位置\r\n    // div.style.left = x + 'px'\r\n    // // 为了标签和模型有一定的偏移\r\n    // div.style.top = y - 130 + 'px'\r\n\r\n    // // 获得HTML元素创建的UI界面\r\n    // // let tag = document.getElementById('tag')\r\n\r\n    // // div元素包装为CSS2模型对象CSS2DObject，并插入场景中\r\n    // let label = new CSS2DObject(div)\r\n    // label.position.copy(group.position)\r\n    // label.position.y += 30\r\n    // this.viewer.SetMainObject(label) // CSS2模型标签插入到场景中\r\n\r\n    // // 创建一个CSS2渲染器CSS2DRenderer\r\n    // let labelRenderer = new CSS2DRenderer()\r\n    // labelRenderer.setSize(this.canvas.width, this.canvas.height)\r\n    // labelRenderer.domElement.style.position = 'absolute'\r\n    // // 避免renderer.domElement影响HTMl标签定位，设置top为0px\r\n    // labelRenderer.domElement.style.top = '0px'\r\n    // labelRenderer.domElement.style.left = '0px'\r\n    // // 设置.pointerEvents=none，以免模型标签HTML元素遮挡鼠标选择场景模型\r\n    // labelRenderer.domElement.style.pointerEvents = 'none'\r\n    // document.body.appendChild(labelRenderer.domElement)\r\n\r\n    // // div元素包装为CSS3模型对象CSS3DObject，并插入场景中\r\n    // let label = new CSS3DObject(div)\r\n    // div.style.pointerEvents = 'none'// 避免HTML标签遮挡三维场景的鼠标事件\r\n    // label.position.copy(group.position)\r\n    // // 缩放CSS3DObject模型对象\r\n    // label.scale.set(0.5, 0.5, 0.5)\r\n    // label.position.y += 20\r\n    // this.viewer.scene.add(label) // CSS3模型标签插入到场景中\r\n\r\n    // // 创建一个CSS3渲染器CSS3DRenderer\r\n    // let labelRenderer = new CSS3DRenderer()\r\n    // labelRenderer.setSize(this.viewer.canvas.width, this.viewer.canvas.height)\r\n    // labelRenderer.domElement.style.position = 'absolute'\r\n    // // 避免renderer.domElement影响HTMl标签定位，设置top为0px\r\n    // labelRenderer.domElement.style.top = '0px'\r\n    // labelRenderer.domElement.style.left = '0px'\r\n    // // 设置.pointerEvents=none，以免模型标签HTML元素遮挡鼠标选择场景模型\r\n    // labelRenderer.domElement.style.pointerEvents = 'none'\r\n    // document.body.appendChild(labelRenderer.domElement)\r\n  }\r\n}\r\n\r\n// 模型显示边框线\r\nexport class ShowEdge {\r\n  constructor (website) {\r\n    // // test start  此时mainObject 为undefined\r\n    // // console.log(viewer, 'viewer in ShowEdge')\r\n    // this.viewer = viewer\r\n    // this.mainObject = viewer.geometry.mainObject\r\n    // // console.log(this.mainObject, ' this.mainObject in ShowEdge')\r\n    // // test end\r\n    console.log(website,'websitein showedge')\r\n    this.viewer = website.viewer\r\n    this.mainObject = website.model\r\n    console.log(this.mainObject, ' this.mainObject in ShowEdge')\r\n    this.mainEdgeObject = null\r\n    this.edgeSettings = {\r\n      showEdges: false,\r\n      edgeColor: new RGBColor(0, 0, 0),\r\n      edgeThreshold: 1\r\n    }\r\n  }\r\n\r\n  UpdateWorldMatrix () {\r\n    \r\n    if (this.mainObject !== null) {\r\n   \r\n      this.mainObject.updateWorldMatrix(true, true)\r\n    }\r\n  }\r\n\r\n  // TODO 如果将不同功能抽成不同的类 每个类中都有这个方法\r\n  EnumerateMeshes (enumerator) {\r\n    console.log(this.mainObject, 'this.mainObject in modeltool')\r\n    if (this.mainObject === null) {\r\n      return\r\n    }\r\n    this.mainObject.traverse((obj) => {\r\n      if (obj.isMesh) {\r\n        // console.log(obj, 'obj in EnumerateMeshes ')\r\n        enumerator(obj)\r\n      }\r\n    })\r\n  }\r\n\r\n  EnumerateEdges (enumerator) {\r\n    if (this.mainEdgeObject === null) {\r\n      return\r\n    }\r\n    this.mainEdgeObject.traverse((obj) => {\r\n      if (obj.isLineSegments) {\r\n        enumerator(obj)\r\n      }\r\n    })\r\n  }\r\n\r\n  // 设置edges\r\n  SetEdgeSettings (model,show, color, threshold) {\r\n    this.mainObject = model\r\n    console.log(show, color, threshold, 'show, color, threshold')\r\n    let needToGenerate = false\r\n    // 如果需要显示 或者当前的显示 和 大小 不等于 设置文件中的值时\r\n    if (\r\n      show &&\r\n      (!this.edgeSettings.showEdges ||\r\n        this.edgeSettings.edgeThreshold !== threshold)\r\n    ) {\r\n      // alert('需要更新')\r\n      needToGenerate = true\r\n    }\r\n    this.edgeSettings.showEdges = show\r\n    this.edgeSettings.edgeThreshold = threshold\r\n    this.edgeSettings.edgeColor = color\r\n    console.log(this.mainObject, 'this.mainObject222222')\r\n    console.log(this.edgeSettings, 'this.edgeSettings')\r\n    if (this.mainObject === null) {\r\n      return\r\n    }\r\n    if (this.edgeSettings.showEdges) {\r\n      if (needToGenerate) {\r\n        // alert(1)\r\n        this.ClearMainEdgeObject()\r\n        this.GenerateMainEdgeObject()\r\n      } else {\r\n        // alert(2)\r\n        this.ClearMainEdgeObject()\r\n        this.GenerateMainEdgeObject()\r\n      }\r\n    } else {\r\n      this.ClearMainEdgeObject()\r\n    }\r\n  }\r\n\r\n  GenerateMainEdgeObject () {\r\n   \r\n    console.log(this.mainObject,'this.mainObject1111')\r\n\r\n    let edgeColor = ConvertColorToThreeColor(this.edgeSettings.edgeColor)\r\n    console.log(edgeColor, 'edgeColor')\r\n    this.mainEdgeObject = new THREE.Object3D()\r\n    // TODO  ？\r\n    this.UpdateWorldMatrix()\r\n\r\n    this.EnumerateMeshes((mesh) => {\r\n      // SetThreeMeshPolygonOffset(mesh, true)\r\n      // console.log(mesh, 'mesh in EnumerateMeshes  modelTool')\r\n      // ...\r\n      let edges = new THREE.EdgesGeometry(\r\n        mesh.geometry,\r\n        this.edgeSettings.edgeThreshold\r\n\r\n      )\r\n      let line = new THREE.LineSegments(\r\n        edges,\r\n        new THREE.LineBasicMaterial({\r\n          // color: edgeColor\r\n          color: 'blue'\r\n\r\n        })\r\n      )\r\n      line.applyMatrix4(mesh.matrixWorld)\r\n      line.userData = mesh.userData\r\n      line.visible = mesh.visible\r\n      this.mainEdgeObject.add(line)\r\n    })\r\n    // this.scene.add(this.mainEdgeObject)\r\n    console.log(this.mainEdgeObject, 'this.mainEdgeObject2')\r\n    console.log(this.viewer,'this.viewer')\r\n    this.viewer.scene.add(this.mainEdgeObject)\r\n    console.log(this.mainEdgeObject, 'this.mainEdgeObject3')\r\n  }\r\n\r\n  ClearMainEdgeObject () {\r\n    console.log(this.mainEdgeObject, 'this.mainEdgeObject1')\r\n    if (this.mainEdgeObject === null) {\r\n      return\r\n    }\r\n\r\n    this.EnumerateMeshes((mesh) => {\r\n      // SetThreeMeshPolygonOffset(mesh, false);\r\n    })\r\n    this.EnumerateEdges((edge) => {\r\n      edge.geometry.dispose()\r\n    })\r\n    this.viewer.scene.remove(this.mainEdgeObject)\r\n    this.mainEdgeObject = null\r\n  }\r\n}\r\n\r\n","import * as THREE from 'three'\r\nimport { DragControls } from 'three/addons/controls/DragControls.js'\r\nexport class WireFrame {\r\n   constructor(website){\r\n\r\n      this.viewer = website.viewer\r\n      this.model = null;\r\n      this.cloneModel = null;\r\n      this.dragControls = null\r\n      // this.camera = website.viewer.camera\r\n      // console.log(website.viewer.renderer,'this.cameraWireFrame') //null 将this.viewer.init 从loader提到construct\r\n      // this.renderer = website.viewer.renderer\\\r\n      this.status = ''\r\n  \r\n   }\r\n   duxian(){\r\n     \r\n   }\r\n  //  显示网格\r\n   setWireFrame(val,model){\r\n    console.log(val,'val in setWireFrame ')\r\n    // this.model = model\r\n    model.traverse((child)=>{\r\n      if (child instanceof THREE.Mesh) {\r\n           if(val){\r\n            if (child.material.length > 1) {\r\n              for (var i = 0; i < child.material.length; i++) {\r\n                child.material[i].wireframe = true\r\n              }\r\n            } else {\r\n              child.material.wireframe = true\r\n            }\r\n           }else {\r\n            if (child.material.length > 1) {\r\n              for (var i = 0; i < child.material.length; i++) {\r\n                child.material[i].wireframe = false\r\n              }\r\n            } else {\r\n              child.material.wireframe = false\r\n            }\r\n           }\r\n      }\r\n    })\r\n   }\r\n  //  拖动\r\n  dragMesh(model){\r\n    \r\n    if(!this.dragControls){\r\n      this.model = model\r\n      this.cloneModel = model.clone()\r\n      this.dragControls = new DragControls([this.model ], this.viewer.camera, this.viewer.renderer.domElement)\r\n      this.dragControls.activate();\r\n         \r\n    this.dragControls.addEventListener('dragstart', this.dragstart.bind(this))\r\n    // 拖拽结束\r\n    this.dragControls.addEventListener('dragend', this.dragend.bind(this))\r\n    }else {\r\n     \r\n      this.dragControls.removeEventListener('dragstart',this.dragstart.bind(this))\r\n      this.dragControls.removeEventListener('dragend',this.dragend.bind(this))\r\n      this.dragControls.deactivate();\r\n      this.dragControls = null\r\n     this.viewer.scene.remove(this.dragControls)\r\n    \r\n      this.dragControls = new DragControls([this.cloneModel ], this.viewer.camera, this.viewer.renderer.domElement)\r\n      this.dragControls.addEventListener('dragstart', this.dragstart.bind(this))\r\n    // 拖拽结束\r\n    this.dragControls.addEventListener('dragend', this.dragend.bind(this))\r\n     \r\n    }\r\n  \r\n\r\n\r\n  }\r\n//    dragControlsStart() {\r\n//     this.dragControls.addEventListener('dragstart', function (event) {\r\n//       this.viewer.controls.enabled = false\r\n//     });\r\n//     this.dragControls.addEventListener('dragend', function (event) {\r\n//       this.viewer.controls.enabled = true\r\n//     });\r\n// }\r\n// dragControlsStop() {\r\n//   this.dragControls.removeEventListener('dragstart', function (event) {\r\n//     this.viewer.controls.enabled = false\r\n//   });\r\n//   thsi.dragControls.removeEventListener('dragend', function (event) {\r\n//     this.viewer.controls.enabled = true\r\n//   });\r\n// }\r\ndragstart(){\r\n  this.viewer.controls.enabled = false\r\n}\r\ndragend(){\r\n  this.viewer.controls.enabled = true\r\n}\r\n  // mesh移动复位\r\n  resetDragMesh(){\r\n      this.status = '复位'\r\n      this.viewer.scene.remove(this.model)\r\n      this.viewer.scene.add(this.cloneModel)\r\n      this.model = this.cloneModel \r\n      // this.dragControls.dispose();\r\n\r\n      \r\n    \r\n  }\r\n  dragMeshs(val,model){\r\n    //  console.log(this.viewer.model,'23423423432')\r\n       if(val){\r\n           this.dragMesh(model)\r\n           this.dragControls.addEventListener('dragstart', this.dragstart.bind(this))\r\n           // 拖拽结束\r\n           this.dragControls.addEventListener('dragend', this.dragend.bind(this))\r\n       }else {\r\n        this.dragControls.removeEventListener('dragstart',this.dragstart.bind(this))\r\n        this.dragControls.removeEventListener('dragend',this.dragend.bind(this))\r\n        this.viewer.scene.remove(this.model)\r\n        this.viewer.scene.add(this.cloneModel)\r\n        this.dragMesh(this.cloneModel)\r\n       }\r\n\r\n  }\r\n}","import { RGBColor } from '../engine/model/color'\r\nexport const Theme =\r\n{\r\n  Light: 1,\r\n  Dark: 2\r\n}\r\nexport class Settings {\r\n  constructor () {\r\n    // edge\r\n    this.showEdges = true\r\n    this.edgeColor = new RGBColor(25, 25, 112)\r\n    this.edgeThreshold = 0\r\n    // theme\r\n    this.themeId = Theme.Light\r\n    // 背景图片\r\n    this.environmentMapName = 'fishermans_bastion'\r\n    this.backgroundIsEnvMap = true // 是否是环境背景\r\n\r\n    // add\r\n    // scene\r\n    this.sceneColor = 0xbfd1e5// 0xbfd1e5\r\n\r\n    // camera\r\n    this.angle = 50// 50\r\n    this.nearest = 1// 1\r\n    this.farthest = 30000// 30000\r\n  }\r\n}\r\n","import { Theme } from './settings.js'\r\nexport class ThemeHandler {\r\n  constructor () {\r\n    this.css = {\r\n      '--ov_toolbar_background_color': {}\r\n    }\r\n    let root = document.querySelector(':root')\r\n    console.log(root, 'root in theme')\r\n    let style = window.getComputedStyle(root)\r\n    // console.log(root, 'style in theme')\r\n    for (let property in this.css) {\r\n      // 对象冒充 这个对象是否有这个属性\r\n      if (Object.prototype.hasOwnProperty.call(this.css, property)) {\r\n        console.log(property, 'property')\r\n        // console.log(style.getPropertyValue(property), '获得属性值')\r\n        this.css[property].light = style.getPropertyValue(property)\r\n        this.css[property].dark = style.getPropertyValue(property + '_dark')\r\n      }\r\n    }\r\n  }\r\n\r\n  SwitchTheme (themeId) {\r\n    // console.log(themeId,typeof(themeId),'themeId 切换')\r\n    let themeName = null\r\n    if (themeId === Theme.Light) {\r\n\r\n      themeName = 'light'\r\n    } else if (themeId === Theme.Dark) {\r\n\r\n      themeName = 'dark'\r\n    } else {\r\n      return\r\n    }\r\n    let root = document.querySelector(':root')\r\n    for (let property in this.css) {\r\n      if (Object.prototype.hasOwnProperty.call(this.css, property)) {\r\n        let value = this.css[property][themeName]\r\n        if (value !== undefined) {\r\n          root.style.setProperty(property, value)\r\n          console.log(property, 'SwitchTheme-property')\r\n          console.log(value, 'SwitchTheme-value')\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { AddSvgIconElement } from './utils.js';\r\nimport { AddDiv, ClearDomElement } from '../viewer/domutils.js';\r\nimport store from '../../examples/store/index.js'\r\n// TODO engine/geometry/geometry.js\r\nexport const BigEps = 0.0001\r\nexport const RadDeg = 57.29577951308232\r\nexport function IsEqualEps (a, b, eps) {\r\n  return Math.abs(b - a) < eps\r\n}\r\n// console.log(store, 'store in measuretool')\r\n// TODO\r\nfunction GetFaceWorldNormal (intersection) {\r\n  let normalMatrix = new THREE.Matrix4() // http://t.zoukankan.com/vadim-web-p-13377796.html\r\n  intersection.object.updateWorldMatrix(true, false)\r\n  normalMatrix.extractRotation(intersection.object.matrixWorld)\r\n  let faceNormal = intersection.face.normal.clone()\r\n  faceNormal.applyMatrix4(normalMatrix)\r\n  return faceNormal\r\n}\r\n// 计算marker 之间的值\r\nfunction CalculateMarkerValues (aMarker, bMarker) {\r\n  const aIntersection = aMarker.GetIntersection()\r\n  const bIntersection = bMarker.GetIntersection()\r\n  let result = {\r\n    pointsDistance: null,\r\n    parallelFacesDistance: null,\r\n    facesAngle: null\r\n  }\r\n\r\n  const aNormal = GetFaceWorldNormal(aIntersection)\r\n  const bNormal = GetFaceWorldNormal(bIntersection)\r\n  result.pointsDistance = aIntersection.point.distanceTo(bIntersection.point)\r\n  result.facesAngle = aNormal.angleTo(bNormal)\r\n  if (IsEqualEps(result.facesAngle, 0.0, BigEps) || IsEqualEps(result.facesAngle, Math.PI, BigEps)) {\r\n    let aPlane = new THREE.Plane().setFromNormalAndCoplanarPoint(aNormal, aIntersection.point)\r\n    result.parallelFacesDistance = Math.abs(aPlane.distanceToPoint(bIntersection.point))\r\n  }\r\n  return result\r\n}\r\n//  创建材质\r\nfunction CreateMaterial () {\r\n  return new THREE.LineBasicMaterial({\r\n    // color: 0x263238,\r\n    color: 'red',\r\n    depthTest: false\r\n  })\r\n}\r\n// 创建线\r\nfunction CreateLineFromPoints (points, material) {\r\n  let geometry = new THREE.BufferGeometry().setFromPoints(points)\r\n  return new THREE.Line(geometry, material)\r\n}\r\nclass Marker {\r\n  constructor (intersection, radius) {\r\n    this.intersection = null\r\n    this.markerObject = new THREE.Object3D()\r\n    let material = CreateMaterial()\r\n    // 椭圆曲线\r\n    let circleCurve = new THREE.EllipseCurve(0.0, 0.0, radius, radius, 0.0, 2.0 * Math.PI, false, 0.0)\r\n    this.markerObject.add(CreateLineFromPoints(circleCurve.getPoints(50), material))\r\n    this.markerObject.add(CreateLineFromPoints([new THREE.Vector3(-radius, 0.0, 0.0), new THREE.Vector3(radius, 0.0, 0.0)], material))\r\n    this.markerObject.add(CreateLineFromPoints([new THREE.Vector3(0.0, -radius, 0.0), new THREE.Vector3(0.0, radius, 0.0)], material))\r\n    this.UpdatePosition(intersection)\r\n  }\r\n\r\n  UpdatePosition (intersection) {\r\n    this.intersection = intersection\r\n    // TODO meangs\r\n    let faceNormal = GetFaceWorldNormal(this.intersection)\r\n    this.markerObject.updateMatrixWorld(true)\r\n    this.markerObject.position.set(0.0, 0.0, 0.0)\r\n    this.markerObject.lookAt(faceNormal)\r\n    this.markerObject.position.set(this.intersection.point.x, this.intersection.point.y, this.intersection.point.z)\r\n  }\r\n\r\n  // 返回当前object\r\n  GetObject () {\r\n    return this.markerObject\r\n  }\r\n\r\n  // 返回选中的信息\r\n  GetIntersection () {\r\n    return this.intersection\r\n  }\r\n\r\n  Show (show) {\r\n    this.markerObject.visible = show\r\n  }\r\n}\r\nexport class MeasureTool {\r\n  constructor (viewer, settings) {\r\n    console.log(viewer, 'viewer in MeasureTool')\r\n    this.viewer = viewer\r\n    this.settings = settings\r\n    // this.isActive = false // 是否为激活状态\r\n    this.isActive = store.state.measure.isActive // 是否为激活状态\r\n    this.markers = []\r\n    this.tempMarker = null\r\n    this.panel = null;\r\n    // new\r\n    this.info = ''\r\n  }\r\n\r\n  IsActive () {\r\n     return store.state.measure.isActive\r\n    // return this.isActive\r\n  }\r\n\r\n  //  TODO\r\n  SetActive (isActive) {\r\n    store.commit('measure/IsActive',isActive)\r\n    // if (this.isActive === isActive) {\r\n    //   return // 跳出循环 阻止后面代码执行\r\n    // }\r\n    // this.isActive = isActive\r\n \r\n    // if (this.isActive) {\r\n      if (store.state.measure.isActive) {\r\n      // store.commit('/AddInfo', '选择一个点')\r\n      // this.panel = AddDiv (document.body, 'ov_measure_panel');\r\n      this.UpdatePanel()\r\n    } else {\r\n      // store.commit('measure/Reset')\r\n      this.ClearMarkers()\r\n      // this.panel.remove ();\r\n    }\r\n  }\r\n\r\n  // 鼠标点击的时候\r\n  Click (mouseCoordinates) {\r\n  \r\n    let intersection = this.viewer.GetMeshIntersectionUnderMouse(mouseCoordinates)\r\n    console.log(intersection, 'intersection in Click')\r\n    if (intersection === null) {\r\n      this.ClearMarkers()\r\n      this.UpdatePanel()\r\n      return\r\n    }\r\n    if (this.markers.length === 2) {\r\n    \r\n      this.ClearMarkers()\r\n    }\r\n    this.AddMarker(intersection)\r\n    this.UpdatePanel()\r\n  }\r\n\r\n  // 鼠标移动的时候\r\n  MouseMove (mouseCoordinates) {\r\n    let intersection = this.viewer.GetMeshIntersectionUnderMouse(mouseCoordinates)\r\n    // console.log(intersection, 'intersection in MouseMove')\r\n    if (intersection === null) {\r\n      if (this.tempMarker !== null) {\r\n        this.tempMarker.Show(false)\r\n      }\r\n      return\r\n    }\r\n    if (this.tempMarker === null) {\r\n      this.tempMarker = this.GenerateMarker(intersection)\r\n    }\r\n\r\n    this.tempMarker.UpdatePosition(intersection)\r\n    this.tempMarker.Show(true)\r\n  }\r\n\r\n  // 更新信息\r\n  UpdatePanel () {\r\n    // this.panel.style.color = '#ffffff';\r\n    // this.panel.style.backgroundColor = 'rgba(0,0,0,0.5)';\r\n    // function AddValue (panel, icon, title, value)\r\n    // {\r\n    //     let svgIcon = AddSvgIconElement (panel, icon, 'left_inline');\r\n    //     svgIcon.title = title;\r\n    //     AddDiv (panel, 'ov_measure_value', value);\r\n    // }\r\n\r\n    // TODO 关于动态创建dom的取舍 如果不用动态创建dom 就得用vuex\r\n    if (this.markers.length === 0) {\r\n      // this.panel.innerHTML = 'Select a point.';\r\n      store.commit('measure/AddInfo', '选择一个点')\r\n      store.commit('measure/Reset')\r\n      store.commit('measure/ShowMeasureInfo',false)\r\n    } else if (this.markers.length === 1) {\r\n      store.commit('measure/AddInfo', '选择另一个点')\r\n      // this.panel.innerHTML = 'Select another point.';\r\n      store.commit('measure/Reset')\r\n      store.commit('measure/ShowMeasureInfo',false)\r\n    } else {\r\n      store.commit('measure/ShowMeasureInfo',true)\r\n      let calcResult = CalculateMarkerValues(this.markers[0], this.markers[1])\r\n      if (calcResult.pointsDistance !== null) {\r\n        this.info = 'measure_distance'\r\n        store.commit('measure/AddPointsDistance', calcResult.pointsDistance.toFixed(3))\r\n        console.log(calcResult.pointsDistance.toFixed(3), 'measure_distance')\r\n        // AddValue(this.panel, 'measure_distance', 'Distance of points', calcResult.pointsDistance.toFixed(3))\r\n      }\r\n      if (calcResult.parallelFacesDistance !== null) {\r\n        this.info = 'measure_distance_parallel'\r\n        store.commit('measure/AddDistanceParallel', calcResult.parallelFacesDistance.toFixed(3))\r\n        console.log(calcResult.parallelFacesDistance.toFixed(3), 'measure_distance_parallel')\r\n        // AddValue(this.panel, 'measure_distance_parallel', 'Distance of parallel faces', calcResult.parallelFacesDistance.toFixed(3))\r\n      }\r\n      if (calcResult.facesAngle !== null) {\r\n        this.info = 'measure_angle'\r\n        let degreeValue = calcResult.facesAngle * RadDeg\r\n        store.commit('measure/AddAngel', degreeValue.toFixed(1) + '\\xB0')\r\n        console.log(degreeValue.toFixed(1) + '\\xB0', 'measure_angle')\r\n        // AddValue(this.panel, 'measure_angle', 'Angle of faces', degreeValue.toFixed(1) + '\\xB0')\r\n      }\r\n      // this.Resize ();\r\n    }\r\n  }\r\n  Resize ()\r\n  {\r\n      if (!this.isActive) {\r\n          return;\r\n      }\r\n      let canvas = this.viewer.GetCanvas ();\r\n      let canvasRect = canvas.getBoundingClientRect ();\r\n      let panelRect = this.panel.getBoundingClientRect ();\r\n      let canvasWidth = canvasRect.right - canvasRect.left;\r\n      let panelWidth = panelRect.right - panelRect.left;\r\n      this.panel.style.left = (canvasRect.left + (canvasWidth - panelWidth) / 2) + 'px';\r\n      this.panel.style.top = (canvasRect.top + 10) + 'px';\r\n  }\r\n\r\n  // 添加标记\r\n  AddMarker (intersection) {\r\n    let marker = this.GenerateMarker(intersection)\r\n    console.log(marker, 'marker in addMarker')\r\n    // this.scene.add(marker) //test\r\n    this.markers.push(marker)\r\n    if (this.markers.length === 2) {\r\n      let material = CreateMaterial()\r\n      let aPoint = this.markers[0].GetIntersection().point\r\n      let bPoint = this.markers[1].GetIntersection().point\r\n      this.viewer.AddExtraObject(CreateLineFromPoints([aPoint, bPoint], material))\r\n    }\r\n  }\r\n\r\n  GenerateMarker (intersection) {\r\n    console.log(intersection, 'intersection in GenerateMarker')\r\n    let boundingSphere = this.viewer.GetBoundingSphere((meshUserData) => {\r\n      return true\r\n    })\r\n\r\n    let radius = boundingSphere.radius / 20.0\r\n    let marker = new Marker(intersection, radius)\r\n    console.log(marker, 'marker in GenerateMarker')\r\n    this.viewer.AddExtraObject(marker.GetObject())\r\n    return marker\r\n  }\r\n\r\n  // 清除markers\r\n  ClearMarkers () {\r\n    this.viewer.ClearExtra()\r\n    this.markers = []\r\n    this.tempMarker = null\r\n  }\r\n}\r\n","\r\nimport { Navigator } from './navigator.js'\r\nimport { ShowDomElement, AddDomElement } from '../viewer/domutils.js'\r\nimport { IsSmallWidth, AddSmallWidthChangeEventListener } from './utils.js'\r\nimport { Sidebar } from './sidebar.js'\r\nimport { Viewer } from '../viewer/viewer.js'\r\nimport { HashHandler } from './hashhandler.js'// hash\r\nimport { TransformFileHostUrls } from '../engine/io/fileutils.js'\r\nimport { HandleEvent } from './eventhandler.js'\r\nimport { ThreeModelLoaderUI } from './threemodelloaderui.js'\r\n// loader\r\nimport { Loader } from '../loader/Loader.js'\r\n// importer\r\nimport {\r\n  InputFilesFromUrls,\r\n  InputFilesFromFileObjects\r\n} from '../engine/import/importerfiles.js'\r\n// 通过拖拽导入\r\nimport { GetFilesFromDataTransfer } from './utils.js'\r\nimport { ModelTool, ShowEdge} from '../modelTool/modelTool.js'\r\nimport {WireFrame} from '../modelTool/wireframe.js'\r\n// 设置\r\nimport { Settings } from './settings.js'\r\n// 主题\r\nimport { ThemeHandler } from './themehandler.js'\r\nimport { MeasureTool } from './measuretool.js'\r\n\r\nimport { FBXLoader } from 'three/examples/jsm/loaders/FBXLoader'\r\nimport { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js'\r\n// 爆炸\r\nimport {initExplodeModel,explodeModel} from '../modelTool/blastTool.js'\r\n// 测试 js 文件通知vue文件\r\nimport { EventDispatcher } from '../utils/EventDispatcher/EventDispatcher.js'\r\n// editor\r\n// import { Editor } from '../editor/editor.js'// 历史记录 等功能\r\n// import { ViewerModel } from './viewmodel.js'// 处理model mesh material geometry texture的一些方法\r\n\r\n// 消息通知\r\n// const Signal = require('signals')\r\n// console.log(Signal, 'Signal')\r\nimport store from '../../examples/store'\r\n// website状态\r\nlet progressBarDiv,loadingDiv\r\nfunction showProgressBar () {\r\n  document.body.appendChild(progressBarDiv)\r\n}\r\nfunction hideProgressBar () {\r\n  document.body.removeChild(progressBarDiv)\r\n}\r\nfunction updateProgressBar (fraction) {\r\n  // progressBarDiv.innerText = 'Loading... ' + Math.round(fraction * 100, 2) + '%'\r\n  // progressBarDiv.innerText = 'Loading... '\r\n}\r\nfunction onProgress (xhr) {\r\n  if (xhr.lengthComputable) {\r\n    updateProgressBar(xhr.loaded / xhr.total)\r\n\r\n    console.log(Math.round(xhr.loaded / xhr.total * 100, 2) + '% downloaded')\r\n  }\r\n}\r\n\r\nfunction onError (error) {\r\n  const message = 'Error loading model'\r\n  progressBarDiv.innerText = message\r\n  console.log(message)\r\n  console.error(error)\r\n}\r\nexport const WebsiteUIState = {\r\n  Undefined: 0,\r\n  Intro: 1,\r\n  Model: 2,\r\n  Loading: 3\r\n}\r\nlet self = true // 两种开发模式开关\r\nexport class Website extends EventDispatcher {\r\n  constructor (parameters) {\r\n    super()\r\n    // 消息通知\r\n   \r\n    this.signals = {\r\n      // missingFile: new Signal(),\r\n      // windowResize: new Signal(),\r\n      // // add\r\n      // sceneAdded: new Signal(),\r\n      // objectAdded: new Signal(),\r\n      // geometryAdded: new Signal(),\r\n      // materialAdded: new Signal(),\r\n      // historyChanged: new Signal()\r\n    }\r\n\r\n    this.parameters = parameters\r\n    // 设置\r\n    this.settings = new Settings()\r\n    // // 左侧\r\n    // this.navigator = new Navigator(this.parameters.navigatorDiv, this.parameters.navigatorSplitterDiv)\r\n    // // 右侧\r\n    // this.sidebar = new Sidebar(\r\n    //   this.parameters.sidebarDiv,\r\n    //   this.parameters.sidebarSplitterDiv,\r\n    //   this.settings\r\n    // )\r\n    // 视图区\r\n    this.viewer = new Viewer(this.parameters.viewerDiv, this.parameters.view2, this.settings, this)\r\n    // let canvas = this.parameters.viewerDiv;// temp\r\n    let canvas = AddDomElement(this.parameters.viewerDiv, 'canvas')\r\n    console.log(canvas, 'canvas11111')\r\n    this.viewer.Init(canvas)// InitViewer 初始化视图\r\n    // state状态\r\n    this.uiState = WebsiteUIState.Undefined\r\n    // url hash 状态\r\n    this.hashHandler = new HashHandler()\r\n    // 加载模型ui\r\n    this.modelLoaderUI = new ThreeModelLoaderUI()\r\n    // 加载模型loader\r\n    // this.loader = new Loader(this, this.viewer, this.signals)\r\n    this.loader = new Loader(this, this.viewer)\r\n    // 主题类\r\n    this.themeHandler = new ThemeHandler()\r\n    // 测量类\r\n    this.measureTool = new MeasureTool(this.viewer, this.settings)\r\n\r\n    // 模型\r\n    this.model = null\r\n    this.cloneModel = null;\r\n        // edge 否则每次初始化mainedgeobject 都是null\r\n        // this.showEdge = new ShowEdge(this.viewer)\r\n    this.showEdge = new ShowEdge(this)\r\n    this.wireFrame = new WireFrame(this)\r\n\r\n\r\n    // progressBarDiv = document.createElement('div')\r\n    // progressBarDiv.innerText = 'Loading...'\r\n    // progressBarDiv.style.fontSize = '3em'\r\n    // progressBarDiv.style.color = '#409eff'\r\n    // progressBarDiv.style.display = 'block'\r\n    // progressBarDiv.style.position = 'absolute'\r\n    // progressBarDiv.style.top = '50%'\r\n    // progressBarDiv.style.width = '100%'\r\n    // progressBarDiv.style.textAlign = 'center'\r\n   \r\n    progressBarDiv = document.createElement('div')\r\n    progressBarDiv.style.position = 'absolute'\r\n    progressBarDiv.style.top = '0'\r\n    progressBarDiv.style.opacity='0.8'\r\n    progressBarDiv.style.width = '100%'\r\n    progressBarDiv.style.height = '100%'\r\n    progressBarDiv.style.display='flex'\r\n    progressBarDiv.style.alignItems='center'\r\n    progressBarDiv.style.justifyContent='center'\r\n    progressBarDiv.style.background = '#616161'\r\n\r\n    // loadingDiv = document.createElement('div')\r\n    // loadingDiv.innerText = 'Loading...'\r\n    loadingDiv = document.createElement('img')\r\n    loadingDiv.src = 'images/loading.gif'\r\n    loadingDiv.style.width = '200px'\r\n    loadingDiv.style.height='200px'\r\n\r\n    progressBarDiv.appendChild(loadingDiv)\r\n\r\n     \r\n  }\r\n  start (val) {\r\n    this.dispatchEvent({ type: 'start', message: 'blas val change'+val })\r\n  }\r\n  Load (edgeVal) {\r\n\r\n    store.dispatch('app/showLoading', true)\r\n    // progressBarDiv.innerText = 'Loading...'\r\n    updateProgressBar(0)\r\n    showProgressBar()\r\n    // 设置主题颜色\r\n    // this.SwitchTheme(this.settings.themeId, true)\r\n    // this.editor = new Editor(this)\r\n    //  加载模型测试  可删除\r\n    const fbxloader = new FBXLoader()\r\n    // const path = '/static/models/fbx/不支持的/'\r\n    // fbxloader.load(`${path}stanford-bunny.fbx`, (object) => {\r\n    // fbx2\r\n    // const path = '/static/models/fbx/'// 长宽高为1的模型 测试相机\r\n    // fbxloader.load(`${path}test.fbx`, (object) => {\r\n\r\n      const path = 'static/models/fbx/jiaju/'\r\n      fbxloader.load(`${path}damo.fbx`, (object) => {\r\n      console.log(object, 'object in Load')\r\n      const threeObject = object\r\n      this.model = object\r\n      this.cloneModel = object\r\n      this.viewer.SetMainObject(threeObject)\r\n      // this.parameters.callback&&this.parameters.callback()\r\n      // this.editor.addObject(threeObject)\r\n          // 爆炸 \r\n       initExplodeModel(threeObject)\r\n      // 适配窗口\r\n      this.FitModelToWindow(true)\r\n      // this.editor.FitModelToWindow(true)\r\n      // 通过包围盒设置模型居中 TODO\r\n      // TODO\r\n      // 是这个影响了相机位置\r\n      // this.modelTool = new ModelTool(this.viewer)\r\n      // this.modelTool.modelCenter(threeObject)\r\n      // 设置方向\r\n      // that.viewer.SetUpVector(Direction.Y, false)\r\n      // edges\r\n      // this.showEdge = new ShowEdge(this.viewer)\r\n      // if (this.settings.showEdges) {\r\n \r\n      //   this.showEdge.GenerateMainEdgeObject(threeObject)\r\n      // }\r\n     this.UpdateEdgeDisplay(true,edgeVal,)\r\n    \r\n    store.dispatch('app/showLoading', false)\r\n      hideProgressBar()\r\n      // store.dispatch('showLoading', false)\r\n    }, onProgress, onError)\r\n\r\n    this.UpdateEnvironmentMap()// 背景图片\r\n    // 事件\r\n    this.viewer.SetMouseClickHandler(this.OnModelClicked.bind(this))\r\n    this.viewer.SetMouseMoveHandler(this.OnModelMouseMoved.bind(this))\r\n    this.InitDragAndDrop()// 通过拖拽导入\r\n\r\n    // this.sidebar.Init({ // InitSidebar 初始化左视图\r\n    //   onResize: () => {\r\n    //     this.Resize()\r\n    //   }\r\n    // })\r\n    // this.navigator.Init({ // InitNavigator 初始化右侧视图\r\n    //   onResize: () => {\r\n    //     this.Resize()\r\n    //   }\r\n    // })\r\n\r\n    this.Resize() // 重置大小\r\n    // 根据不同的状态显示不同的dom\r\n    // this.SetUIState(WebsiteUIState.Model)// 2\r\n    //  如果小雨800px\r\n    // AddSmallWidthChangeEventListener(() => {\r\n    //   this.OnSmallWidthChanged()\r\n    // })\r\n    // 监听窗口改变事件\r\n    window.addEventListener('resize', () => {\r\n      // this.signals.windowResize.dispatch()\r\n      this.Resize()\r\n    })\r\n  \r\n    // url 变化\r\n    this.hashHandler.SetEventListener(this.OnHashChange.bind(this))\r\n    this.OnHashChange()\r\n  }\r\n\r\n  // 通过拖拽导入的方式\r\n  InitDragAndDrop () {\r\n    window.addEventListener(\r\n      'dragstart',\r\n      (ev) => {\r\n        ev.preventDefault()\r\n      },\r\n      false\r\n    )\r\n    window.addEventListener(\r\n      'dragover',\r\n      (ev) => {\r\n        ev.stopPropagation()\r\n        ev.preventDefault()\r\n        ev.dataTransfer.dropEffect = 'copy'\r\n      },\r\n      false\r\n    )\r\n    window.addEventListener(\r\n      'drop',\r\n      (ev) => {\r\n        ev.stopPropagation()\r\n        ev.preventDefault()\r\n\r\n        if (self) {\r\n          // way2\r\n          if (event.dataTransfer.types[0] === 'text/plain') return // Outliner drop\r\n          // dataTransfer.items和dataTransfer.files之间的主要区别在于dataTransfer.items还包含子目录。\r\n          // 拖一个文件 或是文件夹\r\n          if (event.dataTransfer.items) {\r\n            this.loader.loadItemList(event.dataTransfer.items, {\r\n            // onStart: () => {\r\n            //   alert('start')\r\n            // },\r\n\r\n              // onFinish: (threeObject) => {\r\n              //   alert('Finish')\r\n\r\n              // },\r\n              // onRender: () => {},\r\n              // onError: () => {}\r\n              onLoadStart: () => {\r\n                this.ClearModel()\r\n                store.dispatch('app/showLoading', true)\r\n                // alert('Loading Model start')\r\n                console.log('Loading Model start')\r\n                // progressBarDiv.innerText = 'Loading...'\r\n                updateProgressBar( 0 );\r\n                showProgressBar();\r\n              },\r\n              onFileListProgress: (current, total) => {\r\n                console.log(current, total, ' onFileListProgress')\r\n              },\r\n              onFileLoadProgress: (current, total) => {\r\n                console.log(current, total, ' onFileLoadProgress')\r\n                updateProgressBar(current / total)\r\n                console.log(Math.round(current / total * 100, 2) + '% downloaded')\r\n              },\r\n              onSelectMainFile: () => {\r\n\r\n              },\r\n              onImportStart: () => {\r\n                // alert('Importing Model')\r\n              },\r\n              onVisualizationStart: () => {\r\n\r\n              },\r\n              onModelFinished: (threeObject) => {\r\n                this.OnModelLoaded(threeObject)\r\n                store.dispatch('app/showLoading', false)\r\n                hideProgressBar()\r\n              },\r\n              onTextureLoaded: () => {\r\n\r\n              },\r\n              onLoadError: (message) => {   \r\n                progressBarDiv.innerText = message;\r\n              }\r\n            })\r\n          }\r\n        } else {\r\n          // way1\r\n          GetFilesFromDataTransfer(ev.dataTransfer, (files) => {\r\n          // console.log(files, 'files in GetFilesFromDataTransfer ');// [File,File] file数组\r\n            if (files.length > 0) {\r\n              HandleEvent('model_load_started', 'drop')\r\n              this.LoadModelFromFileList(files)\r\n            }\r\n          })\r\n        }\r\n      },\r\n      false\r\n    )\r\n  }\r\n\r\n  //  hash 的方式\r\n  OnHashChange () {\r\n    //  如果有hash 执行\r\n    if (this.hashHandler.HasHash()) {\r\n      let urls = this.hashHandler.GetModelFilesFromHash()\r\n      // console.log(urls, 'urls in OnHashChange');\r\n      if (urls === null) {\r\n        return\r\n      }\r\n\r\n      // TransformFileHostUrls(urls);// 以某个域名替换某个域名\r\n      HandleEvent('model_load_started', 'hash') // 当前执行记录\r\n      let importSettings = {}// temp\r\n      this.LoadModelFromUrlList(urls, importSettings)\r\n    } else {\r\n      // alert('wu')\r\n    }\r\n  }\r\n\r\n  // 通过url hash 加载的方式\r\n  LoadModelFromUrlList (urls, settings) {\r\n    console.log(urls, 'urls in  LoadModelFromUrlList') // [url1,...]\r\n\r\n    if (self) {\r\n      // TODO 没有合并到一个函数LoadModelFromInputFiles处理\r\n      this.loader.loadItemUrls(urls, {\r\n        onLoadStart: () => {\r\n          this.ClearModel()\r\n          store.dispatch('app/showLoading', true)\r\n          // progressBarDiv.innerText = 'Loading...'\r\n          updateProgressBar( 0 );\r\n          showProgressBar();\r\n          console.log('Loading Model start')\r\n        },\r\n        onFileListProgress: (current, total) => {\r\n          console.log(current, total, ' onFileListProgress')\r\n        },\r\n        onFileLoadProgress: (current, total) => {\r\n          console.log(current, total, ' onFileLoadProgress')\r\n          updateProgressBar(current / total)\r\n          console.log(Math.round(current / total * 100, 2) + '% downloaded')\r\n        },\r\n        onSelectMainFile: () => {\r\n\r\n        },\r\n        onImportStart: () => {\r\n          // alert('Importing Model')\r\n        },\r\n        onVisualizationStart: () => {\r\n\r\n        },\r\n        onModelFinished: (threeObject) => {\r\n          this.OnModelLoaded(threeObject)\r\n          hideProgressBar()\r\n          store.dispatch('app/showLoading', false)\r\n        },\r\n        onTextureLoaded: () => {\r\n\r\n        },\r\n        onLoadError: (error) => {\r\n          const message = 'Error loading model';\r\n          progressBarDiv.innerText = message;\r\n          console.log( message );\r\n          console.error( error );\r\n        }\r\n\r\n        // onStart: () => {\r\n        //   alert('start')\r\n        //   this.ClearModel()\r\n        // },\r\n        // onFinish: (threeObject) => {\r\n        //   // alert('Finish')\r\n        //   this.OnModelLoaded(threeObject)\r\n        // },\r\n        // onRender: () => {},\r\n        // onError: () => {}\r\n      })\r\n    } else {\r\n      // TODO\r\n      let inputFiles = InputFilesFromUrls(urls)\r\n      console.log(inputFiles, 'inputFiles in hash') // [InputFile:[data:https://xiaokaixuan.oss-cn-beijing.aliyuncs.com/fbx/jiaju/damo.obj',name:'damo.obj\",source:1]]\r\n      this.LoadModelFromInputFiles(inputFiles, settings)\r\n      this.ClearHashIfNotOnlyUrlList()\r\n    }\r\n  }\r\n\r\n  //  通过拖拽文件 或文件夹的方式导入\r\n  LoadModelFromFileList (files) {\r\n    let importSettings = {}// temp\r\n    let inputFiles = InputFilesFromFileObjects(files)\r\n    console.log(inputFiles, 'inputFiles in drag')// [InputFile:[data:File,name:'damo.obj\",source:1]]\r\n\r\n    this.LoadModelFromInputFiles(inputFiles, importSettings)\r\n  }\r\n\r\n  // 加载模型的方法\r\n  LoadModelFromInputFiles (files, settings) {\r\n    // 下面只供参考形式\r\n    // way1\r\n    // let filesArr = []\r\n    // for (let inputFile of files) {\r\n    //   let file = { name: inputFile.name, source: inputFile.source, data: inputFile.data, content: '', extension: '' }\r\n    //   filesArr.push(file)\r\n    // }\r\n    // console.log(filesArr, 'filesArr in LoadModelFromInputFiles')\r\n    // way1 change\r\n    // this.loader.loadItemUrls(files)\r\n\r\n    // way2 online\r\n    this.modelLoaderUI.LoadModel(files, settings, {\r\n      onStart: () => {\r\n        // alert('start')\r\n      },\r\n      onFinish: () => {},\r\n      onRender: () => {},\r\n      onError: () => {}\r\n    })\r\n  }\r\n\r\n  ClearHashIfNotOnlyUrlList () {\r\n\r\n  }\r\n\r\n  //  根据加载状态设置dom 显示\r\n  SetUIState (uiState) {\r\n    if (this.uiState === uiState) {\r\n      return\r\n    }\r\n    this.uiState = uiState\r\n    if (this.uiState === WebsiteUIState.Intro) {\r\n\r\n    } else if (this.uiState === WebsiteUIState.Model) {\r\n      ShowDomElement(this.parameters.mainDiv, true)\r\n    } else if (this.uiState === WebsiteUIState.Loading) {\r\n\r\n    }\r\n    this.Resize()\r\n  }\r\n\r\n  // 点击\r\n  \r\n  OnModelClicked (button, mouseCoordinates) {\r\n\r\n    // 高亮\r\n    // this.viewer.outline.Click2(mouseCoordinates) //\r\n    this.viewer.outline.Click(mouseCoordinates)\r\n    // console.log(this.viewer.outline.getSelectedObject().name,'getSelectedObject')\r\n    // console.log(this, 'this in OnModelClicked')\r\n    console.log(button, mouseCoordinates, 'mouseCoordinates in OnModelClicked')\r\n    if (button !== 1) {\r\n      return\r\n    }\r\n    if (this.measureTool.IsActive()) {\r\n      this.measureTool.Click(mouseCoordinates)\r\n    }\r\n  }\r\n\r\n  OnModelMouseMoved (mouseCoordinates) {\r\n    // console.log(mouseCoordinates, 'mouseCoordinates')\r\n    if (this.measureTool.IsActive()) {\r\n      this.measureTool.MouseMove(mouseCoordinates)\r\n    }\r\n  }\r\n \r\n  // 模型加载\r\n  OnModelLoaded (threeObject) {\r\n    console.log(threeObject, 'threeObject in OnModelLoaded')\r\n    this.model = threeObject\r\n    this.cloneModel = threeObject\r\n    // this.viewer.scene.add(threeObject)\r\n    this.viewer.SetMainObject(threeObject)\r\n    // this.editor.addObject(threeObject)\r\n    // 爆炸 \r\n    initExplodeModel(threeObject)\r\n    // 适配窗口\r\n    this.FitModelToWindow(true)\r\n    // TODO 下面代码如何放在 load里 以及是否借用vuex来传入object\r\n    // add 应该在加载模型之后 否则没有object\r\n    // 操作模型的工具方法\r\n    // this.modelTool = new ModelTool(this.viewer)\r\n    // this.modelTool.modelCenter(threeObject)\r\n    // this.modelTool.resetCamera(threeObject, true)\r\n    // edges\r\n    // if (this.settings.showEdges) {\r\n     \r\n    //   this.showEdge.GenerateMainEdgeObject(threeObject)\r\n    // }\r\n    this.UpdateEdgeDisplay(true)\r\n    // 重置状态\r\n  \r\n    // this.showEdge.SetEdgeSettings(\r\n    //   this.settings.showEdges,\r\n    //   this.settings.edgeColor,\r\n    //   this.settings.edgeThreshold\r\n    // )\r\n  }\r\n\r\n  FitModelToWindow (onLoad) {\r\n    let animation = !onLoad\r\n    // 中心和半径\r\n    let boundingSphere = this.viewer.GetBoundingSphere((meshUserData) => {\r\n      console.log(meshUserData, 'meshUserData')\r\n      return true\r\n      // return this.navigator.IsMeshVisible (meshUserData.originalMeshId);\r\n    })\r\n    console.log(boundingSphere, 'boundingSphere')\r\n    if (onLoad) {\r\n      // 更改相机near  和far\r\n      this.viewer.AdjustClippingPlanesToSphere(boundingSphere)\r\n    }\r\n    this.viewer.FitSphereToWindow(boundingSphere, animation)\r\n  }\r\n  // 清除模型\r\n\r\n  ClearModel () {\r\n    this.model = null\r\n    this.viewer.Clear()\r\n    console.log(this.showEdge.mainEdgeObject,'in ClearModel') //有\r\n  \r\n  }\r\n\r\n  // 尺寸小于800px时\r\n  OnSmallWidthChanged () {\r\n    // if (this.uiState === WebsiteUIState.Model) {\r\n    //   this.UpdatePanelsVisibility();\r\n    // }\r\n  }\r\n\r\n  // 是否显示左右两侧\r\n  UpdatePanelsVisibility () {\r\n    let showNavigator = false\r\n    let showSidebar = false\r\n    this.navigator.ShowPanels(showNavigator)\r\n    this.sidebar.ShowPanels(showSidebar)\r\n  }\r\n\r\n  //  navigator 改变的时候执行，一开始执行 计算sidebar main navigator 的值\r\n  Resize () {\r\n    // let windowWidth = window.innerWidth\r\n    // let windowHeight = window.innerHeight\r\n    // let headerHeight = this.parameters.headerDiv.offsetHeight\r\n    // console.log(headerHeight, 'headerHeight')\r\n    // let navigatorWidth = 0\r\n    // let sidebarWidth = 0\r\n    // let safetyMargin = 0// ?\r\n    // if (!IsSmallWidth()) {\r\n    //   // 左侧\r\n    //   navigatorWidth = this.navigator.GetWidth()\r\n    //   // TODO\r\n    //   sidebarWidth = this.sidebar.GetWidth()// 右侧\r\n    //   // TODO 14 临时\r\n    //   safetyMargin = 12 + 2 + 2 // 14为safety  2 为canvas border  2 为main容器的border\r\n    // }\r\n\r\n    // const minContentWidth = 50\r\n    // console.log(windowWidth, 'windowWidth') // 1105\r\n    // console.log(sidebarWidth, 'sidebarWidth') // 280  282+12=   294\r\n    // console.log(navigatorWidth, 'navigatorWidth') // 280 282+12 =294\r\n    // // 1210- 294 -294 = 622\r\n    // let contentWidth = windowWidth - navigatorWidth - sidebarWidth\r\n    // if (contentWidth < minContentWidth) {\r\n    //   alert(1)\r\n    // }\r\n    // console.log(contentWidth, 'contentWidth') // 517\r\n    // let contentHeight = windowHeight - headerHeight\r\n    // this.navigator.Resize(contentHeight)\r\n    // this.sidebar.Resize(contentHeight)\r\n    // // TODO\r\n    this.viewer.Resize()// 内容区;\r\n  }\r\n\r\n  //  设置主题颜色\r\n  SwitchTheme (newThemeId, resetColors) {\r\n    console.log(newThemeId, 'newThemeId in SwitchTheme')\r\n    this.settings.themeId = newThemeId\r\n    this.themeHandler.SwitchTheme(this.settings.themeId)\r\n  }\r\n\r\n  // edge\r\n  UpdateEdgeDisplay (show, val = 40) {\r\n   \r\n    this.settings.showEdges = show\r\n    if (show) {\r\n     \r\n      this.settings.edgeThreshold = val\r\n    } else {\r\n      this.settings.edgeThreshold = 0\r\n    }\r\n    this.showEdge.SetEdgeSettings(\r\n      this.model,\r\n      this.settings.showEdges,\r\n      this.settings.edgeColor,\r\n      this.settings.edgeThreshold\r\n    )\r\n  }\r\n\r\n  // 更新背景图片\r\n  onEnvironmentMapChange () {\r\n    this.UpdateEnvironmentMap()\r\n  }\r\n\r\n  UpdateEnvironmentMap () {\r\n    // 因为加“/”的意思是根目录下的绝对路径，不加“/”的意思是当前目录下的相对路径。\r\n    // let envMapPath = '/static/envmaps/' + this.settings.environmentMapName + '/'\r\n    let envMapPath = 'static/envmaps/' + this.settings.environmentMapName + '/'\r\n    let envMapTextures = [\r\n      envMapPath + 'posx.jpg',\r\n      envMapPath + 'negx.jpg',\r\n      envMapPath + 'posy.jpg',\r\n      envMapPath + 'negy.jpg',\r\n      envMapPath + 'posz.jpg',\r\n      envMapPath + 'negz.jpg'\r\n    ]\r\n    this.viewer.SetEnvironmentMapSettings(envMapTextures, this.settings.backgroundIsEnvMap)\r\n  }\r\n  // 爆炸\r\n  Blast (model, val) {\r\n    explodeModel(model, val)\r\n  }\r\n  // 测量\r\n  Measure(val){\r\n    this.measureTool.SetActive(val);\r\n  }\r\n\r\n\r\n}\r\n","import { Website } from './website.js'\r\nimport { SetExternalLibLocation } from '../engine/io/externallibs.js'\r\nimport { SetEventHandler } from './eventhandler.js'\r\n// editor\r\n// import { Editor } from '../editor/editor.js'\r\n// const editor = new Editor()\r\nexport function SetWebsiteEventHandler (eventHandler) {\r\n  // 添加事件监听器\r\n  SetEventHandler(eventHandler)\r\n}\r\n\r\nexport function StartWebsite (externalLibLocation,edgeVal) {\r\n  SetExternalLibLocation(externalLibLocation)\r\n  const website = new Website({\r\n    viewerDiv: document.getElementById('main_viewer')\r\n\r\n  })\r\n  website.Load(edgeVal)\r\n  return website\r\n}\r\n","export function fullScreen(elem){\r\n\r\n  if ((window.innerWidth === screen.width && window.innerHeight === screen.height) || (window.fullScreen)) {\r\n    exitFullscreen()\r\n  } else {\r\n    enterFullscreen(elem)\r\n  }\r\n  // enterFullscreen(document.documentElement)\r\n  // if ((window.innerWidth === screen.width && window.innerHeight === screen.height) || (window.fullScreen)) {\r\n  //   exitFullscreen()\r\n  // } else {\r\n  //   enterFullscreen(document.documentElement)\r\n  // }\r\n}\r\n\r\nfunction   enterFullscreen (el) {\r\n \r\n  if (el.requestFullscreen) {\r\n    el.requestFullscreen()\r\n  } else if (el.msRequestFullscreen) {\r\n    el.msRequestFullscreen()\r\n  } else if (el.mozRequestFullScreen) {\r\n    el.mozRequestFullScreen()\r\n  } else if (el.webkitRequestFullscreen) {\r\n    el.webkitRequestFullscreen()\r\n  } else {\r\n    noFullscreenSupport()\r\n  }\r\n}\r\nfunction   exitFullscreen () {\r\n  if (document.exitFullscreen) {\r\n    document.exitFullscreen()\r\n  } else if (document.msExitFullscreen) {\r\n    document.msExitFullscreen()\r\n  } else if (document.mozCancelFullScreen) {\r\n    document.mozCancelFullScreen()\r\n  } else if (document.webkitExitFullscreen) {\r\n    document.webkitExitFullscreen()\r\n  } else {\r\n    this.noFullscreenSupport()\r\n  }\r\n}\r\nfunction   noFullscreenSupport () {\r\n  alert('Your browser does not support the Fullscreen API.')\r\n}","import Vue from 'vue'\nimport Vuex from 'vuex'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n  },\n  getters: {\n  },\n  mutations: {\n  },\n  actions: {\n  },\n  modules: {\n  }\n})\n","<template>\r\n  <div class=\"viewer\">\r\n    <div id=\"model-wrapper\" class=\"model-wrapper\">\r\n      <div id=\"main_viewer\" class=\"main_viewer\" v-loading=\"showLoading\" element-loading-text=\"拼命加载中\"\r\n        element-loading-spinner=\"el-icon-loading\" element-loading-background=\"rgba(0, 0, 0, 0.8)\">\r\n      </div>\r\n      <!-- :style=\"{ left: (isActive ? -100% : 0) }\" -->\r\n      <div class=\"side_menu_wrap\" :class=\"[isActive ? 'left0' : 'left200']\">\r\n        <div class=\"side-menu\">\r\n          <!-- <button v-if=\"hasEyeDrop\" @click=\"nativePick\">点击取色</button>\r\n          <input v-else type=\"color\" @input=\"nativePick\" /> -->\r\n          <p class=\"label_row\">\r\n            <span>背景</span>\r\n          </p>\r\n          <div class=\"btns\">\r\n            <!-- <span class=\"active\">默认</span>\r\n            <span>深色</span>\r\n            <span>浅色</span> -->\r\n            <span :class=\"[tabIndex == index ? 'active' : '']\" v-for=\"(item, index) in btns\" :key=\"index\"\r\n              @click=\"backgroundTabClick(index)\">{{\r\n                item\r\n              }}</span>\r\n          </div>\r\n          <p class=\"label_row\">\r\n            <span>背景图片</span>\r\n          </p>\r\n          <div class=\"envMaps\">\r\n            <el-image v-for=\"(item, index) in   envMaps\" :key=\"index\" class=\"img\"\r\n              @click=\"SetEnvironment(item.name, item.backgroundIsEnvMap)\" style=\"width: 45px; height: 45px\"\r\n              :src=\"item.url\"></el-image>\r\n          </div>\r\n          <p class=\"label_row\">\r\n            <!-- <span>模型拆分 {{ getBlastVal }}{{ blastVal }}</span> -->\r\n            <span>Edges</span>\r\n          </p>\r\n          <div class=\"blast-slider\">\r\n            <!-- 爆炸滑块 slideValue -->\r\n            <el-slider v-show=\"showSlider\" v-model=\"edgeVal\" :min=\"0\" :max=\"100\" @change=\"edgeChange\">\r\n            </el-slider>\r\n          </div>\r\n          <p class=\"label_row\">\r\n            <!-- <span>模型拆分 {{ getBlastVal }}{{ blastVal }}</span> -->\r\n            <span>模型拆分</span>\r\n          </p>\r\n          <div class=\"blast-slider\">\r\n            <!-- 爆炸滑块 slideValue -->\r\n            <el-slider v-show=\"showSlider\" v-model=\"blastVal\" :min=\"1\" :max=\"100\" @change=\"blastChange\">\r\n            </el-slider>\r\n          </div>\r\n\r\n          <el-row class=\"row\">\r\n            <span>显示网格</span>\r\n            <el-switch @change=\"changeWange\" v-model=\"wanggeValue\" active-color=\"#13ce66\" inactive-color=\"#ff4949\">\r\n            </el-switch>\r\n          </el-row>\r\n          <el-row class=\"row\">\r\n            <span>自动旋转</span>\r\n            <el-switch @change=\"autoRotation\" v-model=\"rotationValue\" active-color=\"#13ce66\" inactive-color=\"#ff4949\">\r\n            </el-switch>\r\n          </el-row>\r\n\r\n          <!-- <el-button @click=\"dragMeshs\" :class=\"[dragMeshBtn ? 'active' : '']\">\r\n          {{ dragMeshBtn ? 'mesh复位' : 'mesh移动' }}\r\n        </el-button> -->\r\n          <p class=\"label_row\">\r\n            <span>模型操作</span>\r\n          </p>\r\n\r\n          <div class=\"items\">\r\n            <!-- <span class=\"icon iconfont icon-yidong\"></span>\r\n            <div class=\"name\">\r\n              移动\r\n            </div> -->\r\n            <span :class=\"[ifduxian ? 'active' : '']\" @click=\"duxian\">\r\n              <i class=\"icon  iconfont\" :class=\"[ifduxian ? 'icon-quanbu' : 'icon-yanjing']\"></i>\r\n              <b>{{ ifduxian? '全显': '独显' }}</b>\r\n            </span>\r\n            <!-- <span>\r\n              <i class=\"icon iconfont icon-quanxianshi-copy\"></i>\r\n              <b>全显</b>\r\n            </span>\r\n            <span>\r\n              <i class=\"icon iconfont icon-malatang\"></i>\r\n              <b>独显</b>\r\n            </span> -->\r\n            <span :class=\"[dragMeshBtn ? 'active' : '']\" @click=\"dragMesh\">\r\n              <i class=\"icon  iconfont icon-yidong\"></i>\r\n              <b>移动</b>\r\n            </span>\r\n            <!-- <span @click=\"resetDragMesh\">\r\n              <i class=\"icon iconfont icon-ic_fuwei\"></i>\r\n              <b>复位</b>\r\n            </span> -->\r\n            <span @click=\"reset\">\r\n              <i class=\"icon iconfont icon-ic_fuwei\"></i>\r\n              <b>重置</b>\r\n            </span>\r\n            <span @click=\"celiang\" :class=\"[MeasureisActive ? 'active' : '']\">\r\n              <i class=\"icon iconfont icon-chizi\"></i>\r\n              <b>测量</b>\r\n            </span>\r\n            <span @click=\"yincang\">\r\n              <i class=\"icon iconfont icon-yincang\"></i>\r\n              <b>隐藏</b>\r\n            </span>\r\n\r\n            <!-- <span :class=\"{ 'active': toumingBtn }\" @click=\"touming\">\r\n              <i class=\"icon iconfont icon-dibiaotouming\"></i>\r\n              <b>{{ toumingBtn? '取消': '透明' }}</b>\r\n            </span> -->\r\n            <span @click=\"touming2\">\r\n              <i class=\"icon iconfont icon-toumingdutiaojie\"></i>\r\n              <b>透明</b>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div class=\"switch\" @click=\"switchleft\">\r\n          <i class=\"icon iconfont \" :class=\"[isActive ? 'icon-zuojiantou-copy ' : 'icon-zuojiantou']\"></i>\r\n        </div>\r\n      </div>\r\n      <div class=\"full-sceen\" @click=\"fullScreen\">\r\n        <i class=\"icon iconfont \" :class=\"[fullScreenBtn ? 'icon-quanping' : 'icon-quxiaoquanping']\"\r\n          style=\"font-size: 26px;\"></i>\r\n      </div>\r\n      <div class=\"measureInfo\" v-if=\"MeasureisActive\">\r\n        <div v-if=\"!showMeasureIInfo\">\r\n          <span> {{ info }}</span>\r\n        </div>\r\n        <div v-else>\r\n          <span>\r\n            <i class=\"icon iconfont icon-guanxianchangdu\"></i>\r\n            <b>{{ pointsDistance }}</b>\r\n          </span>\r\n          <!-- <span >\r\n            <i class=\"icon iconfont icon-toumingdutiaojie\"></i>\r\n            <b>{{ parallelFacesDistance }}</b>\r\n          </span> -->\r\n          <span>\r\n            <i class=\"icon iconfont icon-jiaodu\"></i>\r\n            <b>{{ facesAngle }}</b>\r\n          </span>\r\n        </div>\r\n\r\n      </div>\r\n\r\n\r\n\r\n      <!-- model: {{ model }}\r\n      操作区\r\n      height }}\r\n      使用elementui 的方式 -->\r\n    </div>\r\n  </div>\r\n\r\n</template>\r\n<script>\r\nimport {\r\n  mapState,\r\n  mapGetters,\r\n  mapMutations\r\n} from 'vuex'\r\n// import Vue from 'vue';\r\n// import { ElSwitch} from 'element-ui';\r\n// Vue.component(ElSwitch.name, ElSwitch);\r\nimport { StartWebsite, SetWebsiteEventHandler } from './website/index.js'\r\nimport {fullScreen as fullScreens} from './modelTool/fullScreen.js'\r\nimport {openFullscreen,exitFullscreen,isFullscreenEnabled,getFullscreenElement,isFullScreen} from './modelTool/screen.js'\r\nimport store from '@/store'\r\n export default {\r\n  name:'ModelEngine',\r\n  props:{\r\n    width: {\r\n      type: String,\r\n      default: '500',\r\n      // default: '100%',\r\n    },\r\n    height: {\r\n      type: String,\r\n      default: '500',\r\n      // default: '100%',\r\n    },\r\n  },  \r\n  data(){\r\n     return {\r\n      // hasEyeDrop: 'EyeDropper' in window,\r\n      website:null,\r\n      wanggeValue:false,//网格\r\n      rotationValue:false,//旋转\r\n      showSlider:true,//爆炸滑块\r\n      slideValue:0,\r\n      btns:['默认','深色','浅色'],//背景颜色\r\n            // 环境贴图\r\n       envMaps: [\r\n        { name: '清空', url: 'static/envmaps/noimage.jpg', backgroundIsEnvMap: false },\r\n        { name: 'teide', url: 'static/envmaps/teide/posx.jpg', backgroundIsEnvMap: true },\r\n        // { name: 'park', url: '/static/envmaps/park/posx.jpg', backgroundIsEnvMap: true },\r\n        // { name: 'maskonaive', url: '/static/envmaps/maskonaive/posx.jpg', backgroundIsEnvMap: true },\r\n        // { name: 'fishermans_bastion', url: '/static/envmaps/fishermans_bastion/posx.jpg', backgroundIsEnvMap: true },\r\n        // { name: 'citadella', url: '/static/envmaps/citadella/posx.jpg', backgroundIsEnvMap: true },\r\n        // { name: 'ice_river', url: '/static/envmaps/ice_river/posx.jpg', backgroundIsEnvMap: true }\r\n      ],\r\n      tabIndex:0,\r\n      model:null,\r\n      dragMeshBtn:false,\r\n      duxianBtn:false,\r\n      toumingBtn:false,\r\n      fullScreenBtn:true,\r\n      celiangBtn:false,\r\n      isActive:false\r\n\r\n     }\r\n  },\r\n  computed:{\r\n    ...mapState({\r\n      showLoading:state=>state.app.showLoading,\r\n      ifduxian:state=>state.app.duxian,\r\n      // blast\r\n      // blastVal:state=>state.blastVal\r\n      // edge\r\n      // edgeVal:state=>state.app.edgeValue,\r\n      // measure \r\n      info:state=>state.measure.info,\r\n      pointsDistance:state=>state.measure.pointsDistance,\r\n      parallelFacesDistance:state=>state.measure.parallelFacesDistance,\r\n      facesAngle:state=>state.measure.facesAngle,\r\n      MeasureisActive:state=>state.measure.isActive,\r\n      showMeasureIInfo:state=>state.measure.showMeasureIInfo\r\n    }),\r\n    // 因为要去设置所以得写get set \r\n    blastVal:{\r\n         get(){\r\n             return this.$store.state.app.blastVal\r\n         },\r\n         set(val){\r\n           this.$store.state.app.blastVal = val\r\n            //  this.$store.commit('CHANGE_BLASTVAL',val)\r\n         }\r\n    },\r\n    edgeVal:{\r\n       get(){\r\n             return this.$store.state.app.edgeVal\r\n         },\r\n         set(val){\r\n             // this.$store.state.app.edgeVal = val\r\n              this.$store.commit('app/CHANGE_EDGE_VAL',val)\r\n           \r\n         }\r\n    },  \r\n    \r\n\r\n    // ,pointsDistance,parallelFacesDistance,facesAngle'不能使用getters 来显示值\r\n    ...mapGetters(['getBlastVal'])\r\n  },\r\n  watch:{\r\n    blastVal:{\r\n        handler(newVal, oldVal) {\r\n            console.log(newVal, oldVal,'in watch')\r\n          //  this.blastChange(newVal) \r\n        },\r\n        deep: true,\r\n        immediate: true\r\n\r\n      }\r\n\r\n\r\n  },  \r\n  methods:{\r\n    // 拾色器\r\n    async nativePick (e){\r\n     const val =  e ? e.target.value : null\r\n      if (val) {\r\n        console.log('获得颜色: ' + val)\r\n      } else {\r\n        const eyeDropper = new window.EyeDropper() // 初始化一个EyeDropper对象\r\n        console.log('按Esc可退出')\r\n        try {\r\n          const result = await eyeDropper.open() // 开始拾取颜色\r\n          console.log('获得颜色: ' + result.sRGBHex)\r\n        } catch (e) {\r\n          console.log('用户取消了取色')\r\n        }\r\n      }\r\n    },\r\n    switchleft(){\r\n      this.isActive = !this.isActive\r\n    },  \r\n    // 网格\r\n    changeWange(val){\r\n       this.wanggeValue = val\r\n      //  console.log(this.website,'this.website')\r\n      // //  this.$nextTick(() => {\r\n        //  this.model = this.website.model\r\n         this.website.wireFrame.setWireFrame(this.wanggeValue,this.website.model)\r\n      // //  })  \r\n     \r\n    },\r\n    // 背景颜色切换\r\n    backgroundTabClick(index){\r\n       this.tabIndex = index \r\n\r\n       this.website.viewer.outline.SetbackgroundColor(index)\r\n    },\r\n    //设置背景图片\r\n    SetEnvironment(envMapName, backgroundIsEnvMap){\r\n      this.website.viewer.outline.SetEnvironment(envMapName, backgroundIsEnvMap)\r\n    },  \r\n    // 模型拆分\r\n    blastChange(val){\r\n       console.log(this,'this in blastChange')\r\n      //  this.website.Blast(this.website.model,val)\r\n      //  页面通知js\r\n      // this.website.addEventListener('start',function(event){\r\n      //    alert(event.message)\r\n      // })\r\n      // this.website.start(val)\r\n      // js 通知vue文件\r\n          this.website.viewer.outline.Blast(this.website.model,val)\r\n        //   this.website.viewer.outline.addEventListener('start',function(event){\r\n        //     alert(event.message)\r\n        //  })\r\n        //  this.website.viewer.outline.start()\r\n      \r\n    },\r\n    //edge \r\n    edgeChange(val){\r\n      this.website.viewer.outline.Edge(this.website.model,val)\r\n    },\r\n    // 旋转\r\n    autoRotation(val){\r\n      this.rotationValue = val\r\n      this.website.viewer.outline.rotation(this.rotationValue)\r\n    },\r\n    duxian(){\r\n      // this.duxianBtn = !this.duxianBtn\r\n      // this.website.viewer.outline.duxian(this.website.model,this.duxianBtn)\r\n      // this.duxianBtn =ifduxian err\r\n       this.website.viewer.outline.duxian(this.website.model,!this.$store.state.app.duxian)\r\n    },\r\n    dragMesh(){\r\n      this.dragMeshBtn =    !this.dragMeshBtn\r\n      if(this.dragMeshBtn ){\r\n        // this.website.wireFrame.dragMesh(this.website.model)\r\n       \r\n      }\r\n     \r\n      this.website.viewer.outline.dragMesh(this.website.model,this.dragMeshBtn)\r\n     \r\n    },\r\n    resetDragMesh(){\r\n     \r\n      this.dragMeshBtn = false\r\n      this.website.wireFrame.resetDragMesh(this.website.model)\r\n    \r\n    },\r\n    dragMeshs(){\r\n       this.dragMeshBtn = !this.dragMeshBtn\r\n       this.website.wireFrame.dragMeshs(this.dragMeshBtn,this.website.model)\r\n    },\r\n    reset(){\r\n      this.website.viewer.outline.reset(this.website.model)\r\n    },\r\n \r\n    touming(){\r\n      this.toumingBtn = !this.toumingBtn\r\n      this.website.viewer.outline.touming(this.website.model,this.toumingBtn)\r\n    },\r\n    touming2(){\r\n      this.website.viewer.outline.touming(this.website.model,true)\r\n    },\r\n    fullScreen(el){\r\n      // console.log( isFullscreenEnabled(),' isFullscreenEnabled()')\r\n      // console.log(getFullscreenElement(),'getFullscreenElement')\r\n      // console.log(isFullScreen(),'isFullScreen')\r\n      this.fullScreenBtn=!this.fullScreenBtn\r\n      // way1\r\n      // let elem = document.getElementById('model-wrapper')\r\n      // if( this.fullScreenBtn){\r\n      //   openFullscreen(elem)\r\n      // }else {\r\n      //   exitFullscreen(elem)\r\n      // }\r\n     \r\n      // way2\r\n      el.preventDefault()\r\n      let elem = document.getElementById('model-wrapper')\r\n      // let elem = document.getElementById('main_viewer')\r\n      // let elem = document.documentElement\r\n    \r\n      fullScreens(elem)\r\n    },\r\n    yincang(){\r\n      this.website.viewer.outline.yincang(this.website.model,true)\r\n    },\r\n    // 测量\r\n    celiang(){\r\n      this.website.Measure(!this.$store.state.MeasureisActive)\r\n    },\r\n    // iframe 通信\r\n    handleMessage(event){\r\n      console.log(event,'event in handleMessage')\r\n      const data = event\r\n    }\r\n  },  \r\n  mounted () {\r\n    console.log(this.$store,'this.$store')\r\n  SetWebsiteEventHandler((eventName, eventLabel, eventParams) => {\r\n        console.log({\r\n          eventName,\r\n          eventLabel,\r\n          eventParams\r\n        })\r\n })\r\n     this.website = StartWebsite('./libs',this.$store.state.app.edgeVal)\r\n     window.addEventListener('message',this.handleMessage)\r\n}\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.viewer {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 100%;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n\r\n  .model-wrapper {\r\n    border: 1px solid green;\r\n    position: relative;\r\n    /* width: 700px;\r\n      height: 700px; */\r\n    width: 100%;\r\n    height: 100%;\r\n\r\n    .main_viewer {\r\n      // border: 1px solid blue;\r\n      position: absolute;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      // width: 100%;\r\n      // height: 100vh;\r\n\r\n    }\r\n\r\n    .side_menu_wrap {\r\n      position: absolute;\r\n      top: 0;\r\n      bottom: 0;\r\n      padding: 20px 10px;\r\n      width: 20%;\r\n      background-color: rgba(0, 0, 0, .5);\r\n      color: #fff;\r\n      transition: all .4s;\r\n\r\n      /* z-index: 9999; */\r\n      /* transition: all .4s cubic-bezier(.7, .3, .1, 5); */\r\n      .side-menu {\r\n        /* border: 1px solid blue; */\r\n        width: 100%;\r\n        height: 100%;\r\n        // overflow-y: scroll;\r\n        overflow-x: hidden;\r\n\r\n        .label_row {\r\n          /* margin: 20rem 0 10rem 0; */\r\n          margin: 20px 0 10px 0;\r\n          display: flex;\r\n          justify-content: space-between;\r\n          font-size: 16px;\r\n          user-select: none;\r\n        }\r\n\r\n        .blast-slider {\r\n          padding: 0 10px;\r\n        }\r\n\r\n        // tab 背景颜色\r\n        .btns {\r\n          border-radius: 4rem;\r\n          overflow: hidden;\r\n          user-select: none;\r\n\r\n          span {\r\n            display: inline-block;\r\n            width: 33.3%;\r\n            // height: 24rem;\r\n            height: 24px;\r\n            background-color: #fff;\r\n            color: #182c49;\r\n            text-align: center;\r\n            // line-height: 24rem;\r\n            line-height: 24px;\r\n            cursor: pointer;\r\n            // font-size: 12rem;\r\n            font-size: 12px;\r\n          }\r\n\r\n          .active {\r\n            background-color: #1458ea;\r\n            color: #fff;\r\n          }\r\n        }\r\n\r\n\r\n\r\n        .row {\r\n          width: 100%;\r\n          display: flex;\r\n          flex-direction: row;\r\n          justify-content: space-between;\r\n          /* justify-content: space-around; */\r\n          /* align-items: center; */\r\n          margin-bottom: 20px;\r\n\r\n          span {\r\n            user-select: none;\r\n          }\r\n\r\n        }\r\n\r\n        // 背景图片\r\n        .envMaps {\r\n          display: flex;\r\n          flex-direction: row;\r\n          flex-wrap: wrap;\r\n          justify-content: flex-start;\r\n          align-items: center;\r\n          padding: 0 10px;\r\n\r\n          .img {\r\n            // TODO\r\n            margin-right: 5px;\r\n            margin-bottom: 5px;\r\n          }\r\n\r\n        }\r\n      }\r\n\r\n      .switch {\r\n        position: absolute;\r\n        top: 50vh;\r\n        right: -20px;\r\n        z-index: 999;\r\n        transform: translateY(-40px);\r\n        width: 20px;\r\n        height: 80px;\r\n        background-color: rgba(0, 0, 0, .5);\r\n        text-align: center;\r\n        line-height: 80px;\r\n        border-radius: 0 4px 4px 0;\r\n        cursor: pointer;\r\n        transition: all .4s;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.measureInfo {\r\n  position: absolute;\r\n  top: 20px;\r\n  left: 45%;\r\n  color: #fff;\r\n\r\n  // span:nth-child(1) {\r\n  //   color: red;\r\n  //   margin-right: 20px;\r\n  // }\r\n\r\n\r\n  span {\r\n\r\n    i,\r\n    b {\r\n      margin-right: 10px;\r\n    }\r\n  }\r\n}\r\n\r\n.full-sceen {\r\n  position: absolute;\r\n  bottom: 12px;\r\n  right: 20px;\r\n  width: 32px;\r\n  height: 32px;\r\n  line-height: 32px;\r\n  text-align: center;\r\n  color: #fff;\r\n  border-radius: 100%;\r\n  cursor: pointer;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n.side_menu_wrap .items {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-between;\r\n\r\n  b {\r\n    user-select: none;\r\n  }\r\n}\r\n\r\n.side_menu_wrap .items span {\r\n\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  /* padding: 10rem 0; */\r\n  padding: 10px 0;\r\n}\r\n\r\n.side_menu_wrap .items span :nth-child(2) {\r\n  margin: 0 16px;\r\n}\r\n\r\n.side_menu_wrap .items span b {\r\n  display: block;\r\n  /* width: 36rem; */\r\n  width: 36px;\r\n  text-align: center;\r\n  margin-top: 5px;\r\n  font-size: 14px;\r\n}\r\n\r\n.side_menu_wrap .items span .iconfont {\r\n  /* width: 36rem;\r\nheight: 36rem; */\r\n  width: 36px;\r\n  height: 36px;\r\n  color: #fff;\r\n  font-size: 18px;\r\n  line-height: 36px;\r\n  text-align: center;\r\n  border-radius: 18px;\r\n  background-color: rgba(0, 0, 0, .2);\r\n  /*  */\r\n  margin-bottom: 5px;\r\n\r\n}\r\n\r\n.side_menu_wrap .items .active .iconfont {\r\n  background-color: #1458ea;\r\n}\r\n\r\n.left0 {\r\n  transform: translate(-100%);\r\n}\r\n\r\n.left200 {\r\n  transform: translate(0);\r\n}\r\n\r\n// 测量\r\ndiv.ov_measure_panel {\r\n  padding: 6px 15px;\r\n  position: absolute;\r\n  border-radius: 30px;\r\n  left: 100px;\r\n  top: 0px;\r\n}\r\n\r\ndiv.ov_measure_panel div.ov_svg_icon {\r\n  color: inherit;\r\n  margin-bottom: 2px;\r\n}\r\n\r\ndiv.ov_measure_panel div.ov_measure_value {\r\n  float: left;\r\n  margin-right: 10px;\r\n}\r\n</style>","import mod from \"-!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./modelEngine.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./modelEngine.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./modelEngine.vue?vue&type=template&id=2c739dcc&scoped=true&\"\nimport script from \"./modelEngine.vue?vue&type=script&lang=js&\"\nexport * from \"./modelEngine.vue?vue&type=script&lang=js&\"\nimport style0 from \"./modelEngine.vue?vue&type=style&index=0&id=2c739dcc&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2c739dcc\",\n  null\n  \n)\n\nexport default component.exports","import modelEngine from './modelEngine.vue'\r\nimport Vue from 'vue'\r\n\r\n\r\nconst components = [ modelEngine ]\r\nconst install = function (Vue) {   \r\n  // 全局注册所有的组件  \r\n  // components.forEach(item => {   Vue.component('ModelEngine', item)   }) \r\n  components.forEach(item => {   Vue.component(item.name, item)   }) \r\n\r\n}\r\nif (typeof window !== 'undefined' && window.Vue) {   \r\n  install(window.Vue) \r\n} \r\n// 导出 install （如果作为一个包，一定要有install ！！！） \r\nexport default { install }","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport store from './store'\r\nimport ElementUI from 'element-ui';\r\nimport 'element-ui/lib/theme-chalk/index.css';\r\n\r\nimport '@/styles/index.scss'\r\nimport '../public/static/icons/iconfont.css'\r\n// 将组件包引入\r\nimport modelEngine from '../packages'\r\nVue.config.productionTip = false\r\n\r\n// 使用组件\r\nVue.use(modelEngine)\r\nVue.use(ElementUI);\r\nnew Vue({\r\n  store,\r\n  render: h => h(App)\r\n}).$mount('#app')\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"24\":\"50bf17b6\",\"103\":\"ff82cf74\",\"189\":\"1bfb1d2c\",\"190\":\"b24886dc\",\"192\":\"cd6d2f40\",\"273\":\"c27f0297\",\"298\":\"791b48f3\",\"302\":\"dce95d79\",\"322\":\"d7290b43\",\"471\":\"7da8d813\",\"501\":\"a63e45cf\",\"503\":\"7986e4bd\",\"511\":\"c86681ed\",\"574\":\"ca76f542\",\"666\":\"6e588788\",\"723\":\"b8e1c6f8\",\"797\":\"e06bb427\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"three-model-viewer:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t};\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t826: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkthree_model_viewer\"] = self[\"webpackChunkthree_model_viewer\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(1975); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["render","_vm","this","_c","_self","attrs","staticClass","width","height","staticRenderFns","name","components","data","methods","test","alert","component","getters","showLoading","state","getBlastVal","blastVal","isActive","info","measure","pointsDistance","parallelFacesDistance","facesAngle","duxian","edgeVal","mutations","DUXIAN","val","SHOW_LOADING","CHANGE_BLASTVAL","RESET_BLASTVAL","CHANGE_EDGE_VAL","actions","commit","changBlastVal","resetBlastVal","namespaced","showMeasureIInfo","ShowMeasureInfo","IsActive","AddInfo","AddPointsDistance","AddDistanceParallel","AddAngel","Reset","modules","app","directives","rawName","value","expression","class","_m","_l","item","index","key","tabIndex","on","$event","backgroundTabClick","_v","_s","staticStyle","url","SetEnvironment","backgroundIsEnvMap","edgeChange","model","callback","$$v","blastChange","changeWange","wanggeValue","autoRotation","rotationValue","ifduxian","dragMeshBtn","dragMesh","reset","MeasureisActive","celiang","yincang","touming2","switchleft","fullScreen","fullScreenBtn","_e","Coord2D","constructor","x","y","Clone","SubCoord2D","a","b","GetIntegerFromStyle","parameter","Math","round","parseFloat","ShowDomElement","element","show","style","display","GetDomElementExternalHeight","padding","paddingTop","paddingBottom","border","borderTopWidth","borderBottomWidth","margin","marginTop","marginBottom","GetDomElementExternalWidth","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","marginLeft","marginRight","GetDomElementInnerDimensions","outerWidth","outerHeight","getComputedStyle","CreateDomElement","elementType","className","innerHTML","document","createElement","parentElement","appendChild","GetDomElementClientCoordinates","clientX","clientY","getBoundingClientRect","clientRect","left","top","window","pageXOffset","pageYOffset","Coord3D","z","Length","sqrt","MultiplyScalar","scalar","Normalize","length","Offset","direction","distance","normal","SubCoord3D","CoordDistance3D","Camera","eye","center","up","fov","Eps","IsEqual","abs","CoordIsEqual3D","CameraIsEqual3D","DegRad","IsZero","Direction","X","Y","Z","ViewerGeometry","scene","console","log","mainObject","GetMainObject","SetMainObject","add","Clear","ClearMainObject","EnumerateMeshes","mesh","geometry","dispose","remove","enumerator","traverse","obj","isMesh","GetMeshIntersectionUnderMouse","mouseCoords","camera","raycaster","mousePos","setFromCamera","iSectObjects","intersectObject","i","iSectObject","object","type","visible","GetBoundingSphere","needToProcess","boundingBox","GetBoundingBox","boundingSphere","getBoundingSphere","setFromObject","getCenter","ViewerExtraGeometry","ExtraObject","AddObject","isLineSegments","ParabolicTweenFunction","count","t","t2","TweenCoord3D","tweenFunc","dir","result","step","push","Navigation","canvas","container","callbacks","mouse","MouseInteraction","clickDetector","ClickDetector","onMouseClick","onMouseMove","addEventListener","OnMouseDown","bind","OnMouseMove","OnMouseUp","OnMouseLeave","GetFitToSphereCamera","radius","fitCamera","offsetToOrigo","centerEyeDirection","fieldOfView","sin","Update","onUpdate","GetCamera","MoveCamera","newCamera","stepCount","Step","steps","requestAnimationFrame","ev","preventDefault","Down","Start","GetPosition","Move","IsButtonDown","moveDiff","GetMoveDiff","GetButton","Up","End","IsClick","Click","which","Leave","Cancel","SetMouseClickHandler","SetMouseMoveHandler","button","buttons","curr","prev","diff","GetPositionFromEvent","buttonIndex","indexOf","splice","isClick","startPosition","currentPosition","ConvertColorToThreeColor","color","r","g","Phong","Physical","ShadingModel","ambientLight","directionalLight","castShadow","position","set","shadow","environment","SetType","UpdateShading","textures","useAsBackground","onLoaded","loader","load","background","getWorldCenterPosition","box","addVectors","max","min","multiplyScalar","initExplodeModel","explodeBox","explodeCenter","meshBox","isMark","isMarkChild","isLine","isSprite","meshCenter","userData","worldDir","subVectors","normalize","worldDistance","originPosition","getWorldPosition","clone","explodeModel","offset","newPos","copy","sub","localPosition","parent","worldToLocal","undefined","EventDispatcher","listener","_listeners","listeners","hasEventListener","removeEventListener","listenerArray","dispatchEvent","event","target","array","slice","l","call","that","Outline","viewer","website","super","renderer","composer","effectFXAA","outlinePass","selectedObject","groups","toumingMaterials","yincangMeshs","phongMaterial","specular","shininess","flatShading","side","skinning","dragControls","cloneModel","dragGroup","MeshPostions","Map","flag","blastValue","getSelectedObject","mouseCoordinates","intersection","addSelectedObject","outlineObj","selectedObjects","Click2","currentHex","material","emissive","getHex","setHex","EffectComposer","renderPass","RenderPass","addPass","OutlinePass","offsetWidth","offsetHeight","pulsePeriod","visibleEdgeColor","hiddenEdgeColor","usePatternTexture","edgeStrength","edgeGlow","edgeThickness","ShaderPass","FXAAShader","uniforms","resolution","active","store","touming","hasOwnProperty","transparent","opacity","child","DragControls","domElement","controls","enabled","deactivate","rotation","autoRotate","envMapName","envMapPath","envMapTextures","SetbackgroundColor","Measure","dispatch","keys","activate","tweenCamera","duration","Blast","Edge","UpdateEdgeDisplay","GetDefaultCamera","showCamera2","Viewer","mainDiv","view2","settings","signals","animationSteps","near","far","navigation","shading","outline","Init","id","parameters","antialias","devicePixelRatio","setPixelRatio","shadowMap","setClearColor","setSize","camera2","lookAt","cameraHelper","InitShading","OrbitControls","enableDamping","update","controls2","extraGeometry","canvasElem","RenderCamera","axes","gridHelper","animate","initGui","MinMaxGUIHelper","minProp","maxProp","minDif","v","updateCamera","updateProjectionMatrix","gui","onChange","minMaxGUIHelper","makeXYZGUI","vector3","onChangeFn","folder","addFolder","open","SetEnvironmentMapSettings","SetCamera","Resize","ResizeRenderer","aspect","AddExtraObject","ClearExtra","setScissorForElement","elem","canvasRect","elemRect","right","bottom","positiveYUpBottom","setScissor","setViewport","resizeRendererToDisplaySize","clientWidth","clientHeight","needResize","navigationCamera","view1Elem","view2Elem","setScissorTest","clear","GetCanvasSize","canvasSize","AdjustClippingPlanesToSphere","FitSphereToWindow","animation","ParameterConverter","StringToModelUrls","str","split","ParameterListParser","paramList","separator","GetModelUrls","keywordParams","GetKeywordParams","keyword","keywordToken","urlParts","urlPart","startsWith","substring","CreateUrlParser","urlParams","HashHandler","eventListener","skipNextEvent","SetEventListener","onhashchange","OnChange","HasHash","hash","GetHash","location","GetModelFilesFromHash","parser","FileSource","Url","File","Decompressed","GetFileName","filePath","firstSeparator","lastIndexOf","fileName","firstParamIndex","decodeURI","GetFileExtension","firstPoint","extension","toLowerCase","RequestUrl","onProgress","Promise","resolve","reject","request","XMLHttpRequest","onprogress","loaded","total","onload","status","response","onerror","responseType","send","ReadFile","file","reader","FileReader","onloadend","readyState","DONE","readAsArrayBuffer","testasync","msg","eventHandlerFunc","SetEventHandler","eventHandler","HandleEvent","eventName","eventLabel","eventParams","TaskRunner","current","Run","RunOnce","setTimeout","runTask","TaskReady","onReady","RunTasks","taskRunner","TestFile","content","SetContent","testfile","testPromise","then","catch","finally","ImporterFile","source","ImporterFileList","files","GetFiles","GetContent","onTaskComplete","onFileListProgress","GetFileContent","onFileLoadProgress","loaderPromise","FillFromInputFiles","inputFiles","inputFile","InputFile","InputFilesFromUrls","urls","InputFilesFromFileObjects","fileObjects","fileObject","ImporterBase","error","message","ImporterObj","CanImportExtension","Importer","importers","fileList","ImportFiles","onLoadStart","LoadFiles","onImportStart","newFileList","JSON","stringify","HasImportableFile","importableFiles","GetImportableFiles","FindImporter","importerIndex","importer","fileIndex","ThreeModelLoader","inProgress","InProgress","LoadModel","onSelectMainFile","onImportSuccess","onVisualizationStart","onImportError","importError","onLoadError","ThreeModelLoaderUI","modelLoader","onStart","onModelFinished","onTextureLoaded","size","err","LoaderUtils","createFilesMap","map","getFilesFromItemList","items","onDone","itemsCount","itemsTotal","filesMap","onEntryHandled","handleEntry","entry","isDirectory","createReader","readEntries","entries","isFile","kind","webkitGetAsEntry","ArrayBufferToUtf8String","buffer","decoder","TextDecoder","decode","RevokeObjectUrl","URL","revokeObjectURL","addLoadModeltoScene","DragLoader","objectURLs","RevokeObjectUrls","objectUrl","DragLoadFiles","manager","setURLModifier","replace","createObjectURL","addHandler","TGALoader","DragLoadFile","filename","pop","floor","format","progress","async","contents","FBXLoader","parse","OBJLoader","readAsText","editor","scope","externalLibLocation","Set","SetExternalLibLocation","newExternalLibLocation","isGLTF1","resultContent","magic","Uint8Array","version","DataView","getUint32","json","asset","handleJSON","metadata","formatVersion","setResourcePath","texturePath","isScene","fromJSON","Loader","dragLoader","loadItemUrls","loadFiles","loadItemList","filesMap1","filetest","find","blob","Blob","filearr","loadFile","has","MTLLoader","materialsContent","materials","objloader","objcontent","setMaterials","Rhino3dmLoader","setLibraryPath","TDSLoader","ThreeMFLoader","AMFLoader","amfobject","ColladaLoader","collada","DRACOLoader","setDecoderPath","decodeDracoFile","vertexColors","hasAttribute","GLTFLoader","dracoLoader","setDRACOLoader","animations","worker","Worker","onmessage","postMessage","Date","now","IFCLoader","ifcManager","setWasmPath","KMZLoader","LDrawLoader","group","PI","MD2Loader","mixer","PCDLoader","points","PLYLoader","STLLoader","readAsBinaryString","SVGLoader","paths","scale","path","depthWrite","shapes","createShapes","j","shape","GetFilesFromDataTransfer","dataTransfer","GetFileEntriesFromDirectory","dirEntry","fileEntries","dirEntries","GetFileObjectsFromEntries","all","fileEntry","getAsEntryFunc","DataTransferItem","prototype","getAsEntry","allEntries","RGBColor","ShowEdge","mainEdgeObject","edgeSettings","showEdges","edgeColor","edgeThreshold","UpdateWorldMatrix","updateWorldMatrix","EnumerateEdges","SetEdgeSettings","threshold","needToGenerate","ClearMainEdgeObject","GenerateMainEdgeObject","edges","line","applyMatrix4","matrixWorld","edge","WireFrame","setWireFrame","wireframe","dragstart","dragend","resetDragMesh","dragMeshs","Theme","Light","Dark","Settings","themeId","environmentMapName","sceneColor","angle","nearest","farthest","ThemeHandler","css","root","querySelector","property","Object","light","getPropertyValue","dark","SwitchTheme","themeName","setProperty","BigEps","RadDeg","IsEqualEps","eps","GetFaceWorldNormal","normalMatrix","extractRotation","faceNormal","face","CalculateMarkerValues","aMarker","bMarker","aIntersection","GetIntersection","bIntersection","aNormal","bNormal","point","distanceTo","angleTo","aPlane","setFromNormalAndCoplanarPoint","distanceToPoint","CreateMaterial","depthTest","CreateLineFromPoints","setFromPoints","Marker","markerObject","circleCurve","getPoints","UpdatePosition","updateMatrixWorld","GetObject","Show","MeasureTool","markers","tempMarker","panel","SetActive","UpdatePanel","ClearMarkers","AddMarker","MouseMove","GenerateMarker","calcResult","toFixed","degreeValue","GetCanvas","panelRect","canvasWidth","panelWidth","marker","aPoint","bPoint","meshUserData","progressBarDiv","loadingDiv","showProgressBar","body","hideProgressBar","removeChild","updateProgressBar","fraction","xhr","lengthComputable","onError","innerText","WebsiteUIState","Undefined","Intro","Model","Loading","Website","viewerDiv","uiState","hashHandler","modelLoaderUI","themeHandler","measureTool","showEdge","wireFrame","alignItems","justifyContent","src","start","Load","fbxloader","threeObject","FitModelToWindow","UpdateEnvironmentMap","OnModelClicked","OnModelMouseMoved","InitDragAndDrop","OnHashChange","stopPropagation","dropEffect","types","ClearModel","OnModelLoaded","LoadModelFromFileList","importSettings","LoadModelFromUrlList","LoadModelFromInputFiles","ClearHashIfNotOnlyUrlList","onFinish","onRender","SetUIState","onLoad","OnSmallWidthChanged","UpdatePanelsVisibility","showNavigator","showSidebar","navigator","ShowPanels","sidebar","newThemeId","resetColors","onEnvironmentMapChange","SetWebsiteEventHandler","StartWebsite","getElementById","innerWidth","screen","innerHeight","exitFullscreen","enterFullscreen","el","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","noFullscreenSupport","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","props","String","default","showSlider","slideValue","btns","envMaps","duxianBtn","toumingBtn","celiangBtn","computed","get","$store","watch","handler","newVal","oldVal","deep","immediate","e","eyeDropper","EyeDropper","sRGBHex","handleMessage","mounted","modelEngine","install","Vue","forEach","h","App","$mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","every","n","getter","__esModule","d","definition","o","defineProperty","enumerable","f","chunkId","reduce","promises","u","miniCssF","globalThis","Function","prop","dataWebpackPrefix","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","charset","timeout","nc","setAttribute","onScriptComplete","clearTimeout","doneFns","parentNode","head","Symbol","toStringTag","nmd","children","p","installedChunks","installedChunkData","promise","Error","loadingEnded","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}