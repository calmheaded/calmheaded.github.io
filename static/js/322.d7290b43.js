"use strict";(self["webpackChunkthree_model_viewer"]=self["webpackChunkthree_model_viewer"]||[]).push([[322],{2322:function(e,t,s){s.r(t),s.d(t,{MTLLoader:function(){return a}});var r=s(277);class a extends r.aNw{constructor(e){super(e)}load(e,t,s,a){const i=this,o=""===this.path?r.Zp0.extractUrlBase(e):this.path,n=new r.hH6(this.manager);n.setPath(this.path),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,(function(s){try{t(i.parse(s,o))}catch(r){a?a(r):console.error(r),i.manager.itemError(e)}}),s,a)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const s=e.split("\n");let r={};const a=/\s+/,o={};for(let i=0;i<s.length;i++){let e=s[i];if(e=e.trim(),0===e.length||"#"===e.charAt(0))continue;const t=e.indexOf(" ");let n=t>=0?e.substring(0,t):e;n=n.toLowerCase();let l=t>=0?e.substring(t+1):"";if(l=l.trim(),"newmtl"===n)r={name:l},o[l]=r;else if("ka"===n||"kd"===n||"ks"===n||"ke"===n){const e=l.split(a,3);r[n]=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])]}else r[n]=l}const n=new i(this.resourcePath||t,this.materialOptions);return n.setCrossOrigin(this.crossOrigin),n.setManager(this.manager),n.setMaterials(o),n}}class i{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:r.Wl3,this.wrap=void 0!==this.options.wrap?this.options.wrap:r.rpg}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const s in e){const r=e[s],a={};t[s]=a;for(const e in r){let t=!0,s=r[e];const i=e.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(t=!1);break;default:break}t&&(a[i]=s)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,s=this.materialsInfo[e],a={name:e,side:this.side};function i(e,t){return"string"!==typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}function o(e,s){if(a[e])return;const o=t.getTextureParams(s,a),n=t.loadTexture(i(t.baseUrl,o.url));n.repeat.copy(o.scale),n.offset.copy(o.offset),n.wrapS=t.wrap,n.wrapT=t.wrap,"map"!==e&&"emissiveMap"!==e||(n.encoding=r.knz),a[e]=n}for(const n in s){const e=s[n];let t;if(""!==e)switch(n.toLowerCase()){case"kd":a.color=(new r.Ilk).fromArray(e).convertSRGBToLinear();break;case"ks":a.specular=(new r.Ilk).fromArray(e).convertSRGBToLinear();break;case"ke":a.emissive=(new r.Ilk).fromArray(e).convertSRGBToLinear();break;case"map_kd":o("map",e);break;case"map_ks":o("specularMap",e);break;case"map_ke":o("emissiveMap",e);break;case"norm":o("normalMap",e);break;case"map_bump":case"bump":o("bumpMap",e);break;case"map_d":o("alphaMap",e),a.transparent=!0;break;case"ns":a.shininess=parseFloat(e);break;case"d":t=parseFloat(e),t<1&&(a.opacity=t,a.transparent=!0);break;case"tr":t=parseFloat(e),this.options&&this.options.invertTrProperty&&(t=1-t),t>0&&(a.opacity=1-t,a.transparent=!0);break;default:break}}return this.materials[e]=new r.xoR(a),this.materials[e]}getTextureParams(e,t){const s={scale:new r.FM8(1,1),offset:new r.FM8(0,0)},a=e.split(/\s+/);let i;return i=a.indexOf("-bm"),i>=0&&(t.bumpScale=parseFloat(a[i+1]),a.splice(i,2)),i=a.indexOf("-s"),i>=0&&(s.scale.set(parseFloat(a[i+1]),parseFloat(a[i+2])),a.splice(i,4)),i=a.indexOf("-o"),i>=0&&(s.offset.set(parseFloat(a[i+1]),parseFloat(a[i+2])),a.splice(i,4)),s.url=a.join(" ").trim(),s}loadTexture(e,t,s,a,i){const o=void 0!==this.manager?this.manager:r.tEQ;let n=o.getHandler(e);null===n&&(n=new r.dpR(o)),n.setCrossOrigin&&n.setCrossOrigin(this.crossOrigin);const l=n.load(e,s,a,i);return void 0!==t&&(l.mapping=t),l}}}}]);
//# sourceMappingURL=322.d7290b43.js.map